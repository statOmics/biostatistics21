<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement" />


<title>General Linear Model - Factorial Designs</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Biostatistiek 2021</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Hoorcolleges
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="introduction.html">Introductie</a>
    </li>
    <li>
      <a href="10-MultipleRegression.html">Algemene Lineaire Model</a>
    </li>
  </ul>
</li>
<li class="dropdown-header">Labs</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/biostatistics21">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">General Linear Model - Factorial Designs</h1>
<h4 class="author">Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<div id="introduction" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>In this section we will illustrate how factorial designs can be analysed using the general linear model.</p>
<p>We will focus on a two-way anova design where we will model a continous response with two factors.</p>
</div>
<div id="data" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Data</h1>
<p>48 rats were allocated to</p>
<ul>
<li>3 poisons (I,II,III) and</li>
<li>4 treatments (A,B,C,D).</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faraway)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rats)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>rats <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpairs</span>()</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>We have a design with a continuous response time (survival) and two factors:</p>
<ul>
<li>Poison: I, II, III</li>
<li>Treatment: A, B, C, D</li>
</ul>
<p>The data exploration indicates that there seems to be an effect of both treatment and poison.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>rats <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>treat,<span class="at">y=</span>time)) <span class="sc">+</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>poison)</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<ul>
<li>There might be an interaction, i.e. the effect of the treatment might be different according to the poison that has been adopted.</li>
<li>The boxplots also indicate that the data are heteroscedastic.</li>
</ul>
</div>
<div id="model" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Model</h1>
<p>We will model the data with a main effect for poison and treatment and an poison <span class="math inline">\(\times\)</span> treatment interaction.</p>
<p><span class="math display">\[
\begin{array}{lcl}
y_i &amp;=&amp; \beta_0  + 
\beta_{II} x_{iII} + \beta_{III} x_{iIII} + \\
&amp;&amp; \beta_{B} x_{iB}  + \beta_{C} x_{iC} + \beta_{D} x_{iD} + \\
&amp;&amp;\beta_{II:B}x_{iII}x_{iB} + \beta_{II:C}x_{iII}x_{iC}  + \beta_{II:D}x_{iII}x_{iD} + \\
&amp;&amp;\beta_{III:B}x_{iIII}x_{iB} + \beta_{III:C}x_{iIII}x_{iC}  + \beta_{III:D}x_{iIII}x_{iD} +
\epsilon_i
\end{array}
\]</span> with <span class="math inline">\(i = 1, \ldots, n\)</span>, <span class="math inline">\(n=48\)</span>, <span class="math inline">\(x_{iII}\)</span>, <span class="math inline">\(x_{iIII}\)</span>, <span class="math inline">\(x_{iB}\)</span>, <span class="math inline">\(x_{iC}\)</span> and <span class="math inline">\(x_{iD}\)</span> dummy variables for poison II, III, treatment B, C, and D, respectively.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>rats1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(time<span class="sc">~</span>poison<span class="sc">*</span>treat, rats)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rats1)</span></code></pre></div>
<pre><code>
Call:
lm(formula = time ~ poison * treat, data = rats)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32500 -0.04875  0.00500  0.04312  0.42500 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       0.41250    0.07457   5.532 2.94e-06 ***
poisonII         -0.09250    0.10546  -0.877   0.3862    
poisonIII        -0.20250    0.10546  -1.920   0.0628 .  
treatB            0.46750    0.10546   4.433 8.37e-05 ***
treatC            0.15500    0.10546   1.470   0.1503    
treatD            0.19750    0.10546   1.873   0.0692 .  
poisonII:treatB   0.02750    0.14914   0.184   0.8547    
poisonIII:treatB -0.34250    0.14914  -2.297   0.0276 *  
poisonII:treatC  -0.10000    0.14914  -0.671   0.5068    
poisonIII:treatC -0.13000    0.14914  -0.872   0.3892    
poisonII:treatD   0.15000    0.14914   1.006   0.3212    
poisonIII:treatD -0.08250    0.14914  -0.553   0.5836    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.1491 on 36 degrees of freedom
Multiple R-squared:  0.7335,    Adjusted R-squared:  0.6521 
F-statistic:  9.01 on 11 and 36 DF,  p-value: 1.986e-07</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rats1)</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-3-1.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-3-2.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-3-3.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-3-4.png" width="672" /></p>
<p>The errors, however, seem to be heteroscedastic and there seems to be a mean - variance relationship and they are also appear to be distributed with broader tails than the normal distribution.</p>
<div id="transformations" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Transformations</h2>
<div id="log-transformation" class="section level3" number="3.1.1">
<h3 number="3.1.1"><span class="header-section-number">3.1.1</span> log transformation</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>rats <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>treat,<span class="at">y=</span><span class="fu">log2</span>(time))) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>poison)</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rats2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(time <span class="sc">%&gt;%</span> log2<span class="sc">~</span>poison<span class="sc">*</span>treat, rats)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rats2)</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-4-2.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-4-3.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-4-4.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-4-5.png" width="672" /></p>
<p>Log transformation does not remove the heteroscedasticity completely.</p>
</div>
<div id="reciprocal-transformation" class="section level3" number="3.1.2">
<h3 number="3.1.2"><span class="header-section-number">3.1.2</span> Reciprocal transformation</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rats <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>treat,<span class="at">y=</span><span class="dv">1</span><span class="sc">/</span>time)) <span class="sc">+</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>poison)</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>rats3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="dv">1</span><span class="sc">/</span>time<span class="sc">~</span>poison<span class="sc">*</span>treat, rats)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rats3)</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-5-2.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-5-3.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-5-4.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-5-5.png" width="672" /></p>
<p>The reciprocal transformation seems to do perform better and can be interpreted as the rate of dying.</p>
</div>
</div>
</div>
<div id="inference" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Inference</h1>
<p>There are multiple interaction terms involved in the factorial design. We will first assess them together, which can be done using the anova table.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(rats3, <span class="at">type=</span><span class="st">&quot;III&quot;</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sum Sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"24.738304","2":"1","3":"103.039498","4":"4.158034e-12","_rn_":"(Intercept)"},{"1":"11.103531","2":"2","3":"23.124105","4":"3.476712e-07","_rn_":"poison"},{"1":"3.572343","2":"3","3":"4.959818","4":"5.535116e-03","_rn_":"treat"},{"1":"1.570772","2":"6","3":"1.090425","4":"3.867329e-01","_rn_":"poison:treat"},{"1":"8.643083","2":"36","3":"NA","4":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div id="removing-the-non-significant-interaction-term" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Removing the non-significant interaction term</h2>
<p>The interaction appears to be not significant at the 5% level.</p>
<p>A common practice is to remove the interaction from the analysis. We then obtain an additive model and the effects of the two treatments can be assessed separately.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rats4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="dv">1</span><span class="sc">/</span>time<span class="sc">~</span>poison <span class="sc">+</span> treat, rats)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rats4)</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-7-1.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-7-2.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-7-3.png" width="672" /><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-7-4.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(rats4, <span class="at">type=</span><span class="st">&quot;III&quot;</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sum Sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"58.21881","2":"1","3":"239.39932","4":"5.936991e-19","_rn_":"(Intercept)"},{"1":"34.87712","2":"2","3":"71.70843","4":"2.864848e-14","_rn_":"poison"},{"1":"20.41429","2":"3","3":"27.98160","4":"4.191931e-10","_rn_":"treat"},{"1":"10.21386","2":"42","3":"NA","4":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The anova table shows that the effect of the poison and the treatment are both extremely significant (<span class="math inline">\(p&lt;&lt; 0.001\)</span>).</p>
<p>In the additive model we can assess the effect of the poison type and the treatments, separately in a post-hoc analysis.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>comparisons <span class="ot">&lt;-</span> <span class="fu">glht</span>(rats4, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">poison =</span> <span class="st">&quot;Tukey&quot;</span>, <span class="at">treat=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comparisons)</span></code></pre></div>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = 1/time ~ poison + treat, data = rats)

Linear Hypotheses:
                      Estimate Std. Error t value Pr(&gt;|t|)    
poison: II - I == 0     0.4686     0.1744   2.688   0.0735 .  
poison: III - I == 0    1.9964     0.1744  11.451   &lt;0.001 ***
poison: III - II == 0   1.5278     0.1744   8.763   &lt;0.001 ***
treat: B - A == 0      -1.6574     0.2013  -8.233   &lt;0.001 ***
treat: C - A == 0      -0.5721     0.2013  -2.842   0.0509 .  
treat: D - A == 0      -1.3583     0.2013  -6.747   &lt;0.001 ***
treat: C - B == 0       1.0853     0.2013   5.391   &lt;0.001 ***
treat: D - B == 0       0.2991     0.2013   1.485   0.6154    
treat: D - C == 0      -0.7862     0.2013  -3.905   0.0028 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
(Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(comparisons)</span></code></pre></div>
<pre><code>
     Simultaneous Confidence Intervals

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = 1/time ~ poison + treat, data = rats)

Quantile = 2.8502
95% family-wise confidence level
 

Linear Hypotheses:
                      Estimate  lwr       upr      
poison: II - I == 0    0.468641 -0.028301  0.965584
poison: III - I == 0   1.996425  1.499482  2.493368
poison: III - II == 0  1.527784  1.030841  2.024726
treat: B - A == 0     -1.657402 -2.231222 -1.083582
treat: C - A == 0     -0.572135 -1.145955  0.001685
treat: D - A == 0     -1.358338 -1.932158 -0.784518
treat: C - B == 0      1.085267  0.511447  1.659087
treat: D - B == 0      0.299064 -0.274756  0.872884
treat: D - C == 0     -0.786203 -1.360023 -0.212383</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(comparisons,<span class="at">yaxt=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>contrastNames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;II-I&quot;</span>,<span class="st">&quot;III-I&quot;</span>,<span class="st">&quot;III-II&quot;</span>,<span class="st">&quot;B-A&quot;</span>,<span class="st">&quot;C-A&quot;</span>,<span class="st">&quot;D-A&quot;</span>,<span class="st">&quot;C-B&quot;</span>,<span class="st">&quot;D-B&quot;</span>,<span class="st">&quot;D-C&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>,<span class="at">at=</span><span class="fu">c</span>(<span class="fu">length</span>(contrastNames)<span class="sc">:</span><span class="dv">1</span>), <span class="at">labels=</span>contrastNames,<span class="at">las=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="keeping-the-non-significant-interaction-term" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Keeping the non-significant interaction term</h2>
<p>We know that accepting the null hypothesis that there is no interaction is a weak conclusion. It is possible that the experiment was simply underpowered to pick up the interaction. We can choose to keep the interaction in the model.</p>
<p>If the interaction were to be significant, this would mean that the effect of the poison changes according to the treatment and vice versa. Then, we cannot study the poison effects and treatment effects separately.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ExploreModelMatrix<span class="sc">::</span><span class="fu">VisualizeDesign</span>(rats,<span class="sc">~</span>poison<span class="sc">*</span>treat)<span class="sc">$</span>plot</span></code></pre></div>
<pre><code>[[1]]</code></pre>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Hence, in case of a significant interaction we should study the effect of the poison for each treatment separately:</p>
<ol style="list-style-type: decimal">
<li>For treatment A we would have to assess the following comparisons:</li>
</ol>
<ul>
<li>II-I: <span class="math inline">\(H_0: \beta_{II}=0\)</span></li>
<li>III-I: <span class="math inline">\(H_0: \beta_{III}=0\)</span></li>
<li>III-II: <span class="math inline">\(H_0: \beta_{III}-\beta_{II}=0\)</span></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>For treatment B we would have to assess the following comparisons:</li>
</ol>
<ul>
<li>II-I: <span class="math inline">\(H_0: \beta_{II}+\beta_{II:B}=0\)</span></li>
<li>III-I: <span class="math inline">\(H_0: \beta_{III}+\beta_{III:B}=0\)</span></li>
<li>III-II: <span class="math inline">\(H_0: \beta_{III}+\beta_{III:B}-\beta_{II}-\beta_{II:B}=0\)</span></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>For treatment C we would have to assess the following comparisons:</li>
</ol>
<ul>
<li>II-I: <span class="math inline">\(H_0: \beta_{II}+\beta_{II:C}=0\)</span></li>
<li>III-I: <span class="math inline">\(H_0: \beta_{III}+\beta_{III:C}=0\)</span></li>
<li>III-II: <span class="math inline">\(H_0: \beta_{III}+\beta_{III:C}-\beta_{II}-\beta_{II:C}=0\)</span></li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>For treatment C we would have to assess the following comparisons:</li>
</ol>
<ul>
<li>II-I: <span class="math inline">\(H_0: \beta_{II}+\beta_{II:D}=0\)</span></li>
<li>III-I: <span class="math inline">\(H_0: \beta_{III}+\beta_{III:D}=0\)</span></li>
<li>III-II: <span class="math inline">\(H_0: \beta_{III}+\beta_{III:D}-\beta_{II}-\beta_{II:D}=0\)</span></li>
</ul>
<p>The same holds for assessing the effect of the treatment, which should be done for each poison separately:</p>
<ol style="list-style-type: decimal">
<li>Poison I</li>
</ol>
<ul>
<li>B-A: <span class="math inline">\(H_0: \beta_{B}=0\)</span></li>
<li>C-A: <span class="math inline">\(H_0: \beta_{C}=0\)</span></li>
<li>D-A: <span class="math inline">\(H_0: \beta_{D}=0\)</span></li>
<li>C-B: <span class="math inline">\(H_0: \beta_{C}-\beta_{B}=0\)</span></li>
<li>D-B: <span class="math inline">\(H_0: \beta_{D}-\beta_{B}=0\)</span></li>
<li>D-C: <span class="math inline">\(H_0: \beta_{D}-\beta_{C}=0\)</span></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Poison II</li>
</ol>
<ul>
<li>B-A: <span class="math inline">\(H_0: \beta_{B}+\beta_{II:B}=0\)</span></li>
<li>C-A: <span class="math inline">\(H_0: \beta_{C}+\beta_{II:C}=0\)</span></li>
<li>D-A: <span class="math inline">\(H_0: \beta_{D}+\beta_{II:D}=0\)</span></li>
<li>C-B: <span class="math inline">\(H_0: \beta_{C}+\beta_{II:C}-\beta_{B}-\beta_{II:B}=0\)</span></li>
<li>D-B: <span class="math inline">\(H_0: \beta_{D}+\beta_{II:D}-\beta_{B}-\beta_{II:B}=0\)</span></li>
<li>D-C: <span class="math inline">\(H_0: \beta_{D}+\beta_{II:D}-\beta_{C}-\beta_{II:C}=0\)</span></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Poison III</li>
</ol>
<ul>
<li>B-A: <span class="math inline">\(H_0: \beta_{B}+\beta_{III:B}=0\)</span></li>
<li>C-A: <span class="math inline">\(H_0: \beta_{C}+\beta_{III:C}=0\)</span></li>
<li>D-A: <span class="math inline">\(H_0: \beta_{D}+\beta_{II:D}=0\)</span></li>
<li>C-B: <span class="math inline">\(H_0: \beta_{C}+\beta_{III:C}-\beta_{B}-\beta_{III:B}=0\)</span></li>
<li>D-B: <span class="math inline">\(H_0: \beta_{D}+\beta_{III:D}-\beta_{B}-\beta_{III:B}=0\)</span></li>
<li>D-C: <span class="math inline">\(H_0: \beta_{D}+\beta_{III:D}-\beta_{C}-\beta_{III:C}=0\)</span></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>comparisonsInt <span class="ot">&lt;-</span> <span class="fu">glht</span>(rats3, <span class="at">linfct =</span> <span class="fu">c</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonII = 0&quot;</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonIII = 0&quot;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonIII - poisonII = 0&quot;</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonII + poisonII:treatB = 0&quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonIII + poisonIII:treatB = 0&quot;</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonIII + poisonIII:treatB - poisonII- poisonII:treatB = 0&quot;</span>,  </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonII + poisonII:treatC = 0&quot;</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonIII + poisonIII:treatC = 0&quot;</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonIII + poisonIII:treatC - poisonII- poisonII:treatC = 0&quot;</span>,  </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonII + poisonII:treatD = 0&quot;</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonIII + poisonIII:treatD = 0&quot;</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonIII + poisonIII:treatD - poisonII- poisonII:treatD = 0&quot;</span>,  </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatB = 0&quot;</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatC = 0&quot;</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD = 0&quot;</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatC - treatB = 0&quot;</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD - treatB = 0&quot;</span>,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD - treatC = 0&quot;</span>,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatB + poisonII:treatB = 0&quot;</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatC + poisonII:treatC = 0&quot;</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD + poisonII:treatD = 0&quot;</span>,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatC + poisonII:treatC - treatB - poisonII:treatB = 0&quot;</span>,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD + poisonII:treatD - treatB - poisonII:treatB = 0&quot;</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD + poisonII:treatD - treatC - poisonII:treatC = 0&quot;</span>,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatB + poisonIII:treatB = 0&quot;</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatC + poisonIII:treatC = 0&quot;</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD + poisonIII:treatD = 0&quot;</span>,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatC + poisonIII:treatC - treatB - poisonIII:treatB = 0&quot;</span>,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD + poisonIII:treatD - treatB - poisonIII:treatB = 0&quot;</span>,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD + poisonIII:treatD - treatC - poisonIII:treatC = 0&quot;</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>contrastNames<span class="ot">&lt;-</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">paste</span>(<span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="at">each=</span><span class="dv">3</span>),<span class="fu">rep</span>(<span class="fu">apply</span>(<span class="fu">combn</span>(<span class="fu">c</span>(<span class="st">&quot;I&quot;</span>,<span class="st">&quot;II&quot;</span>,<span class="st">&quot;III&quot;</span>),<span class="dv">2</span>)[<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>,],<span class="dv">2</span>,paste,<span class="at">collapse=</span><span class="st">&quot;-&quot;</span>) ,<span class="dv">4</span>),<span class="at">sep=</span><span class="st">&quot;: &quot;</span>),</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;I&quot;</span>,<span class="st">&quot;II&quot;</span>,<span class="st">&quot;III&quot;</span>),<span class="at">each=</span><span class="dv">6</span>),<span class="fu">rep</span>(<span class="fu">apply</span>(<span class="fu">combn</span>(<span class="fu">c</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]),<span class="dv">2</span>)[<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>,],<span class="dv">2</span>,paste,<span class="at">collapse=</span><span class="st">&quot;-&quot;</span>) ,<span class="dv">3</span>),<span class="at">sep=</span><span class="st">&quot;: &quot;</span>))</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(comparisonsInt,<span class="at">yaxt=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>,<span class="at">at=</span><span class="fu">c</span>(<span class="fu">length</span>(contrastNames)<span class="sc">:</span><span class="dv">1</span>), <span class="at">labels=</span>contrastNames,<span class="at">las=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Here, the interaction was not significant suggesting that the effect if the poison does not change according to the treatment and vice versa. In this case, it would make sense to estimate</p>
<ol style="list-style-type: decimal">
<li>the effect size for each pairwise comparison of poisons by averaging it over all treatments and</li>
<li>the effect size for each pairwise comparison of treatments by averaging it over all different poisons.</li>
</ol>
<p>This should give us similar estimates as those obtained upon removing the interaction from the model.</p>
<p>e.g. for poison III vs poison II that would result in</p>
<ul>
<li>III-II: <span class="math display">\[H_0: 
\frac{(\beta_{III}-\beta_{II}) + (\beta_{III} + \beta_{III:B}-\beta_{II} - \beta_{II:B}) + (\beta_{III} + \beta_{III:C}-\beta_{II} - \beta_{II:C} + + (\beta_{III} + \beta_{III:D}-\beta_{II} - \beta_{II:D}) ) }{4}=0
\]</span> <span class="math display">\[
H_0:\beta_{III} + \frac{1}{4} \times \beta_{III:B} +  \frac{1}{4} \times\beta_{III:C} +  \frac{1}{4} \times\beta_{III:D}
-\beta_{II} - \frac{1}{4} \times\beta_{II:B} -  \frac{1}{4} \times\beta_{II:C}  - \frac{1}{4} \times\beta_{II:D}=0
\]</span></li>
</ul>
<p>We can calculate the average contrast for each comparison of interest.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>contrasts <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonII + 1/4*poisonII:treatB + 1/4*poisonII:treatC + 1/4*poisonII:treatD = 0&quot;</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonIII + 1/4*poisonIII:treatB + 1/4*poisonIII:treatC + 1/4*poisonIII:treatD= 0&quot;</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;poisonIII + 1/4*poisonIII:treatB + 1/4*poisonIII:treatC + 1/4*poisonIII:treatD - poisonII - 1/4*poisonII:treatB - 1/4*poisonII:treatC - 1/4*poisonII:treatD = 0&quot;</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatB + 1/3*poisonII:treatB + 1/3*poisonIII:treatB = 0&quot;</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatC + 1/3*poisonII:treatC + 1/3*poisonIII:treatC = 0&quot;</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD + 1/3*poisonII:treatD + 1/3*poisonIII:treatD = 0&quot;</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatC + 1/3*poisonII:treatC + 1/3*poisonIII:treatC - treatB - 1/3*poisonII:treatB - 1/3*poisonIII:treatB = 0&quot;</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD + 1/3*poisonII:treatD + 1/3*poisonIII:treatD  - treatB - 1/3*poisonII:treatB - 1/3*poisonIII:treatB = 0&quot;</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;treatD + 1/3*poisonII:treatD + 1/3*poisonIII:treatD  - treatC - 1/3*poisonII:treatC - 1/3*poisonIII:treatC = 0&quot;</span>) </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>comparisonsInt2 <span class="ot">&lt;-</span> <span class="fu">glht</span>(rats3, <span class="at">linfct =</span> contrasts</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(comparisonsInt2,<span class="at">yaxt=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>contrastNames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;II-I&quot;</span>,<span class="st">&quot;III-I&quot;</span>,<span class="st">&quot;III-II&quot;</span>,<span class="st">&quot;B-A&quot;</span>,<span class="st">&quot;C-A&quot;</span>,<span class="st">&quot;D-A&quot;</span>,<span class="st">&quot;C-B&quot;</span>,<span class="st">&quot;D-B&quot;</span>,<span class="st">&quot;D-C&quot;</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>,<span class="at">at=</span><span class="fu">c</span>(<span class="fu">length</span>(contrastNames)<span class="sc">:</span><span class="dv">1</span>), <span class="at">labels=</span>contrastNames,<span class="at">las=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="10-MultipleRegression-FactorialDesigns_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Indeed, the effect sizes are exactly the same because the experiment is balanced.</p>
<p>Note, that the standard errors differ slightly. Indeed the errors of both models will differ as well as the remaining degrees of freedom of the errors <span class="math inline">\(n-p\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Additive_coef=</span><span class="fu">summary</span>(comparisons)<span class="sc">$</span>test<span class="sc">$</span>coef,<span class="at">Additive_se=</span><span class="fu">summary</span>(comparisons)<span class="sc">$</span>test<span class="sc">$</span>sigma,<span class="at">Int_coef=</span><span class="fu">summary</span>(comparisonsInt2)<span class="sc">$</span>test<span class="sc">$</span>coef,<span class="at">int_se=</span><span class="fu">summary</span>(comparisonsInt2)<span class="sc">$</span>test<span class="sc">$</span>sigma) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Additive_coef"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Additive_se"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Int_coef"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["int_se"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.469","2":"0.174","3":"0.469","4":"0.173","_rn_":"poison: II - I"},{"1":"1.996","2":"0.174","3":"1.996","4":"0.173","_rn_":"poison: III - I"},{"1":"1.528","2":"0.174","3":"1.528","4":"0.173","_rn_":"poison: III - II"},{"1":"-1.657","2":"0.201","3":"-1.657","4":"0.200","_rn_":"treat: B - A"},{"1":"-0.572","2":"0.201","3":"-0.572","4":"0.200","_rn_":"treat: C - A"},{"1":"-1.358","2":"0.201","3":"-1.358","4":"0.200","_rn_":"treat: D - A"},{"1":"1.085","2":"0.201","3":"1.085","4":"0.200","_rn_":"treat: C - B"},{"1":"0.299","2":"0.201","3":"0.299","4":"0.200","_rn_":"treat: D - B"},{"1":"-0.786","2":"0.201","3":"-0.786","4":"0.200","_rn_":"treat: D - C"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="conclusion" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Conclusion</h1>
<p>There is an extremely significant effect of the Poison and Treatment on the dying rate of the rats (p &lt;&lt; 0.001).</p>
<p>The effect of the poison does not significantly differ according to the treatment and vice versa (p = 0.387).</p>
<p>The dying rate is on average 2 and 1.53 higher for rats that are exposed to poison III that those exposed to poison I and II, respectively (both p &lt;&lt; 0.001, 95% CI III-I: [1.5, 2.49], 95% CI III-II: [1.03, 2.03]) The average dying rate was not significantly different between rats exposed to poison I and poison II (p=0.074).</p>
<p>The dying rate is on average 1.66 and 1.36 lower upon treatment A than upon treatment B and D, respectively (p &lt;&lt; 0.001, 95% CI B-A: [-2.23, -1.08], 95% CI D-A: [-1.93, -0.78]. The dying rate is on average 1.09 and 0.79 higher upon treatment C than upon treatment B and D, respectively (C-B: p &lt;&lt; 0.001, 95% CI [0.51, 1.66] , D-C: p = 0.003, 95% CI [-1.36, -0.21]). The average dying rate was not significantly different between treatment C and A (p = 0.051), and, between treatment B and D (p = 0.61).</p>
<p>All p-values are corrected for multiple testing.</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiR2VuZXJhbCBMaW5lYXIgTW9kZWwgLSBGYWN0b3JpYWwgRGVzaWducyIKYXV0aG9yOiAiTGlldmVuIENsZW1lbnQiCmRhdGU6ICJzdGF0T21pY3MsIEdoZW50IFVuaXZlcnNpdHkgKGh0dHBzOi8vc3RhdG9taWNzLmdpdGh1Yi5pbykiCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgY29kZV9kb3dubG9hZDogdHJ1ZSAgICAKICAgIHRoZW1lOiBjb3NtbwogICAgdG9jOiB0cnVlCiAgICB0b2NfZmxvYXQ6IHRydWUKICAgIGhpZ2hsaWdodDogdGFuZ28KICAgIG51bWJlcl9zZWN0aW9uczogdHJ1ZQotLS0KCmBgYHtyIHNldHVwLCBpbmNsdWRlPUZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoaW5jbHVkZSA9IFRSVUUsIGNvbW1lbnQgPSBOQSwgZWNobyA9IFRSVUUsCiAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRSkKbGlicmFyeSh0aWR5dmVyc2UpCmBgYAoKIyBJbnRyb2R1Y3Rpb24KCkluIHRoaXMgc2VjdGlvbiB3ZSB3aWxsIGlsbHVzdHJhdGUgaG93IGZhY3RvcmlhbCBkZXNpZ25zCmNhbiBiZSBhbmFseXNlZCB1c2luZyB0aGUgZ2VuZXJhbCBsaW5lYXIgbW9kZWwuIAoKV2Ugd2lsbCBmb2N1cyBvbiBhIHR3by13YXkgYW5vdmEgZGVzaWduIHdoZXJlIHdlIHdpbGwgbW9kZWwgYSBjb250aW5vdXMgcmVzcG9uc2Ugd2l0aCB0d28gZmFjdG9ycy4gCgoKIyBEYXRhIAoKCjQ4IHJhdHMgd2VyZSBhbGxvY2F0ZWQgdG8gCgotIDMgcG9pc29ucyAoSSxJSSxJSUkpIGFuZCAKLSA0IHRyZWF0bWVudHMgKEEsQixDLEQpLiAKCmBgYHtyfQpsaWJyYXJ5KGZhcmF3YXkpCmRhdGEocmF0cykKCmxpYnJhcnkoR0dhbGx5KQpyYXRzICU+JQogIGdncGFpcnMoKQpgYGAKCgpXZSBoYXZlIGEgZGVzaWduIHdpdGggYSBjb250aW51b3VzIHJlc3BvbnNlIHRpbWUgKHN1cnZpdmFsKSBhbmQgdHdvIGZhY3RvcnM6IAoKLSBQb2lzb246IEksIElJLCBJSUkKLSBUcmVhdG1lbnQ6IEEsIEIsIEMsIEQKClRoZSBkYXRhIGV4cGxvcmF0aW9uIGluZGljYXRlcyB0aGF0IHRoZXJlIHNlZW1zIHRvIGJlIGFuIGVmZmVjdCBvZiBib3RoIHRyZWF0bWVudCBhbmQgcG9pc29uLiAKCgpgYGB7cn0KcmF0cyAlPiUKICBnZ3Bsb3QoYWVzKHg9dHJlYXQseT10aW1lKSkgKyAKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZT1OQSkgKyAKICBnZW9tX2ppdHRlcigpICsKICBmYWNldF93cmFwKH5wb2lzb24pCmBgYAoKLSBUaGVyZSBtaWdodCBiZSBhbiBpbnRlcmFjdGlvbiwgaS5lLiB0aGUgZWZmZWN0IG9mIHRoZSB0cmVhdG1lbnQgbWlnaHQgYmUgZGlmZmVyZW50IGFjY29yZGluZyB0byB0aGUgcG9pc29uIHRoYXQgaGFzIGJlZW4gYWRvcHRlZC4gCi0gVGhlIGJveHBsb3RzIGFsc28gaW5kaWNhdGUgdGhhdCB0aGUgZGF0YSBhcmUgaGV0ZXJvc2NlZGFzdGljLiAKCiMgTW9kZWwgCgpXZSB3aWxsIG1vZGVsIHRoZSBkYXRhIHdpdGggYSBtYWluIGVmZmVjdCBmb3IgcG9pc29uIGFuZCB0cmVhdG1lbnQgYW5kIGFuIHBvaXNvbiAkXHRpbWVzJCB0cmVhdG1lbnQgaW50ZXJhY3Rpb24uIAoKJCQKXGJlZ2lue2FycmF5fXtsY2x9CnlfaSAmPSYgXGJldGFfMCAgKyAKXGJldGFfe0lJfSB4X3tpSUl9ICsgXGJldGFfe0lJSX0geF97aUlJSX0gKyBcXAomJiBcYmV0YV97Qn0geF97aUJ9ICArIFxiZXRhX3tDfSB4X3tpQ30gKyBcYmV0YV97RH0geF97aUR9ICsgXFwKJiZcYmV0YV97SUk6Qn14X3tpSUl9eF97aUJ9ICsgXGJldGFfe0lJOkN9eF97aUlJfXhfe2lDfSAgKyBcYmV0YV97SUk6RH14X3tpSUl9eF97aUR9ICsgXFwKJiZcYmV0YV97SUlJOkJ9eF97aUlJSX14X3tpQn0gKyBcYmV0YV97SUlJOkN9eF97aUlJSX14X3tpQ30gICsgXGJldGFfe0lJSTpEfXhfe2lJSUl9eF97aUR9ICsKXGVwc2lsb25faQpcZW5ke2FycmF5fQokJAp3aXRoICRpID0gMSwgXGxkb3RzLCBuJCwgJG49NDgkLCAkeF97aUlJfSQsICR4X3tpSUlJfSQsICR4X3tpQn0kLCAkeF97aUN9JCBhbmQgJHhfe2lEfSQgZHVtbXkgdmFyaWFibGVzIGZvciBwb2lzb24gSUksIElJSSwgIHRyZWF0bWVudCBCLCBDLCBhbmQgRCwgcmVzcGVjdGl2ZWx5LgoKYGBge3J9CnJhdHMxIDwtIGxtKHRpbWV+cG9pc29uKnRyZWF0LCByYXRzKQpzdW1tYXJ5KHJhdHMxKQpwbG90KHJhdHMxKQpgYGAKClRoZSBlcnJvcnMsIGhvd2V2ZXIsIHNlZW0gdG8gYmUgaGV0ZXJvc2NlZGFzdGljIGFuZCB0aGVyZSBzZWVtcyB0byBiZSBhIG1lYW4gLSB2YXJpYW5jZSByZWxhdGlvbnNoaXAgYW5kIHRoZXkgYXJlIGFsc28gYXBwZWFyIHRvIGJlIGRpc3RyaWJ1dGVkIHdpdGggYnJvYWRlciB0YWlscyB0aGFuIHRoZSBub3JtYWwgZGlzdHJpYnV0aW9uLiAKCgojIyBUcmFuc2Zvcm1hdGlvbnMgCgojIyMgbG9nIHRyYW5zZm9ybWF0aW9uIAoKYGBge3J9CnJhdHMgJT4lCiAgZ2dwbG90KGFlcyh4PXRyZWF0LHk9bG9nMih0aW1lKSkpICsgCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGU9TkEpICsgCiAgZ2VvbV9qaXR0ZXIoKSArCiAgZmFjZXRfd3JhcCh+cG9pc29uKQoKcmF0czIgPC0gbG0odGltZSAlPiUgbG9nMn5wb2lzb24qdHJlYXQsIHJhdHMpCnBsb3QocmF0czIpCmBgYAoKTG9nIHRyYW5zZm9ybWF0aW9uIGRvZXMgbm90IHJlbW92ZSB0aGUgaGV0ZXJvc2NlZGFzdGljaXR5IGNvbXBsZXRlbHkuIAoKIyMjIFJlY2lwcm9jYWwgdHJhbnNmb3JtYXRpb24gCgpgYGB7cn0KcmF0cyAlPiUKICBnZ3Bsb3QoYWVzKHg9dHJlYXQseT0xL3RpbWUpKSArIAogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlPU5BKSArIAogIGdlb21faml0dGVyKCkgKwogIGZhY2V0X3dyYXAofnBvaXNvbikKCnJhdHMzIDwtIGxtKDEvdGltZX5wb2lzb24qdHJlYXQsIHJhdHMpCnBsb3QocmF0czMpCmBgYAoKVGhlIHJlY2lwcm9jYWwgdHJhbnNmb3JtYXRpb24gc2VlbXMgdG8gZG8gcGVyZm9ybSBiZXR0ZXIgYW5kIGNhbiBiZSBpbnRlcnByZXRlZCBhcyB0aGUgcmF0ZSBvZiBkeWluZy4gCgojIEluZmVyZW5jZSAKClRoZXJlIGFyZSBtdWx0aXBsZSBpbnRlcmFjdGlvbiB0ZXJtcyBpbnZvbHZlZCBpbiB0aGUgZmFjdG9yaWFsIGRlc2lnbi4gCldlIHdpbGwgZmlyc3QgYXNzZXNzIHRoZW0gdG9nZXRoZXIsIHdoaWNoIGNhbiBiZSBkb25lIHVzaW5nIHRoZSBhbm92YSB0YWJsZS4KCmBgYHtyfQpsaWJyYXJ5KGNhcikKQW5vdmEocmF0czMsIHR5cGU9IklJSSIpCmBgYAoKIyMgUmVtb3ZpbmcgdGhlIG5vbi1zaWduaWZpY2FudCBpbnRlcmFjdGlvbiB0ZXJtCgpUaGUgaW50ZXJhY3Rpb24gYXBwZWFycyB0byBiZSBub3Qgc2lnbmlmaWNhbnQgYXQgdGhlIDUlIGxldmVsLgoKQSBjb21tb24gcHJhY3RpY2UgaXMgdG8gcmVtb3ZlIHRoZSBpbnRlcmFjdGlvbiBmcm9tIHRoZSBhbmFseXNpcy4gCldlIHRoZW4gb2J0YWluIGFuIGFkZGl0aXZlIG1vZGVsIGFuZCB0aGUgZWZmZWN0cyBvZiB0aGUgdHdvIHRyZWF0bWVudHMgY2FuIGJlIGFzc2Vzc2VkIHNlcGFyYXRlbHkuCgpgYGB7cn0KcmF0czQgPC0gbG0oMS90aW1lfnBvaXNvbiArIHRyZWF0LCByYXRzKQpwbG90KHJhdHM0KQpBbm92YShyYXRzNCwgdHlwZT0iSUlJIikKYGBgCgpUaGUgYW5vdmEgdGFibGUgc2hvd3MgdGhhdCB0aGUgZWZmZWN0IG9mIHRoZSBwb2lzb24gYW5kIHRoZSB0cmVhdG1lbnQgYXJlIGJvdGggZXh0cmVtZWx5IHNpZ25pZmljYW50ICgkcDw8IDAuMDAxJCkuCgpJbiB0aGUgYWRkaXRpdmUgbW9kZWwgd2UgY2FuIGFzc2VzcyB0aGUgZWZmZWN0IG9mIHRoZSBwb2lzb24gdHlwZSBhbmQgdGhlIHRyZWF0bWVudHMsIHNlcGFyYXRlbHkgaW4gYSBwb3N0LWhvYyBhbmFseXNpcy4gCgpgYGB7cn0KbGlicmFyeShtdWx0Y29tcCkKY29tcGFyaXNvbnMgPC0gZ2xodChyYXRzNCwgbGluZmN0ID0gbWNwKHBvaXNvbiA9ICJUdWtleSIsIHRyZWF0PSJUdWtleSIpKQpzdW1tYXJ5KGNvbXBhcmlzb25zKQpjb25maW50KGNvbXBhcmlzb25zKQpwbG90KGNvbXBhcmlzb25zLHlheHQ9Im5vbmUiKQpjb250cmFzdE5hbWVzIDwtIGMoIklJLUkiLCJJSUktSSIsIklJSS1JSSIsIkItQSIsIkMtQSIsIkQtQSIsIkMtQiIsIkQtQiIsIkQtQyIpCmF4aXMoMixhdD1jKGxlbmd0aChjb250cmFzdE5hbWVzKToxKSwgbGFiZWxzPWNvbnRyYXN0TmFtZXMsbGFzPTIpCmBgYAoKIyMgS2VlcGluZyB0aGUgbm9uLXNpZ25pZmljYW50IGludGVyYWN0aW9uIHRlcm0KCldlIGtub3cgdGhhdCBhY2NlcHRpbmcgdGhlIG51bGwgaHlwb3RoZXNpcyB0aGF0IHRoZXJlIGlzIG5vIGludGVyYWN0aW9uIGlzIGEgd2VhayBjb25jbHVzaW9uLiAKSXQgaXMgcG9zc2libGUgdGhhdCB0aGUgZXhwZXJpbWVudCB3YXMgc2ltcGx5IHVuZGVycG93ZXJlZCB0byBwaWNrIHVwIHRoZSBpbnRlcmFjdGlvbi4gCldlIGNhbiBjaG9vc2UgdG8ga2VlcCB0aGUgaW50ZXJhY3Rpb24gaW4gdGhlIG1vZGVsLiAKCklmIHRoZSBpbnRlcmFjdGlvbiB3ZXJlIHRvIGJlIHNpZ25pZmljYW50LCB0aGlzIHdvdWxkIG1lYW4gdGhhdCB0aGUgZWZmZWN0IG9mIHRoZSBwb2lzb24gY2hhbmdlcyBhY2NvcmRpbmcgdG8gdGhlIHRyZWF0bWVudCBhbmQgdmljZSB2ZXJzYS4gClRoZW4sIHdlIGNhbm5vdCBzdHVkeSB0aGUgcG9pc29uIGVmZmVjdHMgYW5kIHRyZWF0bWVudCBlZmZlY3RzIHNlcGFyYXRlbHkuIAoKYGBge3J9IApFeHBsb3JlTW9kZWxNYXRyaXg6OlZpc3VhbGl6ZURlc2lnbihyYXRzLH5wb2lzb24qdHJlYXQpJHBsb3QKYGBgCgpIZW5jZSwgaW4gY2FzZSBvZiBhIHNpZ25pZmljYW50IGludGVyYWN0aW9uIHdlIHNob3VsZCBzdHVkeSB0aGUgZWZmZWN0IG9mIHRoZSBwb2lzb24gZm9yIGVhY2ggdHJlYXRtZW50IHNlcGFyYXRlbHk6IAoKMS4gRm9yIHRyZWF0bWVudCBBIHdlIHdvdWxkIGhhdmUgdG8gYXNzZXNzIHRoZSBmb2xsb3dpbmcgY29tcGFyaXNvbnM6CgotIElJLUk6ICRIXzA6IFxiZXRhX3tJSX09MCQKLSBJSUktSTogJEhfMDogXGJldGFfe0lJSX09MCQKLSBJSUktSUk6ICRIXzA6IFxiZXRhX3tJSUl9LVxiZXRhX3tJSX09MCQKCjIuIEZvciB0cmVhdG1lbnQgQiB3ZSB3b3VsZCBoYXZlIHRvIGFzc2VzcyB0aGUgZm9sbG93aW5nIGNvbXBhcmlzb25zOgoKLSBJSS1JOiAkSF8wOiBcYmV0YV97SUl9K1xiZXRhX3tJSTpCfT0wJAotIElJSS1JOiAkSF8wOiBcYmV0YV97SUlJfStcYmV0YV97SUlJOkJ9PTAkCi0gSUlJLUlJOiAkSF8wOiBcYmV0YV97SUlJfStcYmV0YV97SUlJOkJ9LVxiZXRhX3tJSX0tXGJldGFfe0lJOkJ9PTAkCgozLiBGb3IgdHJlYXRtZW50IEMgd2Ugd291bGQgaGF2ZSB0byBhc3Nlc3MgdGhlIGZvbGxvd2luZyBjb21wYXJpc29uczoKCi0gSUktSTogJEhfMDogXGJldGFfe0lJfStcYmV0YV97SUk6Q309MCQKLSBJSUktSTogJEhfMDogXGJldGFfe0lJSX0rXGJldGFfe0lJSTpDfT0wJAotIElJSS1JSTogJEhfMDogXGJldGFfe0lJSX0rXGJldGFfe0lJSTpDfS1cYmV0YV97SUl9LVxiZXRhX3tJSTpDfT0wJAoKNC4gRm9yIHRyZWF0bWVudCBDIHdlIHdvdWxkIGhhdmUgdG8gYXNzZXNzIHRoZSBmb2xsb3dpbmcgY29tcGFyaXNvbnM6CgotIElJLUk6ICRIXzA6IFxiZXRhX3tJSX0rXGJldGFfe0lJOkR9PTAkCi0gSUlJLUk6ICRIXzA6IFxiZXRhX3tJSUl9K1xiZXRhX3tJSUk6RH09MCQKLSBJSUktSUk6ICRIXzA6IFxiZXRhX3tJSUl9K1xiZXRhX3tJSUk6RH0tXGJldGFfe0lJfS1cYmV0YV97SUk6RH09MCQKClRoZSBzYW1lIGhvbGRzIGZvciBhc3Nlc3NpbmcgdGhlIGVmZmVjdCBvZiB0aGUgdHJlYXRtZW50LCB3aGljaCBzaG91bGQgYmUgZG9uZSBmb3IgZWFjaCBwb2lzb24gc2VwYXJhdGVseTogCgoxLiBQb2lzb24gSQoKLSBCLUE6ICRIXzA6IFxiZXRhX3tCfT0wJAotIEMtQTogJEhfMDogXGJldGFfe0N9PTAkCi0gRC1BOiAkSF8wOiBcYmV0YV97RH09MCQKLSBDLUI6ICRIXzA6IFxiZXRhX3tDfS1cYmV0YV97Qn09MCQKLSBELUI6ICRIXzA6IFxiZXRhX3tEfS1cYmV0YV97Qn09MCQKLSBELUM6ICRIXzA6IFxiZXRhX3tEfS1cYmV0YV97Q309MCQKCjIuIFBvaXNvbiBJSQoKLSBCLUE6ICRIXzA6IFxiZXRhX3tCfStcYmV0YV97SUk6Qn09MCQKLSBDLUE6ICRIXzA6IFxiZXRhX3tDfStcYmV0YV97SUk6Q309MCQKLSBELUE6ICRIXzA6IFxiZXRhX3tEfStcYmV0YV97SUk6RH09MCQKLSBDLUI6ICRIXzA6IFxiZXRhX3tDfStcYmV0YV97SUk6Q30tXGJldGFfe0J9LVxiZXRhX3tJSTpCfT0wJAotIEQtQjogJEhfMDogXGJldGFfe0R9K1xiZXRhX3tJSTpEfS1cYmV0YV97Qn0tXGJldGFfe0lJOkJ9PTAkCi0gRC1DOiAkSF8wOiBcYmV0YV97RH0rXGJldGFfe0lJOkR9LVxiZXRhX3tDfS1cYmV0YV97SUk6Q309MCQKCjMuIFBvaXNvbiBJSUkKCi0gQi1BOiAkSF8wOiBcYmV0YV97Qn0rXGJldGFfe0lJSTpCfT0wJAotIEMtQTogJEhfMDogXGJldGFfe0N9K1xiZXRhX3tJSUk6Q309MCQKLSBELUE6ICRIXzA6IFxiZXRhX3tEfStcYmV0YV97SUk6RH09MCQKLSBDLUI6ICRIXzA6IFxiZXRhX3tDfStcYmV0YV97SUlJOkN9LVxiZXRhX3tCfS1cYmV0YV97SUlJOkJ9PTAkCi0gRC1COiAkSF8wOiBcYmV0YV97RH0rXGJldGFfe0lJSTpEfS1cYmV0YV97Qn0tXGJldGFfe0lJSTpCfT0wJAotIEQtQzogJEhfMDogXGJldGFfe0R9K1xiZXRhX3tJSUk6RH0tXGJldGFfe0N9LVxiZXRhX3tJSUk6Q309MCQKCmBgYHtyIGZpZy5oZWlnaHQ9MTB9CmNvbXBhcmlzb25zSW50IDwtIGdsaHQocmF0czMsIGxpbmZjdCA9IGMoCiAgInBvaXNvbklJID0gMCIsCiAgInBvaXNvbklJSSA9IDAiLAogICJwb2lzb25JSUkgLSBwb2lzb25JSSA9IDAiLAogICJwb2lzb25JSSArIHBvaXNvbklJOnRyZWF0QiA9IDAiLAogICJwb2lzb25JSUkgKyBwb2lzb25JSUk6dHJlYXRCID0gMCIsCiAgInBvaXNvbklJSSArIHBvaXNvbklJSTp0cmVhdEIgLSBwb2lzb25JSS0gcG9pc29uSUk6dHJlYXRCID0gMCIsICAKICAicG9pc29uSUkgKyBwb2lzb25JSTp0cmVhdEMgPSAwIiwKICAicG9pc29uSUlJICsgcG9pc29uSUlJOnRyZWF0QyA9IDAiLAogICJwb2lzb25JSUkgKyBwb2lzb25JSUk6dHJlYXRDIC0gcG9pc29uSUktIHBvaXNvbklJOnRyZWF0QyA9IDAiLCAgCiAgInBvaXNvbklJICsgcG9pc29uSUk6dHJlYXREID0gMCIsCiAgInBvaXNvbklJSSArIHBvaXNvbklJSTp0cmVhdEQgPSAwIiwKICAicG9pc29uSUlJICsgcG9pc29uSUlJOnRyZWF0RCAtIHBvaXNvbklJLSBwb2lzb25JSTp0cmVhdEQgPSAwIiwgIAogICJ0cmVhdEIgPSAwIiwKICAidHJlYXRDID0gMCIsCiAgInRyZWF0RCA9IDAiLAogICJ0cmVhdEMgLSB0cmVhdEIgPSAwIiwKICAidHJlYXREIC0gdHJlYXRCID0gMCIsCiAgInRyZWF0RCAtIHRyZWF0QyA9IDAiLAogICJ0cmVhdEIgKyBwb2lzb25JSTp0cmVhdEIgPSAwIiwKICAidHJlYXRDICsgcG9pc29uSUk6dHJlYXRDID0gMCIsCiAgInRyZWF0RCArIHBvaXNvbklJOnRyZWF0RCA9IDAiLAogICJ0cmVhdEMgKyBwb2lzb25JSTp0cmVhdEMgLSB0cmVhdEIgLSBwb2lzb25JSTp0cmVhdEIgPSAwIiwKICAidHJlYXREICsgcG9pc29uSUk6dHJlYXREIC0gdHJlYXRCIC0gcG9pc29uSUk6dHJlYXRCID0gMCIsCiAgInRyZWF0RCArIHBvaXNvbklJOnRyZWF0RCAtIHRyZWF0QyAtIHBvaXNvbklJOnRyZWF0QyA9IDAiLAogICJ0cmVhdEIgKyBwb2lzb25JSUk6dHJlYXRCID0gMCIsCiAgInRyZWF0QyArIHBvaXNvbklJSTp0cmVhdEMgPSAwIiwKICAidHJlYXREICsgcG9pc29uSUlJOnRyZWF0RCA9IDAiLAogICJ0cmVhdEMgKyBwb2lzb25JSUk6dHJlYXRDIC0gdHJlYXRCIC0gcG9pc29uSUlJOnRyZWF0QiA9IDAiLAogICJ0cmVhdEQgKyBwb2lzb25JSUk6dHJlYXREIC0gdHJlYXRCIC0gcG9pc29uSUlJOnRyZWF0QiA9IDAiLAogICJ0cmVhdEQgKyBwb2lzb25JSUk6dHJlYXREIC0gdHJlYXRDIC0gcG9pc29uSUlJOnRyZWF0QyA9IDAiKQopCgpjb250cmFzdE5hbWVzPC0KICBjKHBhc3RlKHJlcChMRVRURVJTWzE6NF0sZWFjaD0zKSxyZXAoYXBwbHkoY29tYm4oYygiSSIsIklJIiwiSUlJIiksMilbMjoxLF0sMixwYXN0ZSxjb2xsYXBzZT0iLSIpICw0KSxzZXA9IjogIiksCiAgICBwYXN0ZShyZXAoYygiSSIsIklJIiwiSUlJIiksZWFjaD02KSxyZXAoYXBwbHkoY29tYm4oYyhMRVRURVJTWzE6NF0pLDIpWzI6MSxdLDIscGFzdGUsY29sbGFwc2U9Ii0iKSAsMyksc2VwPSI6ICIpKQoKcGxvdChjb21wYXJpc29uc0ludCx5YXh0PSJub25lIikKYXhpcygyLGF0PWMobGVuZ3RoKGNvbnRyYXN0TmFtZXMpOjEpLCBsYWJlbHM9Y29udHJhc3ROYW1lcyxsYXM9MikKYGBgCgpIZXJlLCB0aGUgaW50ZXJhY3Rpb24gd2FzIG5vdCBzaWduaWZpY2FudCBzdWdnZXN0aW5nIHRoYXQgdGhlIGVmZmVjdCBpZiB0aGUgcG9pc29uIGRvZXMgbm90IGNoYW5nZSBhY2NvcmRpbmcgdG8gdGhlIHRyZWF0bWVudCBhbmQgdmljZSB2ZXJzYS4gSW4gdGhpcyBjYXNlLCBpdCB3b3VsZCBtYWtlIHNlbnNlIHRvIGVzdGltYXRlIAoKMS4gdGhlIGVmZmVjdCBzaXplIGZvciBlYWNoIHBhaXJ3aXNlIGNvbXBhcmlzb24gb2YgcG9pc29ucyBieSBhdmVyYWdpbmcgaXQgb3ZlciBhbGwgdHJlYXRtZW50cyBhbmQgCjIuIHRoZSBlZmZlY3Qgc2l6ZSBmb3IgZWFjaCBwYWlyd2lzZSBjb21wYXJpc29uIG9mIHRyZWF0bWVudHMgYnkgYXZlcmFnaW5nIGl0IG92ZXIgYWxsIGRpZmZlcmVudCBwb2lzb25zLiAKClRoaXMgc2hvdWxkIGdpdmUgdXMgc2ltaWxhciBlc3RpbWF0ZXMgYXMgdGhvc2Ugb2J0YWluZWQgdXBvbiByZW1vdmluZyB0aGUgaW50ZXJhY3Rpb24gZnJvbSB0aGUgbW9kZWwuIAoKZS5nLiBmb3IgcG9pc29uIElJSSB2cyBwb2lzb24gSUkgdGhhdCB3b3VsZCByZXN1bHQgaW4gCgotIElJSS1JSTogCiQkSF8wOiAKXGZyYWN7KFxiZXRhX3tJSUl9LVxiZXRhX3tJSX0pICsgKFxiZXRhX3tJSUl9ICsgXGJldGFfe0lJSTpCfS1cYmV0YV97SUl9IC0gXGJldGFfe0lJOkJ9KSArIChcYmV0YV97SUlJfSArIFxiZXRhX3tJSUk6Q30tXGJldGFfe0lJfSAtIFxiZXRhX3tJSTpDfSArICsgKFxiZXRhX3tJSUl9ICsgXGJldGFfe0lJSTpEfS1cYmV0YV97SUl9IC0gXGJldGFfe0lJOkR9KSApIH17NH09MAokJAokJApIXzA6XGJldGFfe0lJSX0gKyBcZnJhY3sxfXs0fSBcdGltZXMgXGJldGFfe0lJSTpCfSArICBcZnJhY3sxfXs0fSBcdGltZXNcYmV0YV97SUlJOkN9ICsgIFxmcmFjezF9ezR9IFx0aW1lc1xiZXRhX3tJSUk6RH0KLVxiZXRhX3tJSX0gLSBcZnJhY3sxfXs0fSBcdGltZXNcYmV0YV97SUk6Qn0gLSAgXGZyYWN7MX17NH0gXHRpbWVzXGJldGFfe0lJOkN9ICAtIFxmcmFjezF9ezR9IFx0aW1lc1xiZXRhX3tJSTpEfT0wCiQkCgpXZSBjYW4gY2FsY3VsYXRlIHRoZSBhdmVyYWdlIGNvbnRyYXN0IGZvciBlYWNoIGNvbXBhcmlzb24gb2YgaW50ZXJlc3QuIAoKYGBge3J9CmNvbnRyYXN0cyA8LSBjKAogICJwb2lzb25JSSArIDEvNCpwb2lzb25JSTp0cmVhdEIgKyAxLzQqcG9pc29uSUk6dHJlYXRDICsgMS80KnBvaXNvbklJOnRyZWF0RCA9IDAiLAogICJwb2lzb25JSUkgKyAxLzQqcG9pc29uSUlJOnRyZWF0QiArIDEvNCpwb2lzb25JSUk6dHJlYXRDICsgMS80KnBvaXNvbklJSTp0cmVhdEQ9IDAiLAogICJwb2lzb25JSUkgKyAxLzQqcG9pc29uSUlJOnRyZWF0QiArIDEvNCpwb2lzb25JSUk6dHJlYXRDICsgMS80KnBvaXNvbklJSTp0cmVhdEQgLSBwb2lzb25JSSAtIDEvNCpwb2lzb25JSTp0cmVhdEIgLSAxLzQqcG9pc29uSUk6dHJlYXRDIC0gMS80KnBvaXNvbklJOnRyZWF0RCA9IDAiLAogICJ0cmVhdEIgKyAxLzMqcG9pc29uSUk6dHJlYXRCICsgMS8zKnBvaXNvbklJSTp0cmVhdEIgPSAwIiwKICAidHJlYXRDICsgMS8zKnBvaXNvbklJOnRyZWF0QyArIDEvMypwb2lzb25JSUk6dHJlYXRDID0gMCIsCiAgInRyZWF0RCArIDEvMypwb2lzb25JSTp0cmVhdEQgKyAxLzMqcG9pc29uSUlJOnRyZWF0RCA9IDAiLAogICJ0cmVhdEMgKyAxLzMqcG9pc29uSUk6dHJlYXRDICsgMS8zKnBvaXNvbklJSTp0cmVhdEMgLSB0cmVhdEIgLSAxLzMqcG9pc29uSUk6dHJlYXRCIC0gMS8zKnBvaXNvbklJSTp0cmVhdEIgPSAwIiwKICAidHJlYXREICsgMS8zKnBvaXNvbklJOnRyZWF0RCArIDEvMypwb2lzb25JSUk6dHJlYXREICAtIHRyZWF0QiAtIDEvMypwb2lzb25JSTp0cmVhdEIgLSAxLzMqcG9pc29uSUlJOnRyZWF0QiA9IDAiLAogICJ0cmVhdEQgKyAxLzMqcG9pc29uSUk6dHJlYXREICsgMS8zKnBvaXNvbklJSTp0cmVhdEQgIC0gdHJlYXRDIC0gMS8zKnBvaXNvbklJOnRyZWF0QyAtIDEvMypwb2lzb25JSUk6dHJlYXRDID0gMCIpIAoKCmNvbXBhcmlzb25zSW50MiA8LSBnbGh0KHJhdHMzLCBsaW5mY3QgPSBjb250cmFzdHMKKQpwbG90KGNvbXBhcmlzb25zSW50Mix5YXh0PSJub25lIikKY29udHJhc3ROYW1lcyA8LSBjKCJJSS1JIiwiSUlJLUkiLCJJSUktSUkiLCJCLUEiLCJDLUEiLCJELUEiLCJDLUIiLCJELUIiLCJELUMiKQpheGlzKDIsYXQ9YyhsZW5ndGgoY29udHJhc3ROYW1lcyk6MSksIGxhYmVscz1jb250cmFzdE5hbWVzLGxhcz0yKQpgYGAKCkluZGVlZCwgdGhlIGVmZmVjdCBzaXplcyBhcmUgZXhhY3RseSB0aGUgc2FtZSBiZWNhdXNlIHRoZSBleHBlcmltZW50IGlzIGJhbGFuY2VkLiAKCk5vdGUsIHRoYXQgdGhlIHN0YW5kYXJkIGVycm9ycyBkaWZmZXIgc2xpZ2h0bHkuIApJbmRlZWQgdGhlIGVycm9ycyBvZiBib3RoIG1vZGVscyB3aWxsIGRpZmZlciBhcyB3ZWxsIGFzIHRoZSByZW1haW5pbmcgZGVncmVlcyBvZiBmcmVlZG9tIG9mIHRoZSBlcnJvcnMgJG4tcCQuIAoKYGBge3J9CmRhdGEuZnJhbWUoQWRkaXRpdmVfY29lZj1zdW1tYXJ5KGNvbXBhcmlzb25zKSR0ZXN0JGNvZWYsQWRkaXRpdmVfc2U9c3VtbWFyeShjb21wYXJpc29ucykkdGVzdCRzaWdtYSxJbnRfY29lZj1zdW1tYXJ5KGNvbXBhcmlzb25zSW50MikkdGVzdCRjb2VmLGludF9zZT1zdW1tYXJ5KGNvbXBhcmlzb25zSW50MikkdGVzdCRzaWdtYSkgJT4lIHJvdW5kKDMpCmBgYAoKIyBDb25jbHVzaW9uCgpUaGVyZSBpcyBhbiBleHRyZW1lbHkgc2lnbmlmaWNhbnQgZWZmZWN0IG9mIHRoZSBQb2lzb24gYW5kIFRyZWF0bWVudCBvbiB0aGUgZHlpbmcgcmF0ZSBvZiB0aGUgcmF0cyAocCA8PCAwLjAwMSkuCgpUaGUgZWZmZWN0IG9mIHRoZSBwb2lzb24gZG9lcyBub3Qgc2lnbmlmaWNhbnRseSBkaWZmZXIgYWNjb3JkaW5nIHRvIHRoZSB0cmVhdG1lbnQgYW5kIHZpY2UgdmVyc2EgKHAgPSBgciAgQW5vdmEocmF0czMsdHlwZT0iSUlJIilbInBvaXNvbjp0cmVhdCIsIlByKD5GKSJdICU+JSByb3VuZCgzKWApLiAKClRoZSBkeWluZyByYXRlIGlzIG9uIGF2ZXJhZ2UgYHIgY29uZmludChjb21wYXJpc29uc0ludDIpJGNvbmZpbnRbY29udHJhc3ROYW1lcz09IklJSS1JIiwxXSAlPiUgcm91bmQoMilgICBhbmQgYHIgY29uZmludChjb21wYXJpc29uc0ludDIpJGNvbmZpbnRbY29udHJhc3ROYW1lcz09IklJSS1JSSIsMV0gJT4lIHJvdW5kKDIpYCBoaWdoZXIgZm9yIHJhdHMgdGhhdCBhcmUgZXhwb3NlZCB0byBwb2lzb24gSUlJIHRoYXQgdGhvc2UgZXhwb3NlZCB0byBwb2lzb24gSSBhbmQgSUksIHJlc3BlY3RpdmVseSAoYm90aCBwIDw8IDAuMDAxLCA5NSUgQ0kgSUlJLUk6IFtgciBwYXN0ZShyb3VuZChjb25maW50KGNvbXBhcmlzb25zSW50MikkY29uZmludFtjb250cmFzdE5hbWVzPT0iSUlJLUkiLC0xXSwyKSxjb2xsYXBzZT0iLCAiKWBdLCA5NSUgQ0kgSUlJLUlJOiBbYHIgcGFzdGUocm91bmQoY29uZmludChjb21wYXJpc29uc0ludDIpJGNvbmZpbnRbY29udHJhc3ROYW1lcz09IklJSS1JSSIsLTFdLDIpLGNvbGxhcHNlPSIsICIpYF0pClRoZSBhdmVyYWdlIGR5aW5nIHJhdGUgd2FzIG5vdCBzaWduaWZpY2FudGx5IGRpZmZlcmVudCBiZXR3ZWVuIHJhdHMgZXhwb3NlZCB0byBwb2lzb24gSSBhbmQgcG9pc29uIElJIChwPWByIHJvdW5kKHN1bW1hcnkoY29tcGFyaXNvbnNJbnQyKSR0ZXN0JHB2YWx1ZXNbY29udHJhc3ROYW1lcz09IklJLUkiXSwzKWApLgoKVGhlIGR5aW5nIHJhdGUgaXMgb24gYXZlcmFnZSBgciBjb25maW50KGNvbXBhcmlzb25zSW50MikkY29uZmludFtjb250cmFzdE5hbWVzPT0iQi1BIiwxXSAlPiUgcm91bmQoMikgJT4lIGFic2AgYW5kIGByIGNvbmZpbnQoY29tcGFyaXNvbnNJbnQyKSRjb25maW50W2NvbnRyYXN0TmFtZXM9PSJELUEiLDFdICU+JSByb3VuZCgyKSU+JSBhYnNgIGxvd2VyIHVwb24gdHJlYXRtZW50IEEgdGhhbiB1cG9uIHRyZWF0bWVudCBCIGFuZCBELCByZXNwZWN0aXZlbHkgKHAgPDwgMC4wMDEsIDk1JSBDSSBCLUE6IFtgciBwYXN0ZShyb3VuZChjb25maW50KGNvbXBhcmlzb25zSW50MikkY29uZmludFtjb250cmFzdE5hbWVzPT0iQi1BIiwtMV0sMiksY29sbGFwc2U9IiwgIilgXSwgOTUlIENJIEQtQTogW2ByIHBhc3RlKHJvdW5kKGNvbmZpbnQoY29tcGFyaXNvbnNJbnQyKSRjb25maW50W2NvbnRyYXN0TmFtZXM9PSJELUEiLC0xXSwyKSxjb2xsYXBzZT0iLCAiKWBdLiAKVGhlIGR5aW5nIHJhdGUgaXMgb24gYXZlcmFnZSBgciBjb25maW50KGNvbXBhcmlzb25zSW50MikkY29uZmludFtjb250cmFzdE5hbWVzPT0iQy1CIiwxXSAlPiUgcm91bmQoMilgIGFuZCBgciBjb25maW50KGNvbXBhcmlzb25zSW50MikkY29uZmludFtjb250cmFzdE5hbWVzPT0iRC1DIiwxXSAlPiUgcm91bmQoMikgJT4lIGFic2AgaGlnaGVyIHVwb24gdHJlYXRtZW50IEMgdGhhbiB1cG9uIHRyZWF0bWVudCBCIGFuZCBELCByZXNwZWN0aXZlbHkgKEMtQjogcCA8PCAwLjAwMSwgOTUlIENJIFtgciBwYXN0ZShyb3VuZChjb25maW50KGNvbXBhcmlzb25zSW50MikkY29uZmludFtjb250cmFzdE5hbWVzPT0iQy1CIiwtMV0sMiksY29sbGFwc2U9IiwgIilgXSAsIEQtQzogcCA9IGByIHN1bW1hcnkoY29tcGFyaXNvbnNJbnQyKSR0ZXN0JHB2YWx1ZXNbY29udHJhc3ROYW1lcz09IkQtQyJdICU+JSByb3VuZCgzKWAsIDk1JSBDSSBbYHIgcGFzdGUocm91bmQoY29uZmludChjb21wYXJpc29uc0ludDIpJGNvbmZpbnRbY29udHJhc3ROYW1lcz09IkQtQyIsLTFdLDIpLGNvbGxhcHNlPSIsICIpYF0pLiAKVGhlIGF2ZXJhZ2UgZHlpbmcgcmF0ZSB3YXMgbm90IHNpZ25pZmljYW50bHkgZGlmZmVyZW50IGJldHdlZW4gdHJlYXRtZW50IEMgYW5kIEEgKHAgPSBgciBzdW1tYXJ5KGNvbXBhcmlzb25zSW50MikkdGVzdCRwdmFsdWVzW2NvbnRyYXN0TmFtZXM9PSJDLUEiXSAlPiUgcm91bmQoMylgKSwgYW5kLCBiZXR3ZWVuIHRyZWF0bWVudCBCIGFuZCBEIChwID0gYHIgc3VtbWFyeShjb21wYXJpc29uc0ludDIpJHRlc3QkcHZhbHVlc1tjb250cmFzdE5hbWVzPT0iRC1CIl0gJT4lIHJvdW5kKDMpYCkuCgpBbGwgcC12YWx1ZXMgYXJlIGNvcnJlY3RlZCBmb3IgbXVsdGlwbGUgdGVzdGluZy4g</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("10-MultipleRegression-FactorialDesigns.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
