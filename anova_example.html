<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Koen Van den Berge en Lieven Clement" />


<title>Practicum 5: Anova</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Biostatistiek 2021</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Hoorcolleges
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="introduction.html">Introductie</a>
    </li>
    <li>
      <a href="10-MultipleRegression.html">Algemeen Lineair Model</a>
    </li>
    <li>
      <a href="10-MultipleRegression-FactorialDesigns.html">Factoriële Designs</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Practicum_1_Voorbereiding_Two-sample_t-test.html">Practicum 1: Voorbereiding Two-sample t-test</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/biostatistics21">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Practicum 5: Anova</h1>
<h4 class="author">Koen Van den Berge en Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<p><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a></p>
<div id="de-koekoek-dataset" class="section level1">
<h1><span class="header-section-number">1</span> De koekoek dataset</h1>
<p>Het is bekend dat de koekoek niet zelf een nest bouwt maar zijn eieren legt in de nesten van andere vogels. Sinds 1892 weet men reeds dat het soort koekoekseieren eigen is aan de locatie waar ze gevonden worden. Een studie in 1940 toonde aan dat de koekoeken elk jaar terugkeren naar hetzelfde grondgebied en eieren leggen in de nesten van welbepaalde “pleegouder”-vogels. Bovendien paren koekoeken enkel binnen hun grondgebied. Op die manier zijn geografische subsoorten ontwikkeld, elk met een dominante pleegouder-soort. Hierdoor kon een specialisatie optreden van de koekoek aan de pleegouder-soort via natuurlijke selectie, zodat de koekoekseieren een hogere kans kregen om geadopteerd te worden door de pleegouder-soort.</p>
<p>De dataset koekoek.txt bevat de lengte (variabele <code>lengte</code>) van de koekoekseieren (in mm) van willekeurig gekozen geparasiteerde nesten. In totaal bevat de dataset 120 observaties en voor elk ei is aangegeven van welke vogelsoort (variabele <code>soort</code>) het nest is. De codering voor soort is als volgt:</p>
<ul>
<li><code>soort=1</code>: graspieper</li>
<li><code>soort=2</code>: boompieper</li>
<li><code>soort=3</code>: heggemus</li>
<li><code>soort=4</code>: roodborstje</li>
<li><code>soort=5</code>: witte kwikstaart</li>
<li><code>soort=6</code>: winterkoning</li>
</ul>
<p>In deze analyse zullen we nagaan of de pleegouder-soort een invloed heeft op de gemiddelde lengte van de koekoekseieren.</p>
</div>
<div id="libraries-laden" class="section level1">
<h1><span class="header-section-number">2</span> Libraries laden</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">#install.packages(&quot;tidyr&quot;)</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#install.packages(&quot;multcomp&quot;)</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">library</span>(multcomp)</span></code></pre></div>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: TH.data</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<pre><code>## 
## Attaching package: &#39;TH.data&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     geyser</code></pre>
</div>
<div id="dataset-koekoek.txt-inlezen" class="section level1">
<h1><span class="header-section-number">3</span> Dataset koekoek.txt inlezen</h1>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>koekoek&lt;-<span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/statOmics/statistiekBasisCursusData/master/practicum5/koekoek.txt&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">head</span>(koekoek)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["lengte"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["soort"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"21.87","2":"1","_rn_":"1"},{"1":"22.88","2":"1","_rn_":"2"},{"1":"24.61","2":"1","_rn_":"3"},{"1":"22.95","2":"1","_rn_":"4"},{"1":"19.55","2":"1","_rn_":"5"},{"1":"22.42","2":"1","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="data-exploratie" class="section level1">
<h1><span class="header-section-number">4</span> Data exploratie</h1>
<div id="hoeveel-observaties-zijn-er-voor-elke-soort" class="section level2">
<h2><span class="header-section-number">4.1</span> Hoeveel observaties zijn er voor elke soort?</h2>
<p>Tel het aantal observaties per soort en sla het resultaat op in <code>count</code>. Maak een barplot voor de variabele <code>soort</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>count &lt;-<span class="st"> </span>koekoek <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(soort)</span>
<span id="cb15-2"><a href="#cb15-2"></a>count</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["soort"],"name":[1],"type":["int"],"align":["right"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"45"},{"1":"2","2":"15"},{"1":"3","2":"14"},{"1":"4","2":"16"},{"1":"5","2":"15"},{"1":"6","2":"15"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>koekoek <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> soort)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>)</span></code></pre></div>
<p><img src="anova_example_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="data-visualisatie" class="section level2">
<h2><span class="header-section-number">4.2</span> Data visualisatie</h2>
<p>Genereer een boxplot van de lengte van de koekoekseieren voor elk van de 6 vogelsoorten. Plot ook de individuele observaties.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>koekoek<span class="op">$</span>soort &lt;-<span class="st"> </span><span class="kw">as.factor</span>(koekoek<span class="op">$</span>soort)</span>
<span id="cb17-2"><a href="#cb17-2"></a>boxplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>koekoek,<span class="kw">aes</span>(<span class="dt">x=</span>soort, <span class="dt">y=</span>lengte, <span class="dt">col=</span>soort)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Lengte van de koekoekseieren per soort&quot;</span>)</span>
<span id="cb17-7"><a href="#cb17-7"></a>boxplot</span></code></pre></div>
<p><img src="anova_example_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
</div>
<div id="statististische-toets" class="section level1">
<h1><span class="header-section-number">5</span> Statististische toets</h1>
<p>Welke test kan men uitvoeren om de gemiddelde lengte simultaan te vergelijken tussen alle soorten?</p>
<p>In vorige lessen zagen we enkel de two-sample t-test om twee gemiddelden met elkaar vergelijken. We hebben echter ook reeds gezien dat de two-sample t-test een specifieke versie is van een lineair model, namelijk van een lineair model waarbij de covariaat een categorische variabele <span class="math inline">\(X\)</span> is met <span class="math inline">\(2\)</span> levels, i.e. <span class="math display">\[ E(Y_i) = \beta_0 + \beta_1 X_i \]</span></p>
<p>Bijvoorbeeld, indien <span class="math inline">\(Y_i\)</span> de lengte van persoon <span class="math inline">\(i\)</span> voorstelt en <span class="math inline">\(X_i\)</span> het geslacht van die persoon waarbij <span class="math inline">\(X_i=0\)</span> indien persoon <span class="math inline">\(i\)</span> een vrouw is, en <span class="math inline">\(X_i=1\)</span> indien niet. In dat geval, stelt <span class="math inline">\(\beta_0\)</span> de gemiddelde lengte voor vrouwen voor, en <span class="math inline">\(\beta_1\)</span> staat voor het verschil in gemiddelde lengte tussen vrouwen en mannen. De gemiddelde lengte voor een man kan men dan bekomen door <span class="math inline">\(E(Y_{male}) = \beta_0 + \beta_1\)</span>. Men kan dit ook schrijven als <span class="math display">\[ E(Y | female) = E(Y|X=0) = \beta_0\]</span> <span class="math display">\[ E(Y | male) = E(Y|X=1) = \beta_0 + \beta_1\]</span></p>
<p>Dit lineair model kan echter ook makkelijk veralgemeend worden naar factoren met meerdere levels. Men kan inderdaad meerdere dummy variabelen invoeren (1 minder dan het aantal toetsen). Voor ons voorbeeld zullen we 5 dummyvariabelen nodig hebben: <span class="math inline">\(X_2\)</span>, <span class="math inline">\(X_3\)</span>, <span class="math inline">\(X_4\)</span>, <span class="math inline">\(X_5\)</span> en <span class="math inline">\(X_6\)</span>. De eerste soort is dan de referentiegroep (alle dummies <span class="math inline">\(X_2 = X_3 = X_4 = X_5 = X_6 =0\)</span>).</p>
<p>Er bestaat een manier waarbij we <strong>alle levels simultaan kunnen testen</strong>, men zal namelijk testen of de gehele factor variabele een invloed heeft op de respons. In de context van ons voorbeeld, zal men kunnen testen of de pleegouder-soort uberhaupt een effect heeft op de gemiddelde lengte van koekoekseieren. Zo’n een test heet een one-way ANOVA. Men noemt de test ‘one-way’ omdat het de associatie bestudeert tussen de response en 1 factor, met andere woorden het model bevat geen meerdere factoren (enkel relevant voor studenten biochemie en biomedische wetenschappen).</p>
<div id="nul--en-alternatieve-hypothese-voor-de-toets" class="section level2">
<h2><span class="header-section-number">5.1</span> Nul- en alternatieve hypothese voor de toets</h2>
<p>Stel dat <span class="math inline">\(\mu_1\)</span> de gemiddelde lengte van koekoekseieren voor graspiepers (<code>soort=1</code>) voorstelt, en idem voor <span class="math inline">\(\mu_2 , \ldots , \mu_6\)</span>. De nul- en alternatieve hypothese voor een ANOVA kan men dan voorstellen als</p>
<p><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1=\mu_2=\mu_3=\mu_4=\mu_5=\mu_6\)</span></p>
<p><span class="math inline">\(H_A\)</span>: Voor minstens één <span class="math inline">\(i \ne j\)</span> is <span class="math inline">\(\mu_i \neq \mu_j\)</span></p>
<p>De nulhypothese stelt dus dat de gemiddelde lengte van koekoekseiren niet afhangt van de pleegouder-soort: er is geen systematisch verschil in gemiddelde lengte van eieren tussen verschillende pleegouder-soorten. De alternatieve hypothese stelt dat de gemiddelde lengte van koekoekseieren verschilt tussen <strong>minstens twee pleegouder-soorten</strong>. Merk op dat men bij het verwerpen van de nulhypothese <strong>niet weet tussen welke soorten</strong> er een verschil is!</p>
<div id="fit-het-model-voor-de-analyse" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Fit het model voor de analyse</h3>
<p>We fitten een lineair model met als respons variabele de lengte van de eieren en als predictor de soort. Merk op dat het belangrijk is om soort te definiëren als een factor, wat al in orde werd gebracht bij het genereren van de boxplots. R zal dan automatisch het vereiste aantal dummy-variabelen aanmaken.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>m &lt;-<span class="st"> </span><span class="kw">lm</span>(lengte<span class="op">~</span>soort, <span class="dt">data =</span> koekoek)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">summary</span>(m)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lengte ~ soort, data = koekoek)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7376 -0.7406  0.0975  0.6869  2.7124 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  22.2876     0.1571 141.862  &lt; 2e-16 ***
## soort2        0.8024     0.3142   2.554 0.011975 *  
## soort3        0.8339     0.3225   2.585 0.010985 *  
## soort4        0.2874     0.3068   0.937 0.350725    
## soort5        0.6158     0.3142   1.960 0.052467 .  
## soort6       -1.1576     0.3142  -3.684 0.000353 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.054 on 114 degrees of freedom
## Multiple R-squared:  0.254,  Adjusted R-squared:  0.2213 
## F-statistic: 7.762 on 5 and 114 DF,  p-value: 2.576e-06</code></pre>
<p>De output van het model suggereert dat er inderdaad verschillen lijken te zijn in gemiddelde lengte tussen de pleegoudersoorten. Merk op dat in de standaard output op basis van dit model de p-waarden echter niet aangepast worden voor meervoudig toetsen. Ook laat het model enkel toe om een toets uit te voeren voor de vergelijking tussen soorten 2-6 en de referentie soort = 1.</p>
<p>Enkel de p-waarde van de globale F-toets kan voor een one-way ANOVA analyse worden gebruikt. Het is de p-waarde die men bekomt wanneer men ons model vergelijkt met een model met enkel het intercept. Het is dus een toets voor de omnibus hypothese dat alle hellingparameters gelijk zijn aan nul.</p>
</div>
</div>
<div id="ga-de-assumpties-voor-een-anova-na." class="section level2">
<h2><span class="header-section-number">5.2</span> Ga de assumpties voor een ANOVA na.</h2>
<p>Zoals beschreven in de cursus, veronderstelt ANOVA een locatie-shift model.</p>
<p>Dit wil zeggen dat de vorm van de distributie in elke groep gelijk is en dat we veronderstellen dat er enkel shifts in gemiddelde kunnen optreden tussen de groepen.</p>
<p>In het bijzonder nemen we de aanname dat de data van elke groep een normale verdeling volgen. Dit impliceert dat de data in</p>
<ul>
<li>elke groep normaal verdeeld moeten zijn en</li>
<li>dat de varianties van de data van alle groepen gelijk is.</li>
</ul>
<p>Bovendien neemt de test nog aan dat alle observaties onafhankelijk zijn van elkaar.</p>
<p>Deze laatste assumptie lijkt te zijn voldaan; de nesten werden willekeurig gekozen.</p>
<p>De eerste twee assumpties kunnen we nagaan indien er niet te veel groepen zijn. Hier hebben we zes groepen en is het checken van assumpties binnen elke groep haalbaar.</p>
<p>Voor het nagaan van homoscedasticiteit werken we met boxplots:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>boxplot</span></code></pre></div>
<p><img src="anova_example_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>We doen dit door de interquartiel ranges (boxbreedtes van de boxplots) met elkaar te vergelijken.</p>
<p>De data lijken gelijke varianties te hebben, en deze assumptie lijkt alvast niet geschonden.</p>
<p>Het is echter niet altijd eenvoudig om te beoordelen of de varianties sterk van mekaar verschillen of niet. Om een beter idee te krijgen, kunnen we eens een aantal boxplots simuleren met dezelfde steekproefgrootte als in de dataset en in de veronderstelling dat de varianties gelijk zijn.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">set.seed</span>(<span class="dv">52</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb21-3"><a href="#cb21-3"></a>sd1&lt;-<span class="st"> </span>m <span class="op">%&gt;%</span><span class="st"> </span>sigma</span>
<span id="cb21-4"><a href="#cb21-4"></a>means&lt;-<span class="st"> </span>koekoek <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(soort) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">m=</span><span class="kw">mean</span>(lengte))</span>
<span id="cb21-5"><a href="#cb21-5"></a>nobs &lt;-koekoek <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(soort) </span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a>plotList &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="cf">function</span>(x,means,sd,nobs)</span>
<span id="cb21-8"><a href="#cb21-8"></a>{</span>
<span id="cb21-9"><a href="#cb21-9"></a>  <span class="kw">data.frame</span>(<span class="dt">y =</span> <span class="kw">rnorm</span>(</span>
<span id="cb21-10"><a href="#cb21-10"></a>      <span class="kw">sum</span>(nobs<span class="op">$</span>n),</span>
<span id="cb21-11"><a href="#cb21-11"></a>      <span class="dt">mean=</span><span class="kw">rep</span>(means<span class="op">$</span>m,<span class="dt">times=</span>nobs<span class="op">$</span>n),</span>
<span id="cb21-12"><a href="#cb21-12"></a>      <span class="dt">sd=</span>sd),</span>
<span id="cb21-13"><a href="#cb21-13"></a>      <span class="dt">soort =</span>  <span class="kw">rep</span>(nobs<span class="op">$</span>soort,<span class="dt">times=</span>nobs<span class="op">$</span>n)</span>
<span id="cb21-14"><a href="#cb21-14"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(soort,y)) <span class="op">+</span></span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb21-17"><a href="#cb21-17"></a><span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">alpha=</span>.<span class="dv">2</span>)</span>
<span id="cb21-18"><a href="#cb21-18"></a>}, <span class="dt">means=</span>means,<span class="dt">nobs=</span>nobs,<span class="dt">sd=</span>sd1)</span>
<span id="cb21-19"><a href="#cb21-19"></a><span class="kw">library</span>(gridExtra)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">do.call</span>(<span class="st">&quot;grid.arrange&quot;</span>,<span class="kw">c</span>(plotList,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>))</span></code></pre></div>
<p><img src="anova_example_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>We zien dat de data die gesimuleerd wordt onder de model veronderstellingen ook gelijkaardige variabiliteit in de boxbreedtes vertonen door toeval.</p>
<p>We gaan vervolgens de assumptie na dat dat data binnen elke groep normaal verdeeld zijn:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Maak QQ-plot voor de lengte van de koekoekseieren per soort </span></span>
<span id="cb25-2"><a href="#cb25-2"></a>plot_qq &lt;-<span class="st"> </span>koekoek <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> lengte)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="st">                        </span><span class="kw">geom_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># qq-punten</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="st">                        </span><span class="kw">geom_qq_line</span>() <span class="op">+</span><span class="st"> </span><span class="co"># qq-lijn</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="st">                        </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="st">                        </span><span class="kw">facet_wrap</span>(<span class="op">~</span>soort)</span>
<span id="cb25-7"><a href="#cb25-7"></a>plot_qq</span></code></pre></div>
<p><img src="anova_example_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Bij de derde soort suggereert de QQ plot wat afwijkingen van normaliteit. We stelden eerder al vast dat soort drie slechts 14 observaties bevat. We kunnen opnieuw data simuleren waarvoor alle aannames voldaan zijn. De afwijkingen die we in onze qqplot zien lijken niet zeer uitzonderlijk te zijn. Ook in de gesimuleerde data zijn we vergelijkbare afwijkingen in sommige steekproeven.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>plotList &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="cf">function</span>(x,means,sd,nobs)</span>
<span id="cb26-2"><a href="#cb26-2"></a>{</span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="kw">data.frame</span>(<span class="dt">y =</span> <span class="kw">rnorm</span>(</span>
<span id="cb26-4"><a href="#cb26-4"></a>      <span class="kw">sum</span>(nobs<span class="op">$</span>n),</span>
<span id="cb26-5"><a href="#cb26-5"></a>      <span class="dt">mean=</span><span class="kw">rep</span>(means<span class="op">$</span>m,<span class="dt">times=</span>nobs<span class="op">$</span>n),</span>
<span id="cb26-6"><a href="#cb26-6"></a>      <span class="dt">sd=</span>sd),</span>
<span id="cb26-7"><a href="#cb26-7"></a>      <span class="dt">soort =</span>  <span class="kw">rep</span>(nobs<span class="op">$</span>soort,<span class="dt">times=</span>nobs<span class="op">$</span>n)</span>
<span id="cb26-8"><a href="#cb26-8"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample=</span>y)) <span class="op">+</span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="st">    </span><span class="kw">geom_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># qq-punten</span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="st">    </span><span class="kw">geom_qq_line</span>() <span class="op">+</span><span class="st"> </span><span class="co"># qq-lijn</span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>soort)</span>
<span id="cb26-14"><a href="#cb26-14"></a>}, <span class="dt">means=</span>means,<span class="dt">nobs=</span>nobs,<span class="dt">sd=</span>sd1)</span>
<span id="cb26-15"><a href="#cb26-15"></a>plotList</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<p><img src="anova_example_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="anova_example_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="anova_example_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
<pre><code>## 
## [[4]]</code></pre>
<p><img src="anova_example_files/figure-html/unnamed-chunk-9-4.png" width="672" /></p>
<pre><code>## 
## [[5]]</code></pre>
<p><img src="anova_example_files/figure-html/unnamed-chunk-9-5.png" width="672" /></p>
<pre><code>## 
## [[6]]</code></pre>
<p><img src="anova_example_files/figure-html/unnamed-chunk-9-6.png" width="672" /></p>
<pre><code>## 
## [[7]]</code></pre>
<p><img src="anova_example_files/figure-html/unnamed-chunk-9-7.png" width="672" /></p>
<pre><code>## 
## [[8]]</code></pre>
<p><img src="anova_example_files/figure-html/unnamed-chunk-9-8.png" width="672" /></p>
<pre><code>## 
## [[9]]</code></pre>
<p><img src="anova_example_files/figure-html/unnamed-chunk-9-9.png" width="672" /></p>
<p>De data van elke groep lijken dus een normale verdeling te volgen.</p>
<p>Indien men veel groepen moet vergelijken, kan het efficiënter zijn om slechts één plot te moeten beoordelen. In dat geval kan men ervoor kiezen om niet voor elke groep apart een QQ-plot te maken, maar kan men de residuen van het lineair model checken. Merk op dat men dan checkt voor een normale distributie van alle residuen van de respons variabele rond hun groepsgemiddelde, en dus niet voor een normale distributie binnen elke groep.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="kw">plot</span>(m) <span class="co"># Enkel figuur rechts boven is relevant</span></span></code></pre></div>
<p><img src="anova_example_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>De QQ-plot vertoont geen systematische afwijkingen van een normale distributie.</p>
<p>Merk op dat je in principe de assumptie van homoscedasticiteit ook op basis van de residuplot linksboven en linksonder zou kunnen checken: elke ‘kolom’ van punten stelt een soort voor (1 soort heeft 1 geschat gemiddelde) en de punten stellen de residuen voor ten opzichte van hun groepsgemiddelde. Men kan deze plot dus ook gebruiken om te kijken of er groepen (soorten) zijn die een verschillende variantie hebben ten opzichte van andere groepen. Hierbij is het voor dit voorbeeld wel van belang om rekening te houden met het grote verschillen in steekproefgrootte tussen de soorten.</p>
</div>
<div id="interpreteer-de-resultaten-van-de-anova-analyse" class="section level2">
<h2><span class="header-section-number">5.3</span> Interpreteer de resultaten van de ANOVA analyse</h2>
<p>We voeren de ANOVA test uit aan de hand van het lineair regressiemodel. In principe testen we dan volgende nulhypothese</p>
<p><span class="math display">\[ H_0: \beta_1 = \beta_2 = \beta_3 = \beta_4 = \beta_5 = 0  \]</span></p>
<p>met de alternatieve hypothese dat minstens één regressieparameters verschillend is van nul.</p>
<p>Merk op dat deze nulhypothese evenwaardig is aan de nulhypothese die we eerder formuleerden. Als alle regressieparameters <span class="math inline">\(\beta_1, \dots, \beta_5 = 0\)</span>, betekent dit dat er geen verschil is tussen de 6 groepsgemiddelde lengtes. Dat ziet men ook eenvoudig in de output van de verschillende groepsgemiddeldes die worden gemodelleerd met het model.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>ExploreModelMatrix<span class="op">::</span><span class="kw">VisualizeDesign</span>(koekoek,<span class="op">~</span>soort)<span class="op">$</span>plotlist</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<p><img src="anova_example_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">anova</span>(m)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"43.1076","3":"8.621519","4":"7.762084","5":"2.575679e-06","_rn_":"soort"},{"1":"114","2":"126.6223","3":"1.110722","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>De p-waarde van deze ANOVA test is bijzonder klein. We besluiten dat we de nulhypothese kunnen verwerpen (<span class="math inline">\(p&lt;&lt;0.001\)</span>) en dat de gemiddelde lengte van koekoekseieren verschilt tussen minstens twee van de bestudeerde pleegoudersoorten op het 5% significantieniveau.</p>
<p>Aan de hand van dit resultaat weten we echter niet tussen welke soorten er een verschil optreedt, en hiervoor zal men een <strong>post-hoc analyse</strong> moeten uitvoeren. Een post-hoc analyse voert men enkel uit indien de ANOVA test significant was, en bestaat erin om paarsgewijze vergelijkingen uit te voeren tussen de groepen.</p>
<div id="post-hoc-analyse" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Post-hoc analyse</h3>
<p>De post-hoc analyse bestaat eruit om paarsgewijze testen uit te voeren. Indien men over <span class="math inline">\(k\)</span> groepen beschikt is het totaal aantal paarsgewijze vergelijkingen gelijk aan <span class="math inline">\(k(k-1)/2\)</span>. In dit voorbeeld is <span class="math inline">\(k=6\)</span> waardoor we <span class="math inline">\(15\)</span> paarsgewijze vergelijkingen zullen uitvoeren. We kunnen echter niet elke test op het 5% significantieniveau uitvoeren vanwege het meervoudig toetsen probleem. Inderdaad, indien men 15 vergelijkingen zou doen, elk op het 5% significantieniveau, dan is de kans dat we minstens één nulhypothese ten onrechte zouden verwerpen veel hoger dan het significantieniveau (5%) die we voor elke individuele test hebben gebruikt. Als alle pairsgewijze vergelijkingen onafhankelijk zouden zijn van elkaar (wat ze niet zijn omdat een heel aantal vergelijkingen dezelfde groepen delen) zouden we die kans kunnen schatten als</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>nComparisons &lt;-<span class="st"> </span><span class="dv">15</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>alpha)<span class="op">^</span>nComparisons</span></code></pre></div>
<pre><code>## [1] 0.5367088</code></pre>
<p>Een conservatieve bovengrens op die kans wordt gegeven door Bonferroni:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>alpha <span class="op">*</span><span class="st"> </span>nComparisons</span></code></pre></div>
<pre><code>## [1] 0.75</code></pre>
<p>Dus indien we elke test op het 5% significantieniveau zouden uitvoeren en als alle nulhypotheses waar zouden zijn, is het heel waarschijnlijk dat we minstens één nulhypothese ten onrechte zouden verwerpen! Om deze kans globaal gezien (dit is, over alle paarsgewijze vergelijkingen) op 5% te houden, moeten we corrigeren voor meervoudig testen.</p>
<p>In <code>R</code> kunnen we de post-hoc analyse uitvoeren met behulp van het <code>multcomp</code> package aan de hand van de <code>glht</code> functie. We specifiëren hier in het <code>linfct</code> argument dat we <em>multiple comparisons</em> (<code>mcp</code>) willen uitvoeren waarbij we alle paarsgewijze vergelijkingen voor de <code>soort</code> variabele willen testen aan de hand van de <code>"Tukey"</code> methode. Het resultaat van deze test slaan we vervolgens op in het object <code>mcp</code>, waarop we een <code>summary</code> opvragen van dat object. Het <code>multcomp</code> package zorgt ervoor dat deze p-waarden automatisch gecorrigeerd worden voor meervoudig toetsen.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">library</span>(multcomp)</span>
<span id="cb45-2"><a href="#cb45-2"></a>mcp &lt;-<span class="st"> </span><span class="kw">glht</span>(m,<span class="dt">linfct=</span><span class="kw">mcp</span>(<span class="dt">soort=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="kw">summary</span>(mcp)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = lengte ~ soort, data = koekoek)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)    
## 2 - 1 == 0  0.80244    0.31421   2.554  0.11453    
## 3 - 1 == 0  0.83387    0.32252   2.585  0.10648    
## 4 - 1 == 0  0.28744    0.30676   0.937  0.93405    
## 5 - 1 == 0  0.61578    0.31421   1.960  0.36564    
## 6 - 1 == 0 -1.15756    0.31421  -3.684  0.00456 ** 
## 3 - 2 == 0  0.03143    0.39164   0.080  1.00000    
## 4 - 2 == 0 -0.51500    0.37877  -1.360  0.74532    
## 5 - 2 == 0 -0.18667    0.38483  -0.485  0.99648    
## 6 - 2 == 0 -1.96000    0.38483  -5.093  &lt; 0.001 ***
## 4 - 3 == 0 -0.54643    0.38569  -1.417  0.71100    
## 5 - 3 == 0 -0.21810    0.39164  -0.557  0.99327    
## 6 - 3 == 0 -1.99143    0.39164  -5.085  &lt; 0.001 ***
## 5 - 4 == 0  0.32833    0.37877   0.867  0.95209    
## 6 - 4 == 0 -1.44500    0.37877  -3.815  0.00286 ** 
## 6 - 5 == 0 -1.77333    0.38483  -4.608  &lt; 0.001 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>In de output hiervan zien we de verschillende paarsgewijze vergelijkingen die werden uitvoerd. Elke vergelijking noemen we ook een contrast. Contrast <code>2 - 1 == 0</code> duidt erop dat voor dit contrast wordt getest of het verschil in gemiddelde lengte voor soort <code>2</code> en dat voor soort <code>1</code> gelijk is aan nul tegen het alternatief dat beide gemiddeldes verschillend zijn. In de tweede kolom wordt het verschil in gemiddelden weergegeven, met hun standaard error en teststatistiek in de respectievelijk derde en vierde kolom. De laatste kolom geeft aangepaste p-waarden weer op een globaal significantieniveau van 5%. Aan de hand van de aangepaste p-waarden zien we dat de gemiddelde lengte van soort 6 (winterkoning) verschilt van alle andere soorten. De effectgrootte is voor alle soorten negatief, hetgeen impliceert dat de gemiddelde lengte van koekoekseieren lager is in nesten van winterkoning in vergelijking met andere soorten.</p>
<p>Voor de rapportering zullen we ook betrouwbaarheidsintervallen voor elke paarsgewijze vergelijking opvragen. We kunnen deze ook makkelijk grafisch voorstellen aan de hand van de <code>plot</code> functie die op een <code>glht</code> object kan toegepast worden. De betrouwbaarheidsintervallen worden opnieuw gecorrigeerd voor meervoudig testen.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">confint</span>(mcp)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = lengte ~ soort, data = koekoek)
## 
## Quantile = 2.8894
## 95% family-wise confidence level
##  
## 
## Linear Hypotheses:
##            Estimate lwr      upr     
## 2 - 1 == 0  0.80244 -0.10543  1.71032
## 3 - 1 == 0  0.83387 -0.09800  1.76575
## 4 - 1 == 0  0.28744 -0.59890  1.17379
## 5 - 1 == 0  0.61578 -0.29210  1.52365
## 6 - 1 == 0 -1.15756 -2.06543 -0.24968
## 3 - 2 == 0  0.03143 -1.10017  1.16303
## 4 - 2 == 0 -0.51500 -1.60941  0.57941
## 5 - 2 == 0 -0.18667 -1.29858  0.92525
## 6 - 2 == 0 -1.96000 -3.07192 -0.84808
## 4 - 3 == 0 -0.54643 -1.66082  0.56797
## 5 - 3 == 0 -0.21810 -1.34969  0.91350
## 6 - 3 == 0 -1.99143 -3.12303 -0.85983
## 5 - 4 == 0  0.32833 -0.76607  1.42274
## 6 - 4 == 0 -1.44500 -2.53941 -0.35059
## 6 - 5 == 0 -1.77333 -2.88525 -0.66142</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">plot</span>(mcp)</span></code></pre></div>
<p><img src="anova_example_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Men kan de bekomen resultaten van de test ook interpreteren a.d.h.v. ruwe data:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>boxplot</span></code></pre></div>
<p><img src="anova_example_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Waar we eveneens evidentie zien dat de eieren gemiddeld kleiner zijn voor nesten van winterkoninkjes i.v.m. andere soorten.</p>
</div>
</div>
</div>
<div id="conclusie" class="section level1">
<h1><span class="header-section-number">6</span> Conclusie</h1>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>winterId &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="kw">rownames</span>(<span class="kw">confint</span>(mcp)<span class="op">$</span>confint),<span class="dt">pattern=</span><span class="st">&quot;6&quot;</span>)</span></code></pre></div>
<p>Er is een extreem significant effect van de pleegoudersoort op de gemiddelde lengte van koekoekseieren (one-way ANOVA test, <span class="math inline">\(p&lt;&lt;0.001\)</span>). Op een globaal 5% significantieniveau is de gemiddelde lengte van koekoekseieren in nesten van winterkoning kleiner dan deze in nesten van alle andere bestudeerde soorten: graspieper (Tukey test, verschil=-1.16, aangepaste p-waarde = 0.005, 95% BI: [-2.07, -0.25]), boompieper (Tukey test, verschil=-1.96, aangepaste p-waarde &lt; 0.001, 95% BI: [-3.07, -0.85]), heggenmus (Tukey test, verschil=-1.99, aangepaste p-waarde &lt; 0.001, 95% BI: [-3.12, -0.86]), roodborstje (Tukey test, verschil=-1.44, aangepaste p-waarde = 0.003, 95% BI: [-2.54, -0.35]) en witte kwikstaart (Tukey test, verschil=-1.77, aangepaste p-waarde &lt; 0.001, 95% BI: [-2.88, -0.66]).</p>
<p>De verschillen in gemiddelde lengte van de koekoekseieren tussen de overige soorten zijn niet significant.</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiUHJhY3RpY3VtIDU6IEFub3ZhIgphdXRob3I6ICJLb2VuIFZhbiBkZW4gQmVyZ2UgZW4gTGlldmVuIENsZW1lbnQiCmRhdGU6ICJzdGF0T21pY3MsIEdoZW50IFVuaXZlcnNpdHkgKGh0dHBzOi8vc3RhdG9taWNzLmdpdGh1Yi5pbykiCgpvdXRwdXQ6CiAgaHRtbF9kb2N1bWVudDoKICAgIGNvZGVfZG93bmxvYWQ6IHllcwogICAgaGlnaGxpZ2h0OiB0YW5nbwogICAgbnVtYmVyX3NlY3Rpb25zOiB5ZXMKICAgIHRoZW1lOiBjb3NtbwogICAgdG9jOiB5ZXMKICAgIHRvY19mbG9hdDogeWVzCiAgcGRmX2RvY3VtZW50OgogICAgdG9jOiB5ZXMKICB3b3JkX2RvY3VtZW50OgogICAgdG9jOiB5ZXMKLS0tCgo8YSByZWw9ImxpY2Vuc2UiIGhyZWY9Imh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1uYy1zYS80LjAiPjxpbWcgYWx0PSJDcmVhdGl2ZSBDb21tb25zIExpY2Vuc2UiIHN0eWxlPSJib3JkZXItd2lkdGg6MCIgc3JjPSJodHRwczovL2kuY3JlYXRpdmVjb21tb25zLm9yZy9sL2J5LW5jLXNhLzQuMC84OHgzMS5wbmciIC8+PC9hPgoKCiMgRGUga29la29layBkYXRhc2V0CgpIZXQgaXMgYmVrZW5kIGRhdCBkZSBrb2Vrb2VrIG5pZXQgemVsZiBlZW4gbmVzdCBib3V3dCBtYWFyIHppam4gZWllcmVuIGxlZ3QgaW4gZGUgbmVzdGVuIHZhbiBhbmRlcmUgdm9nZWxzLiBTaW5kcyAxODkyIHdlZXQgbWVuIHJlZWRzIGRhdCBoZXQgc29vcnQga29la29la3NlaWVyZW4gZWlnZW4gaXMgYWFuIGRlIGxvY2F0aWUgd2FhciB6ZSBnZXZvbmRlbiB3b3JkZW4uIEVlbiBzdHVkaWUgaW4gMTk0MCB0b29uZGUgYWFuIGRhdCBkZSBrb2Vrb2VrZW4gZWxrIGphYXIgdGVydWdrZXJlbiBuYWFyIGhldHplbGZkZSBncm9uZGdlYmllZCBlbiBlaWVyZW4gbGVnZ2VuIGluIGRlIG5lc3RlbiB2YW4gd2VsYmVwYWFsZGUgInBsZWVnb3VkZXIiLXZvZ2Vscy4gQm92ZW5kaWVuIHBhcmVuIGtvZWtvZWtlbiBlbmtlbCBiaW5uZW4gaHVuIGdyb25kZ2ViaWVkLiBPcCBkaWUgbWFuaWVyIHppam4gZ2VvZ3JhZmlzY2hlIHN1YnNvb3J0ZW4gb250d2lra2VsZCwgZWxrIG1ldCBlZW4gZG9taW5hbnRlIHBsZWVnb3VkZXItc29vcnQuCkhpZXJkb29yIGtvbiBlZW4gc3BlY2lhbGlzYXRpZSBvcHRyZWRlbiB2YW4gZGUga29la29layBhYW4gZGUgcGxlZWdvdWRlci1zb29ydCB2aWEgbmF0dXVybGlqa2Ugc2VsZWN0aWUsIHpvZGF0IGRlIGtvZWtvZWtzZWllcmVuIGVlbiBob2dlcmUga2FucyBrcmVnZW4gb20gZ2VhZG9wdGVlcmQgdGUgd29yZGVuIGRvb3IgZGUgcGxlZWdvdWRlci1zb29ydC4KCkRlIGRhdGFzZXQga29la29lay50eHQgYmV2YXQgZGUgbGVuZ3RlICh2YXJpYWJlbGUgYGxlbmd0ZWApIHZhbiBkZSBrb2Vrb2Vrc2VpZXJlbiAoaW4gbW0pIHZhbiB3aWxsZWtldXJpZyBnZWtvemVuIGdlcGFyYXNpdGVlcmRlIG5lc3Rlbi4gSW4gdG90YWFsIGJldmF0IGRlIGRhdGFzZXQgMTIwIG9ic2VydmF0aWVzIGVuIHZvb3IgZWxrIGVpIGlzIGFhbmdlZ2V2ZW4gdmFuIHdlbGtlIHZvZ2Vsc29vcnQgKHZhcmlhYmVsZSBgc29vcnRgKSBoZXQgbmVzdCBpcy4gRGUgY29kZXJpbmcgdm9vciBzb29ydCBpcyBhbHMgdm9sZ3Q6CgogLSBgc29vcnQ9MWA6IGdyYXNwaWVwZXIKIC0gYHNvb3J0PTJgOiBib29tcGllcGVyCiAtIGBzb29ydD0zYDogaGVnZ2VtdXMKIC0gYHNvb3J0PTRgOiByb29kYm9yc3RqZQogLSBgc29vcnQ9NWA6IHdpdHRlIGt3aWtzdGFhcnQKIC0gYHNvb3J0PTZgOiB3aW50ZXJrb25pbmcKCkluIGRlemUgYW5hbHlzZSB6dWxsZW4gd2UgbmFnYWFuIG9mIGRlIHBsZWVnb3VkZXItc29vcnQgZWVuIGludmxvZWQgaGVlZnQgb3AgZGUgZ2VtaWRkZWxkZSBsZW5ndGUgdmFuIGRlIGtvZWtvZWtzZWllcmVuLgoKIyBMaWJyYXJpZXMgbGFkZW4gCmBgYHtyfQpsaWJyYXJ5KGdncGxvdDIpCmxpYnJhcnkoZHBseXIpCiNpbnN0YWxsLnBhY2thZ2VzKCJ0aWR5ciIpCmxpYnJhcnkodGlkeXIpCiNpbnN0YWxsLnBhY2thZ2VzKCJtdWx0Y29tcCIpCmxpYnJhcnkobXVsdGNvbXApCmBgYAoKIyBEYXRhc2V0IGtvZWtvZWsudHh0IGlubGV6ZW4KCmBgYHtyfQprb2Vrb2VrPC1yZWFkLnRhYmxlKCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vc3RhdE9taWNzL3N0YXRpc3RpZWtCYXNpc0N1cnN1c0RhdGEvbWFzdGVyL3ByYWN0aWN1bTUva29la29lay50eHQiLGhlYWRlcj1UUlVFKQpoZWFkKGtvZWtvZWspCmBgYAoKCiMgRGF0YSBleHBsb3JhdGllCgojIyBIb2V2ZWVsIG9ic2VydmF0aWVzIHppam4gZXIgdm9vciBlbGtlIHNvb3J0PyAKClRlbCBoZXQgYWFudGFsIG9ic2VydmF0aWVzIHBlciBzb29ydCBlbiBzbGEgaGV0IHJlc3VsdGFhdCBvcCBpbiBgY291bnRgLiBNYWFrIGVlbiBiYXJwbG90IHZvb3IgZGUgdmFyaWFiZWxlIGBzb29ydGAuCgpgYGB7cn0KY291bnQgPC0ga29la29layAlPiUgY291bnQoc29vcnQpCmNvdW50CmtvZWtvZWsgJT4lIGdncGxvdChhZXMoeCA9IHNvb3J0KSkgKyBnZW9tX2JhcihmaWxsID0gInN0ZWVsYmx1ZSIpCmBgYAoKIyMgRGF0YSB2aXN1YWxpc2F0aWUKCkdlbmVyZWVyIGVlbiBib3hwbG90IHZhbiBkZSBsZW5ndGUgdmFuIGRlIGtvZWtvZWtzZWllcmVuIHZvb3IgZWxrIHZhbiBkZSA2IHZvZ2Vsc29vcnRlbi4gUGxvdCBvb2sgZGUgaW5kaXZpZHVlbGUgb2JzZXJ2YXRpZXMuCmBgYHtyfQprb2Vrb2VrJHNvb3J0IDwtIGFzLmZhY3Rvcihrb2Vrb2VrJHNvb3J0KQpib3hwbG90IDwtIGdncGxvdChkYXRhPWtvZWtvZWssYWVzKHg9c29vcnQsIHk9bGVuZ3RlLCBjb2w9c29vcnQpKSArIAogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlID0gTkEpICsgCiAgZ2VvbV9qaXR0ZXIoKSArCiAgdGhlbWVfYncoKSArIAogIGdndGl0bGUoIkxlbmd0ZSB2YW4gZGUga29la29la3NlaWVyZW4gcGVyIHNvb3J0IikKYm94cGxvdApgYGAKCgoKIyBTdGF0aXN0aXN0aXNjaGUgdG9ldHMKCldlbGtlIHRlc3Qga2FuIG1lbiB1aXR2b2VyZW4gb20gZGUgZ2VtaWRkZWxkZSBsZW5ndGUgc2ltdWx0YWFuIHRlIHZlcmdlbGlqa2VuIHR1c3NlbiBhbGxlIHNvb3J0ZW4/CgpJbiB2b3JpZ2UgbGVzc2VuIHphZ2VuIHdlIGVua2VsIGRlIHR3by1zYW1wbGUgdC10ZXN0IG9tIHR3ZWUgZ2VtaWRkZWxkZW4gbWV0IGVsa2FhciB2ZXJnZWxpamtlbi4KV2UgaGViYmVuIGVjaHRlciBvb2sgcmVlZHMgZ2V6aWVuIGRhdCBkZSB0d28tc2FtcGxlIHQtdGVzdCBlZW4gc3BlY2lmaWVrZSB2ZXJzaWUgaXMgdmFuIGVlbiBsaW5lYWlyIG1vZGVsLCBuYW1lbGlqayB2YW4gZWVuIGxpbmVhaXIgbW9kZWwgd2FhcmJpaiBkZSBjb3ZhcmlhYXQgZWVuIGNhdGVnb3Jpc2NoZSB2YXJpYWJlbGUgJFgkIGlzIG1ldCAkMiQgbGV2ZWxzLCBpLmUuClxbIEUoWV9pKSA9IFxiZXRhXzAgKyBcYmV0YV8xIFhfaSBcXQoKQmlqdm9vcmJlZWxkLCBpbmRpZW4gJFlfaSQgZGUgbGVuZ3RlIHZhbiBwZXJzb29uICRpJCB2b29yc3RlbHQgZW4gJFhfaSQgaGV0IGdlc2xhY2h0IHZhbiBkaWUgcGVyc29vbiB3YWFyYmlqICRYX2k9MCQgaW5kaWVuIHBlcnNvb24gJGkkIGVlbiB2cm91dyBpcywgZW4gJFhfaT0xJCBpbmRpZW4gbmlldC4gSW4gZGF0IGdldmFsLCBzdGVsdCAkXGJldGFfMCQgZGUgZ2VtaWRkZWxkZSBsZW5ndGUgdm9vciB2cm91d2VuIHZvb3IsIGVuICRcYmV0YV8xJCBzdGFhdCB2b29yIGhldCB2ZXJzY2hpbCBpbiBnZW1pZGRlbGRlIGxlbmd0ZSB0dXNzZW4gdnJvdXdlbiBlbiBtYW5uZW4uIERlIGdlbWlkZGVsZGUgbGVuZ3RlIHZvb3IgZWVuIG1hbiBrYW4gbWVuIGRhbiBiZWtvbWVuIGRvb3IgJEUoWV97bWFsZX0pID0gXGJldGFfMCArIFxiZXRhXzEkLiBNZW4ga2FuIGRpdCBvb2sgc2NocmlqdmVuIGFscwpcWyBFKFkgfCBmZW1hbGUpID0gRShZfFg9MCkgPSBcYmV0YV8wXF0KXFsgRShZIHwgbWFsZSkgPSBFKFl8WD0xKSA9IFxiZXRhXzAgKyBcYmV0YV8xXF0KCkRpdCBsaW5lYWlyIG1vZGVsIGthbiBlY2h0ZXIgb29rIG1ha2tlbGlqayB2ZXJhbGdlbWVlbmQgd29yZGVuIG5hYXIgZmFjdG9yZW4gbWV0IG1lZXJkZXJlIGxldmVscy4gCk1lbiBrYW4gaW5kZXJkYWFkIG1lZXJkZXJlIGR1bW15IHZhcmlhYmVsZW4gaW52b2VyZW4gKDEgbWluZGVyIGRhbiBoZXQgYWFudGFsIHRvZXRzZW4pLiAKVm9vciBvbnMgdm9vcmJlZWxkIHp1bGxlbiB3ZSA1IGR1bW15dmFyaWFiZWxlbiBub2RpZyBoZWJiZW46ICRYXzIkLCAkWF8zJCwgJFhfNCQsICRYXzUkIGVuICRYXzYkLiAKRGUgZWVyc3RlIHNvb3J0IGlzIGRhbiBkZSByZWZlcmVudGllZ3JvZXAgKGFsbGUgZHVtbWllcyAkWF8yID0gWF8zID0gWF80ID0gWF81ID0gWF82ID0wJCkuIAoKRXIgYmVzdGFhdCBlZW4gbWFuaWVyIHdhYXJiaWogd2UgKiphbGxlIGxldmVscyBzaW11bHRhYW4ga3VubmVuIHRlc3RlbioqLCBtZW4gemFsIG5hbWVsaWprIHRlc3RlbiBvZiBkZSBnZWhlbGUgZmFjdG9yIHZhcmlhYmVsZSBlZW4gaW52bG9lZCBoZWVmdCBvcCBkZSByZXNwb25zLgpJbiBkZSBjb250ZXh0IHZhbiBvbnMgdm9vcmJlZWxkLCB6YWwgbWVuIGt1bm5lbiB0ZXN0ZW4gb2YgZGUgcGxlZWdvdWRlci1zb29ydCB1YmVyaGF1cHQgZWVuIGVmZmVjdCBoZWVmdCBvcCBkZSBnZW1pZGRlbGRlIGxlbmd0ZSB2YW4ga29la29la3NlaWVyZW4uClpvJ24gZWVuIHRlc3QgaGVldCBlZW4gb25lLXdheSBBTk9WQS4KTWVuIG5vZW10IGRlIHRlc3QgJ29uZS13YXknIG9tZGF0IGhldCBkZSBhc3NvY2lhdGllIGJlc3R1ZGVlcnQgdHVzc2VuIGRlIHJlc3BvbnNlIGVuIDEgZmFjdG9yLCBtZXQgYW5kZXJlIHdvb3JkZW4gaGV0IG1vZGVsIGJldmF0IGdlZW4gbWVlcmRlcmUgZmFjdG9yZW4gKGVua2VsIHJlbGV2YW50IHZvb3Igc3R1ZGVudGVuIGJpb2NoZW1pZSBlbiBiaW9tZWRpc2NoZSB3ZXRlbnNjaGFwcGVuKS4KCgojIyBOdWwtIGVuIGFsdGVybmF0aWV2ZSBoeXBvdGhlc2Ugdm9vciBkZSB0b2V0cwoKU3RlbCBkYXQgJFxtdV8xJCBkZSBnZW1pZGRlbGRlIGxlbmd0ZSB2YW4ga29la29la3NlaWVyZW4gdm9vciBncmFzcGllcGVycyAoYHNvb3J0PTFgKSB2b29yc3RlbHQsIGVuIGlkZW0gdm9vciAkXG11XzIgLCBcbGRvdHMgLCBcbXVfNiQuCkRlIG51bC0gZW4gYWx0ZXJuYXRpZXZlIGh5cG90aGVzZSB2b29yIGVlbiBBTk9WQSBrYW4gbWVuIGRhbiB2b29yc3RlbGxlbiBhbHMKCiRIXzAkOiAkXG11XzE9XG11XzI9XG11XzM9XG11XzQ9XG11XzU9XG11XzYkCgokSF9BJDogVm9vciBtaW5zdGVucyDDqcOpbiAkaSBcbmUgaiQgaXMgJFxtdV9pIFxuZXEgXG11X2okCgpEZSBudWxoeXBvdGhlc2Ugc3RlbHQgZHVzIGRhdCBkZSBnZW1pZGRlbGRlIGxlbmd0ZSB2YW4ga29la29la3NlaXJlbiBuaWV0IGFmaGFuZ3QgdmFuIGRlIHBsZWVnb3VkZXItc29vcnQ6IGVyIGlzIGdlZW4gc3lzdGVtYXRpc2NoIHZlcnNjaGlsIGluIGdlbWlkZGVsZGUgbGVuZ3RlIHZhbiBlaWVyZW4gdHVzc2VuIHZlcnNjaGlsbGVuZGUgcGxlZWdvdWRlci1zb29ydGVuLgpEZSBhbHRlcm5hdGlldmUgaHlwb3RoZXNlIHN0ZWx0IGRhdCBkZSBnZW1pZGRlbGRlIGxlbmd0ZSB2YW4ga29la29la3NlaWVyZW4gdmVyc2NoaWx0IHR1c3NlbiAqKm1pbnN0ZW5zIHR3ZWUgcGxlZWdvdWRlci1zb29ydGVuKiouIE1lcmsgb3AgZGF0IG1lbiBiaWogaGV0IHZlcndlcnBlbiB2YW4gZGUgbnVsaHlwb3RoZXNlICoqbmlldCB3ZWV0IHR1c3NlbiB3ZWxrZSBzb29ydGVuKiogZXIgZWVuIHZlcnNjaGlsIGlzIQoKIyMjIEZpdCBoZXQgbW9kZWwgdm9vciBkZSBhbmFseXNlCldlIGZpdHRlbiBlZW4gbGluZWFpciBtb2RlbCBtZXQgYWxzIHJlc3BvbnMgdmFyaWFiZWxlIGRlIGxlbmd0ZSB2YW4gZGUgZWllcmVuIGVuIGFscyBwcmVkaWN0b3IgZGUgc29vcnQuIE1lcmsgb3AgZGF0IGhldCBiZWxhbmdyaWprIGlzIG9tIHNvb3J0IHRlIGRlZmluacOrcmVuIGFscyBlZW4gZmFjdG9yLCB3YXQgYWwgaW4gb3JkZSB3ZXJkIGdlYnJhY2h0IGJpaiBoZXQgZ2VuZXJlcmVuIHZhbiBkZSBib3hwbG90cy4gUiB6YWwgZGFuIGF1dG9tYXRpc2NoIGhldCB2ZXJlaXN0ZSBhYW50YWwgZHVtbXktdmFyaWFiZWxlbiBhYW5tYWtlbi4gCgoKYGBge3J9Cm0gPC0gbG0obGVuZ3RlfnNvb3J0LCBkYXRhID0ga29la29laykKc3VtbWFyeShtKQpgYGAKCkRlIG91dHB1dCB2YW4gaGV0IG1vZGVsIHN1Z2dlcmVlcnQgZGF0IGVyIGluZGVyZGFhZCB2ZXJzY2hpbGxlbiBsaWprZW4gdGUgemlqbiBpbiBnZW1pZGRlbGRlIGxlbmd0ZSB0dXNzZW4gZGUgcGxlZWdvdWRlcnNvb3J0ZW4uIE1lcmsgb3AgZGF0IGluIGRlIHN0YW5kYWFyZCBvdXRwdXQgb3AgYmFzaXMgdmFuIGRpdCBtb2RlbCBkZSBwLXdhYXJkZW4gZWNodGVyIG5pZXQgYWFuZ2VwYXN0IHdvcmRlbiB2b29yIG1lZXJ2b3VkaWcgdG9ldHNlbi4gT29rIGxhYXQgaGV0IG1vZGVsIGVua2VsIHRvZSBvbSBlZW4gdG9ldHMgdWl0IHRlIHZvZXJlbiB2b29yIGRlIHZlcmdlbGlqa2luZyB0dXNzZW4gc29vcnRlbiAyLTYgZW4gZGUgcmVmZXJlbnRpZSBzb29ydCA9IDEuIAoKRW5rZWwgZGUgcC13YWFyZGUgdmFuIGRlIGdsb2JhbGUgRi10b2V0cyBrYW4gdm9vciBlZW4gb25lLXdheSBBTk9WQSBhbmFseXNlIHdvcmRlbiBnZWJydWlrdC4gSGV0IGlzIGRlIHAtd2FhcmRlIGRpZSBtZW4gYmVrb210IHdhbm5lZXIgbWVuIG9ucyBtb2RlbCB2ZXJnZWxpamt0IG1ldCBlZW4gbW9kZWwgbWV0IGVua2VsIGhldCBpbnRlcmNlcHQuIEhldCBpcyBkdXMgZWVuIHRvZXRzIHZvb3IgZGUgb21uaWJ1cyBoeXBvdGhlc2UgZGF0IGFsbGUgaGVsbGluZ3BhcmFtZXRlcnMgZ2VsaWprIHppam4gYWFuIG51bC4gCgojIyBHYSBkZSBhc3N1bXB0aWVzIHZvb3IgZWVuIEFOT1ZBIG5hLgoKWm9hbHMgYmVzY2hyZXZlbiBpbiBkZSBjdXJzdXMsIHZlcm9uZGVyc3RlbHQgQU5PVkEgZWVuIGxvY2F0aWUtc2hpZnQgbW9kZWwuCgpEaXQgd2lsIHplZ2dlbiBkYXQgZGUgdm9ybSB2YW4gZGUgZGlzdHJpYnV0aWUgaW4gZWxrZSBncm9lcCBnZWxpamsgaXMgZW4gZGF0IHdlIHZlcm9uZGVyc3RlbGxlbiBkYXQgZXIgZW5rZWwgc2hpZnRzIGluIGdlbWlkZGVsZGUga3VubmVuIG9wdHJlZGVuIHR1c3NlbiBkZSBncm9lcGVuLgoKSW4gaGV0IGJpanpvbmRlciBuZW1lbiB3ZSBkZSBhYW5uYW1lIGRhdCBkZSBkYXRhIHZhbiBlbGtlIGdyb2VwIGVlbiBub3JtYWxlIHZlcmRlbGluZyB2b2xnZW4uCkRpdCBpbXBsaWNlZXJ0IGRhdCBkZSBkYXRhIGluCgogLSBlbGtlIGdyb2VwIG5vcm1hYWwgdmVyZGVlbGQgbW9ldGVuIHppam4gZW4KIC0gZGF0IGRlIHZhcmlhbnRpZXMgdmFuIGRlIGRhdGEgdmFuIGFsbGUgZ3JvZXBlbiBnZWxpamsgaXMuCiAKIEJvdmVuZGllbiBuZWVtdCBkZSB0ZXN0IG5vZyBhYW4gZGF0IGFsbGUgb2JzZXJ2YXRpZXMgb25hZmhhbmtlbGlqayB6aWpuIHZhbiBlbGthYXIuIAoKRGV6ZSBsYWF0c3RlIGFzc3VtcHRpZSBsaWprdCB0ZSB6aWpuIHZvbGRhYW47IGRlIG5lc3RlbiB3ZXJkZW4gd2lsbGVrZXVyaWcgZ2Vrb3plbi4KCkRlIGVlcnN0ZSB0d2VlIGFzc3VtcHRpZXMga3VubmVuIHdlIG5hZ2FhbiBpbmRpZW4gZXIgbmlldCB0ZSB2ZWVsIGdyb2VwZW4gemlqbi4gSGllciBoZWJiZW4gd2UgemVzIGdyb2VwZW4gZW4gaXMgaGV0IGNoZWNrZW4gdmFuIGFzc3VtcHRpZXMgYmlubmVuIGVsa2UgZ3JvZXAgaGFhbGJhYXIuCgpWb29yIGhldCBuYWdhYW4gdmFuIGhvbW9zY2VkYXN0aWNpdGVpdCB3ZXJrZW4gd2UgbWV0IGJveHBsb3RzOgoKYGBge3J9CmJveHBsb3QKYGBgCgpXZSBkb2VuIGRpdCBkb29yIGRlIGludGVycXVhcnRpZWwgcmFuZ2VzIChib3hicmVlZHRlcyB2YW4gZGUgYm94cGxvdHMpIG1ldCBlbGthYXIgdGUgdmVyZ2VsaWprZW4uIAoKRGUgZGF0YSBsaWprZW4gZ2VsaWprZSB2YXJpYW50aWVzIHRlIGhlYmJlbiwgZW4gZGV6ZSBhc3N1bXB0aWUgbGlqa3QgYWx2YXN0IG5pZXQgZ2VzY2hvbmRlbi4KCkhldCBpcyBlY2h0ZXIgbmlldCBhbHRpamQgZWVudm91ZGlnIG9tIHRlIGJlb29yZGVsZW4gb2YgZGUgdmFyaWFudGllcyBzdGVyayB2YW4gbWVrYWFyIHZlcnNjaGlsbGVuIG9mIG5pZXQuIE9tIGVlbiBiZXRlciBpZGVlIHRlIGtyaWpnZW4sIGt1bm5lbiB3ZSBlZW5zIGVlbiBhYW50YWwgYm94cGxvdHMgc2ltdWxlcmVuIG1ldCBkZXplbGZkZSBzdGVla3Byb2VmZ3Jvb3R0ZSBhbHMgaW4gZGUgZGF0YXNldCBlbiBpbiBkZSB2ZXJvbmRlcnN0ZWxsaW5nIGRhdCBkZSB2YXJpYW50aWVzIGdlbGlqayB6aWpuLgoKYGBge3J9CnNldC5zZWVkKDUyKQpwYXIobWZyb3c9YygzLDMpLCBtYXI9YygzLDIsMSwxKSkKc2QxPC0gbSAlPiUgc2lnbWEKbWVhbnM8LSBrb2Vrb2VrICU+JSBncm91cF9ieShzb29ydCkgJT4lIHN1bW1hcmlzZShtPW1lYW4obGVuZ3RlKSkKbm9icyA8LWtvZWtvZWsgJT4lIGNvdW50KHNvb3J0KSAKCnBsb3RMaXN0IDwtIGxhcHBseSgxOjksIGZ1bmN0aW9uKHgsbWVhbnMsc2Qsbm9icykKewogIGRhdGEuZnJhbWUoeSA9IHJub3JtKAogICAgICBzdW0obm9icyRuKSwKICAgICAgbWVhbj1yZXAobWVhbnMkbSx0aW1lcz1ub2JzJG4pLAogICAgICBzZD1zZCksCiAgICAgIHNvb3J0ID0gIHJlcChub2JzJHNvb3J0LHRpbWVzPW5vYnMkbikKICApICU+JSAKICAgIGdncGxvdChhZXMoc29vcnQseSkpICsKICAgIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlID0gTkEpICsKICAgIGdlb21faml0dGVyKGFscGhhPS4yKQp9LCBtZWFucz1tZWFucyxub2JzPW5vYnMsc2Q9c2QxKQpsaWJyYXJ5KGdyaWRFeHRyYSkKZG8uY2FsbCgiZ3JpZC5hcnJhbmdlIixjKHBsb3RMaXN0LG5yb3c9MyxuY29sPTMpKQpgYGAKCldlIHppZW4gZGF0IGRlIGRhdGEgZGllIGdlc2ltdWxlZXJkIHdvcmR0IG9uZGVyIGRlIG1vZGVsIHZlcm9uZGVyc3RlbGxpbmdlbiBvb2sgZ2VsaWprYWFyZGlnZSB2YXJpYWJpbGl0ZWl0IGluIGRlIGJveGJyZWVkdGVzIHZlcnRvbmVuIGRvb3IgdG9ldmFsLiAKCldlIGdhYW4gdmVydm9sZ2VucyBkZSBhc3N1bXB0aWUgbmEgZGF0IGRhdCBkYXRhIGJpbm5lbiBlbGtlIGdyb2VwIG5vcm1hYWwgdmVyZGVlbGQgemlqbjoKCmBgYHtyfQojIE1hYWsgUVEtcGxvdCB2b29yIGRlIGxlbmd0ZSB2YW4gZGUga29la29la3NlaWVyZW4gcGVyIHNvb3J0IApwbG90X3FxIDwtIGtvZWtvZWsgJT4lIGdncGxvdChhZXMoc2FtcGxlID0gbGVuZ3RlKSkgKyAKICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbV9xcSgpICsgIyBxcS1wdW50ZW4KICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbV9xcV9saW5lKCkgKyAjIHFxLWxpam4KICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWVfYncoKSArIAogICAgICAgICAgICAgICAgICAgICAgICBmYWNldF93cmFwKH5zb29ydCkKcGxvdF9xcQpgYGAKCkJpaiBkZSBkZXJkZSBzb29ydCBzdWdnZXJlZXJ0IGRlIFFRIHBsb3Qgd2F0IGFmd2lqa2luZ2VuIHZhbiBub3JtYWxpdGVpdC4gCldlIHN0ZWxkZW4gZWVyZGVyIGFsIHZhc3QgZGF0IHNvb3J0IGRyaWUgc2xlY2h0cyAxNCBvYnNlcnZhdGllcyBiZXZhdC4gCldlIGt1bm5lbiBvcG5pZXV3IGRhdGEgc2ltdWxlcmVuIHdhYXJ2b29yIGFsbGUgYWFubmFtZXMgdm9sZGFhbiB6aWpuLiAKRGUgYWZ3aWpraW5nZW4gZGllIHdlIGluIG9uemUgcXFwbG90IHppZW4gbGlqa2VuIG5pZXQgemVlciB1aXR6b25kZXJsaWprIHRlIHppam4uIApPb2sgaW4gZGUgZ2VzaW11bGVlcmRlIGRhdGEgemlqbiB3ZSB2ZXJnZWxpamtiYXJlIGFmd2lqa2luZ2VuIGluIHNvbW1pZ2Ugc3RlZWtwcm9ldmVuLgoKYGBge3J9CnBsb3RMaXN0IDwtIGxhcHBseSgxOjksIGZ1bmN0aW9uKHgsbWVhbnMsc2Qsbm9icykKewogIGRhdGEuZnJhbWUoeSA9IHJub3JtKAogICAgICBzdW0obm9icyRuKSwKICAgICAgbWVhbj1yZXAobWVhbnMkbSx0aW1lcz1ub2JzJG4pLAogICAgICBzZD1zZCksCiAgICAgIHNvb3J0ID0gIHJlcChub2JzJHNvb3J0LHRpbWVzPW5vYnMkbikKICApICU+JSAKICAgIGdncGxvdChhZXMoc2FtcGxlPXkpKSArCiAgICBnZW9tX3FxKCkgKyAjIHFxLXB1bnRlbgogICAgZ2VvbV9xcV9saW5lKCkgKyAjIHFxLWxpam4KICAgIHRoZW1lX2J3KCkgKyAKICAgIGZhY2V0X3dyYXAofnNvb3J0KQp9LCBtZWFucz1tZWFucyxub2JzPW5vYnMsc2Q9c2QxKQpwbG90TGlzdApgYGAKCgoKRGUgZGF0YSB2YW4gZWxrZSBncm9lcCBsaWprZW4gZHVzIGVlbiBub3JtYWxlIHZlcmRlbGluZyB0ZSB2b2xnZW4uCgpJbmRpZW4gbWVuIHZlZWwgZ3JvZXBlbiBtb2V0IHZlcmdlbGlqa2VuLCBrYW4gaGV0IGVmZmljacOrbnRlciB6aWpuIG9tIHNsZWNodHMgw6nDqW4gcGxvdCB0ZSBtb2V0ZW4gYmVvb3JkZWxlbi4gSW4gZGF0IGdldmFsIGthbiBtZW4gZXJ2b29yIGtpZXplbiBvbSBuaWV0IHZvb3IgZWxrZSBncm9lcCBhcGFydCBlZW4gUVEtcGxvdCB0ZSBtYWtlbiwgbWFhciBrYW4gbWVuIGRlIHJlc2lkdWVuIHZhbiBoZXQgbGluZWFpciBtb2RlbCBjaGVja2VuLiAKTWVyayBvcCBkYXQgbWVuIGRhbiBjaGVja3Qgdm9vciBlZW4gbm9ybWFsZSBkaXN0cmlidXRpZSB2YW4gYWxsZSByZXNpZHVlbiB2YW4gZGUgcmVzcG9ucyB2YXJpYWJlbGUgcm9uZCBodW4gZ3JvZXBzZ2VtaWRkZWxkZSwgZW4gZHVzIG5pZXQgdm9vciBlZW4gbm9ybWFsZSBkaXN0cmlidXRpZSBiaW5uZW4gZWxrZSBncm9lcC4KCmBgYHtyfQpwYXIobWZyb3c9YygyLDIpKQpwbG90KG0pICMgRW5rZWwgZmlndXVyIHJlY2h0cyBib3ZlbiBpcyByZWxldmFudApwYXIobWZyb3c9YygxLDEpKQpgYGAKCkRlIFFRLXBsb3QgdmVydG9vbnQgZ2VlbiBzeXN0ZW1hdGlzY2hlIGFmd2lqa2luZ2VuIHZhbiBlZW4gbm9ybWFsZSBkaXN0cmlidXRpZS4gCgpNZXJrIG9wIGRhdCBqZSBpbiBwcmluY2lwZSBkZSBhc3N1bXB0aWUgdmFuIGhvbW9zY2VkYXN0aWNpdGVpdCBvb2sgb3AgYmFzaXMgdmFuIGRlIHJlc2lkdXBsb3QgbGlua3Nib3ZlbiBlbiBsaW5rc29uZGVyIHpvdSBrdW5uZW4gY2hlY2tlbjogZWxrZSAna29sb20nIHZhbiBwdW50ZW4gc3RlbHQgZWVuIHNvb3J0IHZvb3IgKDEgc29vcnQgaGVlZnQgMSBnZXNjaGF0IGdlbWlkZGVsZGUpIGVuIGRlIHB1bnRlbiBzdGVsbGVuIGRlIHJlc2lkdWVuIHZvb3IgdGVuIG9wemljaHRlIHZhbiBodW4gZ3JvZXBzZ2VtaWRkZWxkZS4gTWVuIGthbiBkZXplIHBsb3QgZHVzIG9vayBnZWJydWlrZW4gb20gdGUga2lqa2VuIG9mIGVyIGdyb2VwZW4gKHNvb3J0ZW4pIHppam4gZGllIGVlbiB2ZXJzY2hpbGxlbmRlIHZhcmlhbnRpZSBoZWJiZW4gdGVuIG9wemljaHRlIHZhbiBhbmRlcmUgZ3JvZXBlbi4gSGllcmJpaiBpcyBoZXQgdm9vciBkaXQgdm9vcmJlZWxkIHdlbCB2YW4gYmVsYW5nIG9tIHJla2VuaW5nIHRlIGhvdWRlbiBtZXQgaGV0IGdyb3RlIHZlcnNjaGlsbGVuIGluIHN0ZWVrcHJvZWZncm9vdHRlIHR1c3NlbiBkZSBzb29ydGVuLiAKCiMjIEludGVycHJldGVlciBkZSByZXN1bHRhdGVuIHZhbiBkZSBBTk9WQSBhbmFseXNlCgpXZSB2b2VyZW4gZGUgQU5PVkEgdGVzdCB1aXQgYWFuIGRlIGhhbmQgdmFuIGhldCBsaW5lYWlyIHJlZ3Jlc3NpZW1vZGVsLiBJbiBwcmluY2lwZSB0ZXN0ZW4gd2UgZGFuIHZvbGdlbmRlIG51bGh5cG90aGVzZQoKXFsgSF8wOiBcYmV0YV8xID0gXGJldGFfMiA9IFxiZXRhXzMgPSBcYmV0YV80ID0gXGJldGFfNSA9IDAgIFxdCgptZXQgZGUgYWx0ZXJuYXRpZXZlIGh5cG90aGVzZSBkYXQgbWluc3RlbnMgw6nDqW4gcmVncmVzc2llcGFyYW1ldGVycyB2ZXJzY2hpbGxlbmQgaXMgdmFuIG51bC4gCgpNZXJrIG9wIGRhdCBkZXplIG51bGh5cG90aGVzZSBldmVud2FhcmRpZyBpcyBhYW4gZGUgbnVsaHlwb3RoZXNlIGRpZSB3ZSBlZXJkZXIgZm9ybXVsZWVyZGVuLiBBbHMgYWxsZSByZWdyZXNzaWVwYXJhbWV0ZXJzICRcYmV0YV8xLCBcZG90cywgXGJldGFfNSA9IDAkLCBiZXRla2VudCBkaXQgZGF0IGVyIGdlZW4gdmVyc2NoaWwgaXMgdHVzc2VuIGRlIDYgZ3JvZXBzZ2VtaWRkZWxkZSBsZW5ndGVzLiBEYXQgemlldCBtZW4gb29rIGVlbnZvdWRpZyBpbiBkZSBvdXRwdXQgdmFuIGRlIHZlcnNjaGlsbGVuZGUgZ3JvZXBzZ2VtaWRkZWxkZXMgZGllIHdvcmRlbiBnZW1vZGVsbGVlcmQgbWV0IGhldCBtb2RlbC4gCgpgYGB7cn0KRXhwbG9yZU1vZGVsTWF0cml4OjpWaXN1YWxpemVEZXNpZ24oa29la29layx+c29vcnQpJHBsb3RsaXN0CmBgYAoKCmBgYHtyfQphbm92YShtKQpgYGAKCkRlIHAtd2FhcmRlIHZhbiBkZXplIEFOT1ZBIHRlc3QgaXMgYmlqem9uZGVyIGtsZWluLiBXZSBiZXNsdWl0ZW4gZGF0IHdlIGRlIG51bGh5cG90aGVzZSBrdW5uZW4gdmVyd2VycGVuICgkcDw8MC4wMDEkKSBlbiBkYXQgZGUgZ2VtaWRkZWxkZSBsZW5ndGUgdmFuIGtvZWtvZWtzZWllcmVuIHZlcnNjaGlsdCB0dXNzZW4gbWluc3RlbnMgdHdlZSB2YW4gZGUgYmVzdHVkZWVyZGUgcGxlZWdvdWRlcnNvb3J0ZW4gb3AgaGV0IDUlIHNpZ25pZmljYW50aWVuaXZlYXUuCgpBYW4gZGUgaGFuZCB2YW4gZGl0IHJlc3VsdGFhdCB3ZXRlbiB3ZSBlY2h0ZXIgbmlldCB0dXNzZW4gd2Vsa2Ugc29vcnRlbiBlciBlZW4gdmVyc2NoaWwgb3B0cmVlZHQsIGVuIGhpZXJ2b29yIHphbCBtZW4gZWVuICoqcG9zdC1ob2MgYW5hbHlzZSoqIG1vZXRlbiB1aXR2b2VyZW4uIEVlbiBwb3N0LWhvYyBhbmFseXNlIHZvZXJ0IG1lbiBlbmtlbCB1aXQgaW5kaWVuIGRlIEFOT1ZBIHRlc3Qgc2lnbmlmaWNhbnQgd2FzLCBlbiBiZXN0YWF0IGVyaW4gb20gcGFhcnNnZXdpanplIHZlcmdlbGlqa2luZ2VuIHVpdCB0ZSB2b2VyZW4gdHVzc2VuIGRlIGdyb2VwZW4uCgojIyMgUG9zdC1ob2MgYW5hbHlzZQoKRGUgcG9zdC1ob2MgYW5hbHlzZSBiZXN0YWF0IGVydWl0IG9tIHBhYXJzZ2V3aWp6ZSB0ZXN0ZW4gdWl0IHRlIHZvZXJlbi4gSW5kaWVuIG1lbiBvdmVyICRrJCBncm9lcGVuIGJlc2NoaWt0IGlzIGhldCB0b3RhYWwgYWFudGFsIHBhYXJzZ2V3aWp6ZSB2ZXJnZWxpamtpbmdlbiBnZWxpamsgYWFuICRrKGstMSkvMiQuIEluIGRpdCB2b29yYmVlbGQgaXMgJGs9NiQgd2FhcmRvb3Igd2UgJDE1JCBwYWFyc2dld2lqemUgdmVyZ2VsaWpraW5nZW4genVsbGVuIHVpdHZvZXJlbi4KV2Uga3VubmVuIGVjaHRlciBuaWV0IGVsa2UgdGVzdCBvcCBoZXQgNSUgc2lnbmlmaWNhbnRpZW5pdmVhdSB1aXR2b2VyZW4gdmFud2VnZSBoZXQgbWVlcnZvdWRpZyB0b2V0c2VuIHByb2JsZWVtLiAKSW5kZXJkYWFkLCBpbmRpZW4gbWVuIDE1IHZlcmdlbGlqa2luZ2VuIHpvdSBkb2VuLCBlbGsgb3AgaGV0IDUlIHNpZ25pZmljYW50aWVuaXZlYXUsIGRhbiBpcyBkZSBrYW5zIGRhdCB3ZSBtaW5zdGVucyDDqcOpbiBudWxoeXBvdGhlc2UgdGVuIG9ucmVjaHRlIHpvdWRlbiB2ZXJ3ZXJwZW4gdmVlbCBob2dlciBkYW4gaGV0IHNpZ25pZmljYW50aWVuaXZlYXUgKDUlKSBkaWUgd2Ugdm9vciBlbGtlIGluZGl2aWR1ZWxlIHRlc3QgaGViYmVuIGdlYnJ1aWt0LgpBbHMgYWxsZSBwYWlyc2dld2lqemUgdmVyZ2VsaWpraW5nZW4gb25hZmhhbmtlbGlqayB6b3VkZW4gemlqbiB2YW4gZWxrYWFyICh3YXQgemUgbmlldCB6aWpuIG9tZGF0IGVlbiBoZWVsIGFhbnRhbCB2ZXJnZWxpamtpbmdlbiBkZXplbGZkZSBncm9lcGVuIGRlbGVuKSB6b3VkZW4gd2UgZGllIGthbnMga3VubmVuIHNjaGF0dGVuIGFscyAKCmBgYHtyfQphbHBoYSA8LSAwLjA1Cm5Db21wYXJpc29ucyA8LSAxNQoxLSgxLWFscGhhKV5uQ29tcGFyaXNvbnMKYGBgCgpFZW4gY29uc2VydmF0aWV2ZSBib3ZlbmdyZW5zIG9wIGRpZSBrYW5zIHdvcmR0IGdlZ2V2ZW4gZG9vciBCb25mZXJyb25pOiAKCmBgYHtyfQphbHBoYSAqIG5Db21wYXJpc29ucwpgYGAKCkR1cyBpbmRpZW4gd2UgZWxrZSB0ZXN0IG9wIGhldCA1JSBzaWduaWZpY2FudGllbml2ZWF1IHpvdWRlbiB1aXR2b2VyZW4gZW4gYWxzIGFsbGUgbnVsaHlwb3RoZXNlcyB3YWFyIHpvdWRlbiB6aWpuLCBpcyBoZXQgaGVlbCB3YWFyc2NoaWpubGlqayBkYXQgd2UgbWluc3RlbnMgw6nDqW4gbnVsaHlwb3RoZXNlIHRlbiBvbnJlY2h0ZSB6b3VkZW4gdmVyd2VycGVuIQpPbSBkZXplIGthbnMgZ2xvYmFhbCBnZXppZW4gKGRpdCBpcywgb3ZlciBhbGxlIHBhYXJzZ2V3aWp6ZSB2ZXJnZWxpamtpbmdlbikgb3AgNSUgdGUgaG91ZGVuLCBtb2V0ZW4gd2UgY29ycmlnZXJlbiB2b29yIG1lZXJ2b3VkaWcgdGVzdGVuLiAKCkluIGBSYCBrdW5uZW4gd2UgZGUgcG9zdC1ob2MgYW5hbHlzZSB1aXR2b2VyZW4gbWV0IGJlaHVscCB2YW4gaGV0IGBtdWx0Y29tcGAgcGFja2FnZSBhYW4gZGUgaGFuZCB2YW4gZGUgYGdsaHRgIGZ1bmN0aWUuIFdlIHNwZWNpZmnDq3JlbiBoaWVyIGluIGhldCBgbGluZmN0YCBhcmd1bWVudCBkYXQgd2UgKm11bHRpcGxlIGNvbXBhcmlzb25zKiAoYG1jcGApIHdpbGxlbiB1aXR2b2VyZW4gd2FhcmJpaiB3ZSBhbGxlIHBhYXJzZ2V3aWp6ZSB2ZXJnZWxpamtpbmdlbiB2b29yIGRlIGBzb29ydGAgdmFyaWFiZWxlIHdpbGxlbiB0ZXN0ZW4gYWFuIGRlIGhhbmQgdmFuIGRlIGAiVHVrZXkiYCBtZXRob2RlLiBIZXQgcmVzdWx0YWF0IHZhbiBkZXplIHRlc3Qgc2xhYW4gd2UgdmVydm9sZ2VucyBvcCBpbiBoZXQgb2JqZWN0IGBtY3BgLCB3YWFyb3Agd2UgZWVuIGBzdW1tYXJ5YCBvcHZyYWdlbiB2YW4gZGF0IG9iamVjdC4gSGV0IGBtdWx0Y29tcGAgcGFja2FnZSB6b3JndCBlcnZvb3IgZGF0IGRlemUgcC13YWFyZGVuIGF1dG9tYXRpc2NoIGdlY29ycmlnZWVyZCB3b3JkZW4gdm9vciBtZWVydm91ZGlnIHRvZXRzZW4uCgpgYGB7cn0KbGlicmFyeShtdWx0Y29tcCkKbWNwIDwtIGdsaHQobSxsaW5mY3Q9bWNwKHNvb3J0PSJUdWtleSIpKQpzdW1tYXJ5KG1jcCkKYGBgCgpJbiBkZSBvdXRwdXQgaGllcnZhbiB6aWVuIHdlIGRlIHZlcnNjaGlsbGVuZGUgcGFhcnNnZXdpanplIHZlcmdlbGlqa2luZ2VuIGRpZSB3ZXJkZW4gdWl0dm9lcmQuIApFbGtlIHZlcmdlbGlqa2luZyBub2VtZW4gd2Ugb29rIGVlbiBjb250cmFzdC4gCkNvbnRyYXN0IGAyIC0gMSA9PSAwYCBkdWlkdCBlcm9wIGRhdCB2b29yIGRpdCBjb250cmFzdCB3b3JkdCBnZXRlc3Qgb2YgaGV0IHZlcnNjaGlsIGluIGdlbWlkZGVsZGUgbGVuZ3RlIHZvb3Igc29vcnQgYDJgIGVuIGRhdCB2b29yIHNvb3J0IGAxYCBnZWxpamsgaXMgYWFuIG51bCB0ZWdlbiBoZXQgYWx0ZXJuYXRpZWYgZGF0IGJlaWRlIGdlbWlkZGVsZGVzIHZlcnNjaGlsbGVuZCB6aWpuLgpJbiBkZSB0d2VlZGUga29sb20gd29yZHQgaGV0IHZlcnNjaGlsIGluIGdlbWlkZGVsZGVuIHdlZXJnZWdldmVuLCBtZXQgaHVuIHN0YW5kYWFyZCBlcnJvciBlbiB0ZXN0c3RhdGlzdGllayBpbiBkZSByZXNwZWN0aWV2ZWxpamsgZGVyZGUgZW4gdmllcmRlIGtvbG9tLgpEZSBsYWF0c3RlIGtvbG9tIGdlZWZ0IGFhbmdlcGFzdGUgcC13YWFyZGVuIHdlZXIgb3AgZWVuIGdsb2JhYWwgc2lnbmlmaWNhbnRpZW5pdmVhdSB2YW4gNSUuCkFhbiBkZSBoYW5kIHZhbiBkZSBhYW5nZXBhc3RlIHAtd2FhcmRlbiB6aWVuIHdlIGRhdCBkZSBnZW1pZGRlbGRlIGxlbmd0ZSB2YW4gc29vcnQgNiAod2ludGVya29uaW5nKSB2ZXJzY2hpbHQgdmFuIGFsbGUgYW5kZXJlIHNvb3J0ZW4uIApEZSBlZmZlY3Rncm9vdHRlIGlzIHZvb3IgYWxsZSBzb29ydGVuIG5lZ2F0aWVmLCBoZXRnZWVuIGltcGxpY2VlcnQgZGF0IGRlIGdlbWlkZGVsZGUgbGVuZ3RlIHZhbiBrb2Vrb2Vrc2VpZXJlbiBsYWdlciBpcyBpbiBuZXN0ZW4gdmFuIHdpbnRlcmtvbmluZyBpbiB2ZXJnZWxpamtpbmcgbWV0IGFuZGVyZSBzb29ydGVuLgoKVm9vciBkZSByYXBwb3J0ZXJpbmcgenVsbGVuIHdlIG9vayBiZXRyb3V3YmFhcmhlaWRzaW50ZXJ2YWxsZW4gdm9vciBlbGtlIHBhYXJzZ2V3aWp6ZSB2ZXJnZWxpamtpbmcgb3B2cmFnZW4uIFdlIGt1bm5lbiBkZXplIG9vayBtYWtrZWxpamsgZ3JhZmlzY2ggdm9vcnN0ZWxsZW4gYWFuIGRlIGhhbmQgdmFuIGRlIGBwbG90YCBmdW5jdGllIGRpZSBvcCBlZW4gYGdsaHRgIG9iamVjdCBrYW4gdG9lZ2VwYXN0IHdvcmRlbi4KRGUgYmV0cm91d2JhYXJoZWlkc2ludGVydmFsbGVuIHdvcmRlbiBvcG5pZXV3IGdlY29ycmlnZWVyZCB2b29yIG1lZXJ2b3VkaWcgdGVzdGVuLiAKCmBgYHtyfQpjb25maW50KG1jcCkKcGxvdChtY3ApCmBgYAoKTWVuIGthbiBkZSBiZWtvbWVuIHJlc3VsdGF0ZW4gdmFuIGRlIHRlc3Qgb29rIGludGVycHJldGVyZW4gYS5kLmgudi4gcnV3ZSBkYXRhOiAKCmBgYHtyfQpib3hwbG90CmBgYAoKV2FhciB3ZSBldmVuZWVucyBldmlkZW50aWUgemllbiBkYXQgZGUgZWllcmVuIGdlbWlkZGVsZCBrbGVpbmVyIHppam4gdm9vciBuZXN0ZW4gdmFuIHdpbnRlcmtvbmlua2plcyBpLnYubS4gYW5kZXJlIHNvb3J0ZW4uIAoKIyBDb25jbHVzaWUKCmBgYHtyfQp3aW50ZXJJZCA8LSBncmVwKHJvd25hbWVzKGNvbmZpbnQobWNwKSRjb25maW50KSxwYXR0ZXJuPSI2IikKYGBgCgpFciBpcyBlZW4gZXh0cmVlbSBzaWduaWZpY2FudCBlZmZlY3QgdmFuIGRlIHBsZWVnb3VkZXJzb29ydCBvcCBkZSBnZW1pZGRlbGRlIGxlbmd0ZSB2YW4ga29la29la3NlaWVyZW4gKG9uZS13YXkgQU5PVkEgdGVzdCwgJHA8PDAuMDAxJCkuCk9wIGVlbiBnbG9iYWFsIDUlIHNpZ25pZmljYW50aWVuaXZlYXUgaXMgZGUgZ2VtaWRkZWxkZSBsZW5ndGUgdmFuIGtvZWtvZWtzZWllcmVuIGluIG5lc3RlbiB2YW4gd2ludGVya29uaW5nIGtsZWluZXIgZGFuIGRlemUgaW4gbmVzdGVuIHZhbiBhbGxlIGFuZGVyZSBiZXN0dWRlZXJkZSBzb29ydGVuOiBncmFzcGllcGVyIChUdWtleSB0ZXN0LCB2ZXJzY2hpbD1gciBjb25maW50KG1jcCkkY29uZmludFt3aW50ZXJJZFsxXSwxXSAlPiUgcm91bmQoMilgLCBhYW5nZXBhc3RlIHAtd2FhcmRlID0gYHIgc3VtbWFyeShtY3ApJHRlc3QkcHZhbHVlc1t3aW50ZXJJZFsxXV0gJT4lIHJvdW5kKDMpYCwgOTUlIEJJOiBbYHIgY29uZmludChtY3ApJGNvbmZpbnRbd2ludGVySWRbMV0sLTFdICU+JSByb3VuZCgyKWBdKSwgYm9vbXBpZXBlciAoVHVrZXkgdGVzdCwgdmVyc2NoaWw9YHIgY29uZmludChtY3ApJGNvbmZpbnRbd2ludGVySWRbMl0sMV0gJT4lIHJvdW5kKDIpYCwgYWFuZ2VwYXN0ZSBwLXdhYXJkZSA8IDAuMDAxLCA5NSUgQkk6IFtgciBjb25maW50KG1jcCkkY29uZmludFt3aW50ZXJJZFsyXSwtMV0gJT4lIHJvdW5kKDIpYF0pLCBoZWdnZW5tdXMgKFR1a2V5IHRlc3QsIHZlcnNjaGlsPWByIGNvbmZpbnQobWNwKSRjb25maW50W3dpbnRlcklkWzNdLDFdICU+JSByb3VuZCgyKWAsIGFhbmdlcGFzdGUgcC13YWFyZGUgPCAwLjAwMSwgOTUlIEJJOiBbYHIgY29uZmludChtY3ApJGNvbmZpbnRbd2ludGVySWRbM10sLTFdICU+JSByb3VuZCgyKWBdKSwgcm9vZGJvcnN0amUgKFR1a2V5IHRlc3QsICB2ZXJzY2hpbD1gciBjb25maW50KG1jcCkkY29uZmludFt3aW50ZXJJZFs0XSwxXSAlPiUgcm91bmQoMilgLCBhYW5nZXBhc3RlIHAtd2FhcmRlID0gYHIgc3VtbWFyeShtY3ApJHRlc3QkcHZhbHVlc1t3aW50ZXJJZFs0XV0gJT4lIHJvdW5kKDMpYCwgOTUlIEJJOiBbYHIgY29uZmludChtY3ApJGNvbmZpbnRbd2ludGVySWRbNF0sLTFdICU+JSByb3VuZCgyKWBdKSBlbiB3aXR0ZSBrd2lrc3RhYXJ0IChUdWtleSB0ZXN0LCAgdmVyc2NoaWw9YHIgY29uZmludChtY3ApJGNvbmZpbnRbd2ludGVySWRbNV0sMV0gJT4lIHJvdW5kKDIpYCwgYWFuZ2VwYXN0ZSBwLXdhYXJkZSA8IDAuMDAxLCA5NSUgQkk6IFtgciBjb25maW50KG1jcCkkY29uZmludFt3aW50ZXJJZFs1XSwtMV0gJT4lIHJvdW5kKDIpYF0pLgoKRGUgdmVyc2NoaWxsZW4gaW4gZ2VtaWRkZWxkZSBsZW5ndGUgdmFuIGRlIGtvZWtvZWtzZWllcmVuIHR1c3NlbiBkZSBvdmVyaWdlIHNvb3J0ZW4gemlqbiBuaWV0IHNpZ25pZmljYW50Lg==</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("anova_example.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
