<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement" />


<title>Experimenteel Design I: replicatie en power</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Biostatistiek 2021</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Hoorcolleges
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="introduction.html">Introductie</a>
    </li>
    <li>
      <a href="10-MultipleRegression.html">Algemeen Lineair Model</a>
    </li>
    <li>
      <a href="10-MultipleRegression-FactorialDesigns.html">Factoriële Designs</a>
    </li>
    <li>
      <a href="experimentalDesignI.html">Experimental Design I</a>
    </li>
    <li>
      <a href="experimentalDesignII.html">Experimental Design II</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ttest_example.html">Practicum 1: Voorbeeld two-sample t-test</a>
    </li>
    <li>
      <a href="anova_example.html">Practicum 1: Voorbeeld anova</a>
    </li>
    <li>
      <a href="Practicum_1_Voorbereiding_1.html">Practicum 1: Voorbereiding 1</a>
    </li>
    <li>
      <a href="Practicum_1_Voorbereiding_2.html">Practicum 1: Voorbereiding 2</a>
    </li>
    <li>
      <a href="Practicum_1_Voorbereiding_3.html">Practicum 1: Voorbereiding 3</a>
    </li>
    <li>
      <a href="Practicum_1_oefening_4.html">Practicum 1: Oefening lineair model</a>
    </li>
    <li>
      <a href="Practicum_1_oplossing_Two_sample_t_test.html">Practicum 1: Oplossing two-sample t-test</a>
    </li>
    <li>
      <a href="Practicum_1_oplossing_anova.html">Practicum 1: Oplossing Anova</a>
    </li>
    <li>
      <a href="Practicum_1_oplossing_niet_parametrische_test.html">Practicum 1: Oplossing niet-parametrische test</a>
    </li>
    <li>
      <a href="Practicum_1_oplossing_lineair_model.html">Practicum 1: Oplossing lineaire regressie</a>
    </li>
    <li>
      <a href="oefening_vissen_volledig_uitgewerkt.html">Practicum 3: Algemeen Lineair model: Oplossing oefening 2</a>
    </li>
    <li>
      <a href="Exp_design_fast_1_ex.html">Practicum 4: Experimenteel design: krachtanalyse oefening 1</a>
    </li>
    <li>
      <a href="Exp_design_fast_2_ex.html">Practicum 4: Experimenteel design: krachtanalyse oefening 2</a>
    </li>
    <li>
      <a href="Exp_design_fast_3_ex.html">Practicum 4: Experimenteel design: krachtanalyse oefening 3</a>
    </li>
    <li>
      <a href="Exp_design_fast_1_sol.html">Practicum 4: Experimenteel design: krachtanalyse oplossing oefening 1</a>
    </li>
    <li>
      <a href="Exp_design_fast_2_sol.html">Practicum 4: Experimenteel design: krachtanalyse oplossing oefening 2</a>
    </li>
    <li>
      <a href="Exp_design_fast_3_sol.html">Practicum 4: Experimenteel design: krachtanalyse oplossing oefening 3</a>
    </li>
    <li>
      <a href="Rats_01_ex.html">Practicum 5: Experimenteel design II: blocking oefening 1</a>
    </li>
    <li>
      <a href="fishtank.html">Practicum 5: Experimenteel design II: blocking oefening 2</a>
    </li>
    <li>
      <a href="Rats02_ex.html">Practicum 5: Experimenteel design II: blocking oefening 3</a>
    </li>
    <li>
      <a href="Rats_01.html">Practicum 5: Experimenteel design II: oplossing blocking oefening 1</a>
    </li>
    <li>
      <a href="fishtank_sol.html">Practicum 5: Experimenteel design II: oplossing blocking oefening 2</a>
    </li>
    <li>
      <a href="Rats_02.html">Practicum 5: Experimenteel design II: oplossing blocking oefening 3</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/biostatistics21">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Experimenteel Design I: replicatie en power</h1>
<h4 class="author">Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<p><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.3.5     ✔ purrr   0.3.4
## ✔ tibble  3.1.4     ✔ dplyr   1.0.7
## ✔ tidyr   1.1.3     ✔ stringr 1.4.0
## ✔ readr   1.4.0     ✔ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<p><img src="experimentalDesignI_files/figure-html/pop2Samp2Pop-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="concepten" class="section level1">
<h1><span class="header-section-number">1</span> Concepten</h1>
<ul>
<li>Experimentele eenheden zijn representatief voor populatie: Randomisatie</li>
<li>Replicatie: technisch vs biologisch, steekproefgrootte - power</li>
<li>Bronnen van variabiliteit: technisch, biologisch, binnen en tussen subjecten.</li>
</ul>
</div>
<div id="replicatie" class="section level1">
<h1><span class="header-section-number">2</span> Replicatie</h1>
<p>Paper over replicatie in Nature Methods (2 pagina’s) [<a href="https://www.nature.com/articles/nmeth.3091.pdf">PDF</a>] <embed src="https://www.nature.com/articles/nmeth.3091.pdf" style="width:100.0%" /></p>
<div id="voorbeeld" class="section level2">
<h2><span class="header-section-number">2.1</span> Voorbeeld</h2>
<p>In een RNA-seq experiment willen de onderzoekers het effect nagaan van een medicijn op de gen expressie.</p>
<p>Mogelijkse onderzoeksvraag</p>
<ul>
<li>Is er een verschil in gemiddelde gen expressie tussen behandelde en niet behandelde samples</li>
</ul>
</div>
<div id="bronnen-van-variabiliteit" class="section level2">
<h2><span class="header-section-number">2.2</span> Bronnen van variabiliteit</h2>
<p>TABLE 1 NATURE METHODS | VOL.11 NO.9 | SEPTEMBER 2014 | 879 - 880</p>
<table>
<colgroup>
<col width="35%" />
<col width="28%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="left">Replicate type</th>
<th align="center">Replicate category<span class="math inline">\(^\text{a}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"></td>
<td align="left">Colonies</td>
<td align="center">B</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left">Strains</td>
<td align="center">B</td>
</tr>
<tr class="odd">
<td align="center">Animal study subjects</td>
<td align="left">Cohoused groups</td>
<td align="center">B</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left">Gender</td>
<td align="center">B</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="left">Individuals</td>
<td align="center">B</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="left">Organs from sacrificed animals</td>
<td align="center">B</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left">Methods for dissociating cells from tissue</td>
<td align="center">T</td>
</tr>
<tr class="odd">
<td align="center">Sample preparation</td>
<td align="left">Dissociation runs from given tissue sample</td>
<td align="center">T</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left">Individual cells</td>
<td align="center">B</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="left"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left">RNA-seq library construction</td>
<td align="center">T</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="left">Runs from the library of a given cell</td>
<td align="center">T</td>
</tr>
<tr class="even">
<td align="center">Sequencing</td>
<td align="left">Reads from different transcript molecules</td>
<td align="center">V<span class="math inline">\(^\text{b}\)</span></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="left">Reads with unique molecular identifier (UMI) from a given transcript molecule</td>
<td align="center">T</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Replicates are categorized as biological (B), technical (T) or of variable type (V).</li>
<li>Sequence reads serve diverse purposes depending on the application and how reads are used in analysis.</li>
</ol>
<hr />
</div>
<div id="op-welk-niveau-moeten-we-repliceren" class="section level2">
<h2><span class="header-section-number">2.3</span> Op welk niveau moeten we repliceren?</h2>
<ul>
<li><span class="math inline">\(\text{var}(X)=\sigma^2_A+\sigma^2_C+\sigma^2_M=\sigma^2_{TOT}\)</span></li>
<li><span class="math inline">\(\text{var}(\bar{X})=\frac{\sigma^2_A}{n_A}+\frac{\sigma^2_C}{n_A n_C} + \frac{\sigma^2_M}{n_A n_C n_M}\)</span></li>
</ul>
<p><img src="https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fnmeth.3091/MediaObjects/41592_2014_Article_BFnmeth3091_Fig1_HTML.jpg" /> Figure 1 NATURE METHODS | VOL.11 NO.9 | SEPTEMBER 2014 | 879 - 880</p>
<ol style="list-style-type: lower-alpha">
<li>Three levels of replication (two biological, one technical) with animal, cell and measurement replicates normally distributed with a mean across animals of 10 and ratio of variances 1:2:0.5. Solid green (biological) and blue (technical) dots show how a measurement of the expression (X = 12) samples from all three sources of variation. Distribution s.d. is shown as horizontal lines.</li>
<li>Expression variance, Var(X), and variance of expression mean, Var(<span class="math inline">\(\bar X\)</span>), computed across 10,000 simulations of nAnCnM = 48 measurements for unique combinations of the number of animals (nA = 1 to 48), cells per animal (nC = 1 to 48) and technical replicate measurements per cell (nM = 1 and 3). The ratio of Var(X) and Var(<span class="math inline">\(\bar X\)</span>) is the effective sample size, n, which corresponds to the equivalent number of statistically independent measurements. Horizontal dashed lines correspond to biological and total variation. Error bars on Var(X) show s.d. from the 10,000 simulated samples (nM = 1).</li>
</ol>
<hr />
<p>Waar ligt interesse?</p>
<ul>
<li><p>Karakteriseren van bronnen van variabiliteit in experiment ==&gt; technische en biologische repeats zijn nodig</p></li>
<li><p>Voornamelijke interesse in schatten van effect van behandeling ==&gt; focus op biologische repeats</p></li>
<li><p>Extra biologische repeats lumpen alle bronnen van variabiliteit: biologische + technische variabiliteit.</p></li>
<li><p>Goed experimenteel design vereist na denken over replicatie</p>
<ol style="list-style-type: decimal">
<li>Identificeer onderzoeksvragen die men wenst te beantwoorden.</li>
<li>Breng bronnen van variabiliteit in kaart in elke stap van het experiment</li>
<li>Let op voor pseudoreplicatie, beoog zoveel mogelijk onafhankelijke repeats.</li>
</ol></li>
</ul>
<hr />
</div>
</div>
<div id="power-steekproefgrootte-en-andere-design-aspecten." class="section level1">
<h1><span class="header-section-number">3</span> Power, steekproefgrootte en andere design aspecten.</h1>
<p>Reading materials: <a href="https://www.nature.com/articles/nmeth.2738.pdf">Nature Methods (2013), 10(12), 1139–1140</a></p>
<div id="intermezzo-lineare-regression-in-matrix-vorm" class="section level2">
<h2><span class="header-section-number">3.1</span> Intermezzo lineare regression in matrix vorm</h2>
<ul>
<li>Lineaire regressie is een belangrijke methode in statistische data analyse.</li>
</ul>
<div id="scalaire-vorm" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Scalaire vorm</h3>
<ul>
<li>Stel dat men voor elke experimentele eenheid <span class="math inline">\(p\)</span> predictoren meet <span class="math inline">\(\mathbf{x}=(x_1,\ldots,x_p)\)</span> en</li>
<li>continue respons <span class="math inline">\(Y\)</span></li>
<li>het linear regressiemodel kan dan worden geschreven als: <span class="math display">\[
Y=f(\mathbf{x}) +\epsilon=\beta_0+\sum\limits_{j=1}^p x_j\beta_j + \epsilon
\]</span> met i.i.d. <span class="math inline">\(\epsilon\sim N(0,\sigma^2)\)</span></li>
</ul>
</div>
<div id="vectormatrix-vorm" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Vector/Matrix vorm</h3>
<ul>
<li><span class="math inline">\(n\)</span> observatie <span class="math inline">\((\mathbf{x}_1,y_1) \ldots (\mathbf{x}_n,y_n)\)</span> with <span class="math inline">\(\mathbf{x}_1^T=[1 x_1 \ldots x_p]\)</span></li>
<li>Regressie in matrix notatie <span class="math display">\[\mathbf{Y}=\mathbf{X\beta} + \mathbf{\epsilon}\]</span> met <span class="math inline">\(\mathbf{Y}=\left[\begin{array}{c}y_1\\ \vdots\\y_n\end{array}\right]\)</span>, <span class="math inline">\(\mathbf{X}=\left[\begin{array}{cccc} 1&amp;x_{11}&amp;\ldots&amp;x_{1p}\\ \vdots&amp;\vdots&amp;&amp;\vdots\\ 1&amp;x_{n1}&amp;\ldots&amp;x_{np} \end{array}\right]\)</span> or <span class="math inline">\(\mathbf{X}=\left[\begin{array}{c} \mathbf{x}_1^T\\\vdots\\\mathbf{x}_n^T\end{array}\right]\)</span>, <span class="math inline">\(\boldsymbol{\beta}=\left[\begin{array}{c}\beta_0\\ \vdots\\ \beta_p\end{array}\right]\)</span> and <span class="math inline">\(\mathbf{\epsilon}=\left[\begin{array}{c} \epsilon_1 \\ \vdots \\ \epsilon_n\end{array}\right]\)</span></li>
</ul>
<hr />
</div>
</div>
<div id="kleinste-kwadraten-techniekleast-squares-ls" class="section level2">
<h2><span class="header-section-number">3.2</span> kleinste kwadraten techniek/Least Squares (LS)</h2>
<ul>
<li><p>Minimimaliseer de residuele kwadratensom <span class="math display">\[\begin{eqnarray*}
RSS(\boldsymbol{\beta})&amp;=&amp;\sum\limits_{i=1}^n e^2_i\\
&amp;=&amp;\sum\limits_{i=1}^n \left(y_i-\beta_0-\sum\limits_{j=1}^p x_{ij}\beta_j\right)^2
\end{eqnarray*}\]</span></p></li>
<li><p>of in matrix notatie</p></li>
</ul>
<p><span class="math display">\[
\text{RSS}(\boldsymbol{\beta})=(\mathbf{Y}-\mathbf{X\beta})^T(\mathbf{Y}-\mathbf{X\beta})
\]</span></p>
<p><span class="math display">\[\rightarrow \hat{\boldsymbol{\beta}}=\text{argmin}_\beta \text{ RSS}(\boldsymbol{\beta})\]</span></p>
<hr />
<div id="minimimaliseer-rss" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Minimimaliseer RSS</h3>
<p><span class="math display">\[
\begin{array}{ccc}
\frac{\partial RSS}{\partial \boldsymbol{\beta}}&amp;=&amp;\mathbf{0}\\\\
\frac{(\mathbf{Y}-\mathbf{X\beta})^T(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta})}{\partial \boldsymbol{\beta}}&amp;=&amp;\mathbf{0}\\\\
-2\mathbf{X}^T(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta})&amp;=&amp;\mathbf{0}\\\\
\mathbf{X}^T\mathbf{X\beta}&amp;=&amp;\mathbf{X}^T\mathbf{Y}\\\\
\hat{\boldsymbol{\beta}}&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}
\end{array}
\]</span></p>
<hr />
</div>
</div>
<div id="variantie-schatter" class="section level2">
<h2><span class="header-section-number">3.3</span> Variantie schatter?</h2>
<p><span class="math display">\[
\begin{array}{ccl}
\hat{\boldsymbol{\Sigma}}_{\hat{\boldsymbol{\beta}}}
&amp;=&amp;\text{var}\left[(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}\right]\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\text{var}\left[\mathbf{Y}\right]\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T(\mathbf{I}\sigma^2)\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}
\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{I}\quad\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2\\\\
%\hat{\boldmath{\Sigma}}_{\hat{\boldsymbol{\beta}}}&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T \text{var}\left[\mathbf{Y}\right](\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2
\end{array}
\]</span></p>
<p>De onzekerheid op model parameters hangt dus af van de residuele variabiliteit en het de proefopzet!</p>
<ul>
<li><p>Hoe groter <span class="math inline">\(\mathbf{X}^T\mathbf{X}\)</span> hoe meer informatie het experiment zal hebben over de model parameters en hoe kleiner hun variantie en standaard errors!</p></li>
<li><p>Factoriële designs?</p></li>
<li><p>Designs with continue predictoren?</p></li>
</ul>
<hr />
<p>De effectgrootte van interesse is typisch een lineaire combinatie van de model parameters,<br />
<span class="math display">\[
l_0 \times \beta_0 + l_1 \times \beta_1 + ... + l_{p-1} \times \beta_{p-1} = \mathbf{L}^T\boldsymbol{\beta}
\]</span></p>
<p>De nulhypothese van onze test kan dan worden geschreven als</p>
<p><span class="math display">\[
H_0: \mathbf{L}^T\boldsymbol{\beta} = 0 
\]</span></p>
<p>vs de alternatieve hypothese</p>
<p><span class="math display">\[
H_0: \mathbf{L}^T\boldsymbol{\beta} \neq 0 
\]</span></p>
<p>En het bewijs in het experiment tegen <span class="math inline">\(H_0\)</span> kan worden gekwantificeerd met de t-test statistiek:</p>
<p><span class="math display">\[
t=\frac{\mathbf{L}^T\hat{\boldsymbol{\beta}} - 0}{\text{se}_{\mathbf{L}^T\hat{\boldsymbol{\beta}}}}
\]</span> die een t-distributie volgt met n-p vrijheidsgraden onder de nul hypothese als alle aannames van het model geldig zijn.</p>
<p>De kracht van de toets is dan</p>
<p><span class="math display">\[P(p &lt; 0.05 | H_1)\]</span> en hangt af van</p>
<ul>
<li>de werkelijke effectgrootte in de populatie <span class="math inline">\(\mathbf{L}^T\boldsymbol{\beta}\)</span>.</li>
<li>Het aantal observaties: SE en df van t-test.</li>
<li>Keuze van de designpunten</li>
<li>Keuze van significantie-niveau <span class="math inline">\(\alpha\)</span>.</li>
</ul>
<p>We kunnen dit evalueren aan de hand van simulaties.</p>
</div>
<div id="muis-voorbeeld" class="section level2">
<h2><span class="header-section-number">3.4</span> Muis voorbeeld</h2>
<ul>
<li><p>In 2021 publiceerden Choa et al. dat cytokine Thymic stromal lymphopoietin (TSLP) vetverlies induceert bij muizen die een vet dieet krijgen door de secretie van talg. [<a href="https://www.science.org/doi/full/10.1126/science.abd2893">html</a>] [<a href="https://www.science.org/doi/pdf/10.1126/science.abd2893">PDF</a>]</p></li>
<li><p>Stel dat je een gelijkaardig experiment op wil zetten om na te gaan of cytokine interleukin 25 (IL) ook een effect heeft op het gewicht van muizen.</p></li>
<li><p>Je plant een studie met een controle groep muizen die een hoog vet dieet krijgen (HFD) en een behandelingsgroep die een HFD dieet met IL krijgt.</p></li>
<li><p>Wat is de vereiste steekproefgrootte om een bepaald effect op te pikken van de behandeling?</p></li>
</ul>
<div id="hoe-zal-je-de-data-van-het-experiment-analyseren" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Hoe zal je de data van het experiment analyseren?</h3>
<hr />
<ul>
<li><p><span class="math inline">\(H_0\)</span>: Er is geen verschil in het gewicht van muizen die een dieet met IL krijgen en muizen die het controle dieet krijgen.</p></li>
<li><p><span class="math inline">\(H_1\)</span>: Het gewicht is gemiddelde verschillend tussen muizen die het IL dieet krijgen en muizen die het controle dieet krijgen.</p></li>
<li><p>Two sample t-test of een t-test op de helling van het lineaire model met 1 dummy variabele</p></li>
</ul>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_\text{iIL} + \epsilon_i\]</span></p>
<p><span class="math display">\[
\text{met }
X_\text{iIL}=\begin{cases}X_{iIL}=0 &amp; \text{HFD}\\X_{iIL}=1 &amp; \text{HFD + IL}\end{cases}.
\]</span></p>
<ul>
<li>Geschatte effectgrootte?</li>
</ul>
<p><span class="math display">\[\hat\delta = \bar X_{IL} - \bar X_{c} = \hat \beta_1\]</span></p>
<ul>
<li>Test statistiek <span class="math display">\[
T = \frac{\bar{X}_{IL}-\bar{X}_{c}}{SD_\text{pooled} \times \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}} = \frac{\hat\beta_1}{\text{SE}_{\hat\beta_1}}
\]</span></li>
<li><span class="math inline">\(\hat \beta_1\)</span> is een onvertekende schatter van het werkelijk gewichtsverschil (<span class="math inline">\(\delta =\mu_{IL}-\mu_{c} = \beta_1\)</span>) dat zou voorkomen in de populatie van muizen gevoed met HFD vs muizen gevoed met HFD + IL.</li>
</ul>
</div>
<div id="power" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Power?</h3>
<p><span class="math display">\[
P[p &lt; \alpha \vert \beta_1 \neq 0]
\]</span></p>
<p>De kracht (power) zal dus afhangen van</p>
<ul>
<li>Het werkelijke gemiddelde gewichtsverschil <span class="math inline">\(\beta_1\)</span> in de populatie.</li>
<li>De variabiliteit van de gewichtsmetingen</li>
<li>het significantie-niveau <span class="math inline">\(\alpha\)</span></li>
<li>steekproefgrootte <span class="math inline">\(n_{IL}\)</span> en <span class="math inline">\(n_c\)</span> in beide groepen</li>
</ul>
<p>We kunnen de power schatten als</p>
<ol style="list-style-type: decimal">
<li>voldaan is aan de aannamens van het model: gewicht in beide groepen is normaal verdeeld met gelijke variantie</li>
</ol>
<p>en als we de</p>
<ol start="2" style="list-style-type: decimal">
<li><p>standaard deviatie kennen van gewichtsmetingen rond hun groepsgemiddelde voor muizen die een HFD diet krijgen</p></li>
<li><p>de echte effectgrootte in de populatie</p></li>
<li><p><span class="math inline">\(n_1\)</span> en <span class="math inline">\(n_2\)</span></p></li>
</ol>
</div>
<div id="gebruik-data-uit-vorig-experiment-om-inzicht-te-krijgen-in-de-gewichtsdata-van-muizen" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Gebruik data uit vorig experiment om inzicht te krijgen in de gewichtsdata van muizen</h3>
<p>Stel dat we toegang hebben tot data van een vorig experiment (hier dat van Karen Svenson en Dan Gatti, gefinancierd door P50 GM070683 en beschikbaar op <a href="http://genomicsclass.github.io/book/pages/random_variables.html">PH525x</a>)</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>mice &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/femaleMiceWeights.csv&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>mice <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Diet,<span class="dt">y=</span>Bodyweight)) <span class="op">+</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape=</span><span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="st">  </span><span class="kw">geom_jitter</span>()</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>mice <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample=</span>Bodyweight)) <span class="op">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">geom_qq</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="st">  </span><span class="kw">geom_qq_line</span>() <span class="op">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Diet)</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>mice &lt;-<span class="st"> </span>mice <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Diet =</span> <span class="kw">as.factor</span>(Diet))</span>
<span id="cb7-2"><a href="#cb7-2"></a>miceSum &lt;-<span class="st"> </span>mice <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="st">  </span><span class="kw">group_by</span>(Diet)  <span class="op">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">  </span><span class="kw">summarize_at</span>(<span class="st">&quot;Bodyweight&quot;</span>,<span class="kw">list</span>(<span class="dt">mean=</span><span class="op">~</span><span class="kw">mean</span>(.,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),</span>
<span id="cb7-5"><a href="#cb7-5"></a>                    <span class="dt">sd=</span><span class="op">~</span><span class="kw">sd</span>(.,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),</span>
<span id="cb7-6"><a href="#cb7-6"></a>                    <span class="dt">n=</span><span class="cf">function</span>(x) x<span class="op">%&gt;%</span>is.na<span class="op">%&gt;%</span><span class="st">`</span><span class="dt">!</span><span class="st">`</span><span class="op">%&gt;%</span>sum)) <span class="op">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">se=</span>sd<span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb7-8"><a href="#cb7-8"></a>miceSum </span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Diet"],"name":[1],"type":["fct"],"align":["left"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[4],"type":["int"],"align":["right"]},{"label":["se"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"chow","2":"23.81333","3":"3.022541","4":"12","5":"0.8725323"},{"1":"hf","2":"26.83417","3":"4.097606","4":"12","5":"1.1828769"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>In het experiment werden twee diëten gebruikt:</p>
<ul>
<li>gewoon diet o.b.v. granen (Chow)</li>
<li>Heel vet dieet (high fat: hf)</li>
</ul>
<p>We kunnen de data van de hf muizen gebruiken als input voor onze power analyse.</p>
<ul>
<li>De data van hf muizen lijken normaal verdeeld te zijn.<br />
</li>
<li>Het gemiddelde gewicht van een hf muis is 26.8g</li>
<li>De standaard deviatie (SD) van het gewicht van hf muizen is 4.1g</li>
</ul>
<p>Effectgroote?</p>
<ul>
<li>De alternative hypothese is complex.</li>
<li>Omvat alle mogelijke effecten!</li>
<li>Om een power analyse te doen kiezen we daarom een minimale effectgrootte die we wensen op te pikken in het nieuwe experiment.</li>
<li>Veronderstel dat we een gewichtsverschil willen oppikken van minimaal 10%.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>delta &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">round</span>(miceSum<span class="op">$</span>mean[<span class="dv">2</span>] <span class="op">*</span>.<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>delta</span></code></pre></div>
<pre><code>## [1] -2.7</code></pre>
<p>Merk op dat het gemiddeld gewicht dan dicht komt bij dat van muizen in het pilootexperiment die werden gevoed met het normale dieet.</p>
<p>We kunnen nu een simulatie studie opzetten om de power te berekenen voor een experiment met 8 muizen in elke groep.</p>
<div id="eén-simulatie" class="section level4">
<h4><span class="header-section-number">3.4.3.1</span> Eén simulatie</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">set.seed</span>(<span class="dv">1423</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">8</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>b0 &lt;-<span class="st"> </span><span class="kw">round</span>(miceSum<span class="op">$</span>mean[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>b1 &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span>delta</span>
<span id="cb10-5"><a href="#cb10-5"></a>sd &lt;-<span class="st"> </span><span class="kw">round</span>(miceSum<span class="op">$</span>sd[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,<span class="kw">c</span>(n1,n2))</span>
<span id="cb10-9"><a href="#cb10-9"></a>y &lt;-<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n1<span class="op">+</span>n2,<span class="dv">0</span>, <span class="dt">sd =</span> sd)</span>
<span id="cb10-10"><a href="#cb10-10"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x)</span>
<span id="cb10-11"><a href="#cb10-11"></a>bhat &lt;-<span class="st"> </span>fit<span class="op">$</span>coef </span>
<span id="cb10-12"><a href="#cb10-12"></a>stat &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)</span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="kw">summary</span>(fit)<span class="op">$</span>coef[<span class="dv">2</span>,]</span></code></pre></div>
<pre><code>##   Estimate Std. Error    t value   Pr(&gt;|t|) 
##  2.5972480  1.7919658  1.4493848  0.1692595</code></pre>
<p>Voor het gesimuleerde experiment konden we het effect van de behandeling niet oppikken bij het <span class="math inline">\(\alpha\)</span>=0.05 (p = 0.17) significantie-niveau!</p>
<ul>
<li>We moeten het experiment herhalen om de power te schatten.</li>
<li>We zullen de simulatie daarom coderen in een functie die we kunnen hergebruiken.</li>
</ul>
</div>
<div id="simulatie-van-herhaalde-experimenten-repeated-experiments" class="section level4">
<h4><span class="header-section-number">3.4.3.2</span> Simulatie van herhaalde experimenten (repeated experiments)</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">library</span>(multcomp)</span></code></pre></div>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: TH.data</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<pre><code>## 
## Attaching package: &#39;TH.data&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     geyser</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">8</span></span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a>b0 &lt;-<span class="st"> </span><span class="kw">round</span>(miceSum<span class="op">$</span>mean[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a>b1 &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span>delta</span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a>sd &lt;-<span class="st"> </span><span class="kw">round</span>(miceSum<span class="op">$</span>sd[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb21-7"><a href="#cb21-7"></a>predictorData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Diet =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;hf&quot;</span>),<span class="kw">c</span>(n1,n2)) <span class="op">%&gt;%</span><span class="st"> </span>as.factor)</span>
<span id="cb21-8"><a href="#cb21-8"></a></span>
<span id="cb21-9"><a href="#cb21-9"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb21-10"><a href="#cb21-10"></a></span>
<span id="cb21-11"><a href="#cb21-11"></a>simLm &lt;-<span class="st"> </span><span class="cf">function</span>(form, data, betas, sd, contrasts, <span class="dt">simIndex =</span> <span class="ot">NA</span>)</span>
<span id="cb21-12"><a href="#cb21-12"></a>{</span>
<span id="cb21-13"><a href="#cb21-13"></a>  dataSim &lt;-<span class="st"> </span>data</span>
<span id="cb21-14"><a href="#cb21-14"></a>  X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(form,dataSim)</span>
<span id="cb21-15"><a href="#cb21-15"></a>  dataSim<span class="op">$</span>ySim &lt;-<span class="st"> </span>X<span class="op">%*%</span>betas <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">nrow</span>(dataSim),<span class="dv">0</span>,sd)</span>
<span id="cb21-16"><a href="#cb21-16"></a>  form &lt;-<span class="st"> </span><span class="kw">formula</span>(<span class="kw">paste</span>(<span class="st">&quot;ySim ~&quot;</span>,form[[<span class="dv">2</span>]]))</span>
<span id="cb21-17"><a href="#cb21-17"></a>  fitSim &lt;-<span class="st"> </span><span class="kw">lm</span>(form,dataSim)</span>
<span id="cb21-18"><a href="#cb21-18"></a>  mcp &lt;-<span class="st"> </span><span class="kw">glht</span>(fitSim,<span class="dt">linfct =</span> contrasts)</span>
<span id="cb21-19"><a href="#cb21-19"></a>  <span class="kw">return</span>(<span class="kw">summary</span>(mcp)<span class="op">$</span>test[<span class="kw">c</span>(<span class="st">&quot;coefficients&quot;</span>,<span class="st">&quot;sigma&quot;</span>,<span class="st">&quot;tstat&quot;</span>,<span class="st">&quot;pvalues&quot;</span>)]<span class="op">%&gt;%</span><span class="st"> </span>unlist)</span>
<span id="cb21-20"><a href="#cb21-20"></a>}</span>
<span id="cb21-21"><a href="#cb21-21"></a></span>
<span id="cb21-22"><a href="#cb21-22"></a><span class="kw">simLm</span>(</span>
<span id="cb21-23"><a href="#cb21-23"></a>  <span class="dt">form =</span> <span class="op">~</span>Diet,</span>
<span id="cb21-24"><a href="#cb21-24"></a>  <span class="dt">data =</span> predictorData,</span>
<span id="cb21-25"><a href="#cb21-25"></a>  <span class="dt">betas =</span> <span class="kw">c</span>(b0,b1),</span>
<span id="cb21-26"><a href="#cb21-26"></a>  <span class="dt">sd =</span> sd,</span>
<span id="cb21-27"><a href="#cb21-27"></a>  <span class="dt">contrasts =</span> <span class="st">&quot;Diethf = 0&quot;</span>)</span></code></pre></div>
<pre><code>## coefficients.Diethf        sigma.Diethf        tstat.Diethf             pvalues 
##           1.9444623           2.0931302           0.9289734           0.3686439</code></pre>
<p>We hebben nu een generiek functie waarmee we data kunnen simuleren die normaal verdeeld zijn voor elk mogelijk design die we met het lineair model kunnen analyseren.</p>
<p>De functie heeft volgende argumenten:</p>
<ul>
<li><code>form</code>: One sided formula including the structure of the predictors in the model</li>
<li><code>data</code>: Data frame with the predictor values for the design</li>
<li><code>betas</code>: A vector with values for all mean model parameters</li>
<li><code>sd</code>: The standard deviation of the error</li>
<li><code>contrasts</code>: a scalar or a vector with the null hypotheses that we would like to assess.</li>
<li><code>simIndex</code>: an arbitrary argument that is not used by the function but that will allow it to be used in an sapply loop that runs from 1 up to the number of simulations.</li>
</ul>
<p>Simuleer nSim = 1000 herhaalde experimenten:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">set.seed</span>(<span class="dv">1425</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a>nSim &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a>simResults  &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>nSim,simLm,<span class="dt">form =</span> <span class="op">~</span>Diet,<span class="dt">data =</span> predictorData,<span class="dt">betas =</span> <span class="kw">c</span>(b0,b1),<span class="dt">sd =</span> sd,<span class="dt">contrasts =</span> <span class="st">&quot;Diethf = 0&quot;</span>))</span>
<span id="cb23-5"><a href="#cb23-5"></a>power &lt;-<span class="st"> </span><span class="kw">mean</span>(simResults[,<span class="dv">4</span>] <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb23-6"><a href="#cb23-6"></a>power</span></code></pre></div>
<pre><code>## [1] 0.221</code></pre>
<p>We hebben een power van 22.1% om het behandelingseffect op te pikken met 8 biologische herhalingen in elke behandelingsgroep.</p>
<p>Merk op dat de power van een experiment ook het hoogste is als het aantal observaties gebalanceerd is, m.a.w. <span class="math inline">\(n_1=n_2\)</span>.</p>
</div>
<div id="power-voor-verschillende-steekproefgroottes" class="section level4">
<h4><span class="header-section-number">3.4.3.3</span> Power voor verschillende steekproefgroottes</h4>
<p>We kunnen de power nu berekenen voor meerdere steekproefgrootes.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">n=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>),<span class="dt">power=</span><span class="ot">NA</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(power))</span>
<span id="cb25-4"><a href="#cb25-4"></a>{</span>
<span id="cb25-5"><a href="#cb25-5"></a>  n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span>power<span class="op">$</span>n[i]</span>
<span id="cb25-6"><a href="#cb25-6"></a>  predictorData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Diet =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;hf&quot;</span>),<span class="kw">c</span>(n1,n2)) <span class="op">%&gt;%</span><span class="st"> </span>as.factor)</span>
<span id="cb25-7"><a href="#cb25-7"></a>  simResults  &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>nSim,simLm,<span class="dt">form =</span> <span class="op">~</span>Diet,<span class="dt">data =</span> predictorData,<span class="dt">betas =</span> <span class="kw">c</span>(b0,b1),<span class="dt">sd =</span> sd,<span class="dt">contrasts =</span> <span class="st">&quot;Diethf = 0&quot;</span>))</span>
<span id="cb25-8"><a href="#cb25-8"></a>  power<span class="op">$</span>power[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(simResults[,<span class="st">&quot;pvalues&quot;</span>] <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb25-9"><a href="#cb25-9"></a>}</span>
<span id="cb25-10"><a href="#cb25-10"></a>power</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["power"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"0.114"},{"1":"5","2":"0.158"},{"1":"10","2":"0.304"},{"1":"25","2":"0.648"},{"1":"50","2":"0.890"},{"1":"75","2":"0.982"},{"1":"100","2":"0.998"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>power <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>n,<span class="dt">y=</span>power)) <span class="op">+</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="bestudeer-power-in-functie-van-steekproefgrootte-en-effectgrootte" class="section level4">
<h4><span class="header-section-number">3.4.3.4</span> Bestudeer power in functie van steekproefgrootte en effectgrootte</h4>
<p>Merk op dat</p>
<ul>
<li>het teken van delta arbitrair is omdat we tweezijdig testen.</li>
<li>het intercept arbitrair is omdat we alleen testen op <span class="math inline">\(\beta_1\)</span></li>
<li>We nemen daarom typisch <span class="math inline">\(\beta_0 = 0\)</span></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>nSim &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>b0 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>deltas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb27-4"><a href="#cb27-4"></a>sd &lt;-<span class="st"> </span><span class="kw">round</span>(miceSum<span class="op">$</span>sd[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>ns &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>)  </span>
<span id="cb27-6"><a href="#cb27-6"></a></span>
<span id="cb27-7"><a href="#cb27-7"></a>power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">b1=</span><span class="kw">rep</span>(deltas,<span class="dt">each=</span><span class="kw">length</span>(ns)),</span>
<span id="cb27-8"><a href="#cb27-8"></a>                    <span class="dt">n=</span><span class="kw">rep</span>(ns,<span class="kw">length</span>(deltas)),</span>
<span id="cb27-9"><a href="#cb27-9"></a>                    <span class="dt">power=</span><span class="ot">NA</span>)</span>
<span id="cb27-10"><a href="#cb27-10"></a></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(power))</span>
<span id="cb27-12"><a href="#cb27-12"></a>{</span>
<span id="cb27-13"><a href="#cb27-13"></a>  b1 &lt;-power<span class="op">$</span>b1[i]</span>
<span id="cb27-14"><a href="#cb27-14"></a>  n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st">  </span>power<span class="op">$</span>n[i]</span>
<span id="cb27-15"><a href="#cb27-15"></a>  predictorData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Diet =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;hf&quot;</span>),<span class="kw">c</span>(n1,n2)) <span class="op">%&gt;%</span><span class="st"> </span>as.factor)</span>
<span id="cb27-16"><a href="#cb27-16"></a>  simResults  &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>nSim,simLm,<span class="dt">form =</span> <span class="op">~</span>Diet,<span class="dt">data =</span> predictorData,<span class="dt">betas =</span> <span class="kw">c</span>(b0,b1),<span class="dt">sd =</span> sd,<span class="dt">contrasts =</span> <span class="st">&quot;Diethf = 0&quot;</span>))</span>
<span id="cb27-17"><a href="#cb27-17"></a>  power<span class="op">$</span>power[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(simResults[,<span class="st">&quot;pvalues&quot;</span>] <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb27-18"><a href="#cb27-18"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>power <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>n,<span class="dt">y=</span>power,<span class="dt">col=</span>b1<span class="op">%&gt;%</span>as.factor)) <span class="op">+</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Merk op dat de power curves wat schokkerig zijn omdat we maar een beperkt aantal steekproefgroottes en een beperkt aantal simulaties uitvoerden. Voor de lage powers is het aantal simulaties zeker onvoldoende om heel betrouwbare schattingen van de power te bekomen.</p>
</div>
</div>
</div>
</div>
<div id="opmerkingen" class="section level1">
<h1><span class="header-section-number">4</span> Opmerkingen</h1>
<ul>
<li><p>De code kan eenvoudig aangepast worden naar andere designs (zie oefeningen)</p>
<ul>
<li>predictor data</li>
<li>formula</li>
<li>contrast</li>
</ul></li>
<li><p>De simulaties kunnen lang duren wanneer je veel scenario’s evalueert.</p>
<ul>
<li>Meer efficiënte code met matrices</li>
<li>Voor two group comparison bestaat een analytische oplossing.</li>
</ul></li>
</ul>
<div id="meer-efficiënte-code-met-matrices" class="section level2">
<h2><span class="header-section-number">4.1</span> Meer efficiënte code met matrices</h2>
<p>Code is veel sneller. We simulaleren nu 20 keer meer experimenten in een veel kortere tijd!</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>nSim &lt;-<span class="st"> </span><span class="dv">20000</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>b0 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>sd &lt;-<span class="st"> </span><span class="kw">round</span>(miceSum<span class="op">$</span>sd[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a>ns &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>)  </span>
<span id="cb29-5"><a href="#cb29-5"></a>deltas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb29-6"><a href="#cb29-6"></a></span>
<span id="cb29-7"><a href="#cb29-7"></a></span>
<span id="cb29-8"><a href="#cb29-8"></a>powerFast &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span><span class="kw">length</span>(ns)<span class="op">*</span><span class="kw">length</span>(deltas),<span class="dt">ncol=</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="kw">names</span>(powerFast) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;b1&quot;</span>,<span class="st">&quot;n&quot;</span>,<span class="st">&quot;power&quot;</span>)</span>
<span id="cb29-10"><a href="#cb29-10"></a></span>
<span id="cb29-11"><a href="#cb29-11"></a>i &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb29-12"><a href="#cb29-12"></a></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="cf">for</span> (n <span class="cf">in</span> ns)</span>
<span id="cb29-14"><a href="#cb29-14"></a>{</span>
<span id="cb29-15"><a href="#cb29-15"></a>  n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st">  </span>n</span>
<span id="cb29-16"><a href="#cb29-16"></a>  </span>
<span id="cb29-17"><a href="#cb29-17"></a>  <span class="co">### Simulation</span></span>
<span id="cb29-18"><a href="#cb29-18"></a>  predictorData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Diet =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;hf&quot;</span>),<span class="kw">c</span>(n1,n2)) <span class="op">%&gt;%</span><span class="st"> </span>as.factor)</span>
<span id="cb29-19"><a href="#cb29-19"></a>  design &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Diet,predictorData)</span>
<span id="cb29-20"><a href="#cb29-20"></a>  L &lt;-<span class="st"> </span>limma<span class="op">::</span><span class="kw">makeContrasts</span>(<span class="st">&quot;Diethf&quot;</span>,<span class="dt">levels =</span> <span class="kw">colnames</span>(design))</span>
<span id="cb29-21"><a href="#cb29-21"></a></span>
<span id="cb29-22"><a href="#cb29-22"></a>  </span>
<span id="cb29-23"><a href="#cb29-23"></a>  <span class="cf">for</span> (b1 <span class="cf">in</span> deltas)</span>
<span id="cb29-24"><a href="#cb29-24"></a>  {</span>
<span id="cb29-25"><a href="#cb29-25"></a>    ySim &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">nrow</span>(predictorData)<span class="op">*</span>nSim,<span class="dt">sd=</span>sd)</span>
<span id="cb29-26"><a href="#cb29-26"></a>    <span class="kw">dim</span>(ySim) &lt;-<span class="kw">c</span>(<span class="kw">nrow</span>(predictorData),nSim)</span>
<span id="cb29-27"><a href="#cb29-27"></a>    ySim &lt;-<span class="st"> </span>ySim <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(design <span class="op">%*%</span><span class="kw">c</span>(b0,b1))</span>
<span id="cb29-28"><a href="#cb29-28"></a>    ySim &lt;-<span class="st"> </span><span class="kw">t</span>(ySim)</span>
<span id="cb29-29"><a href="#cb29-29"></a>  </span>
<span id="cb29-30"><a href="#cb29-30"></a>    <span class="co">### Fitting</span></span>
<span id="cb29-31"><a href="#cb29-31"></a>    fitAll &lt;-<span class="st"> </span>limma<span class="op">::</span><span class="kw">lmFit</span>(ySim,design)</span>
<span id="cb29-32"><a href="#cb29-32"></a>  </span>
<span id="cb29-33"><a href="#cb29-33"></a>    <span class="co">### Inference</span></span>
<span id="cb29-34"><a href="#cb29-34"></a>    varUnscaled &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">t</span>(L)<span class="op">%*%</span>fitAll<span class="op">$</span>cov.coefficients<span class="op">%*%</span>L)</span>
<span id="cb29-35"><a href="#cb29-35"></a>    contrasts &lt;-<span class="st"> </span>fitAll<span class="op">$</span>coefficients <span class="op">%*%</span>L</span>
<span id="cb29-36"><a href="#cb29-36"></a>    seContrasts &lt;-<span class="st"> </span>varUnscaled<span class="op">^</span>.<span class="dv">5</span><span class="op">*</span>fitAll<span class="op">$</span>sigma</span>
<span id="cb29-37"><a href="#cb29-37"></a>    tstats &lt;-<span class="st"> </span>contrasts<span class="op">/</span>seContrasts</span>
<span id="cb29-38"><a href="#cb29-38"></a>    pvals &lt;-<span class="st"> </span><span class="kw">pt</span>(<span class="kw">abs</span>(tstats),fitAll<span class="op">$</span>df.residual,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb29-39"><a href="#cb29-39"></a>    </span>
<span id="cb29-40"><a href="#cb29-40"></a>    i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb29-41"><a href="#cb29-41"></a>    powerFast[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(b1,n,<span class="kw">mean</span>(pvals <span class="op">&lt;</span><span class="st"> </span>alpha))</span>
<span id="cb29-42"><a href="#cb29-42"></a>  }</span>
<span id="cb29-43"><a href="#cb29-43"></a>}</span></code></pre></div>
<pre><code>## Warning in limma::makeContrasts(&quot;Diethf&quot;, levels = colnames(design)): Renaming
## (Intercept) to Intercept

## Warning in limma::makeContrasts(&quot;Diethf&quot;, levels = colnames(design)): Renaming
## (Intercept) to Intercept

## Warning in limma::makeContrasts(&quot;Diethf&quot;, levels = colnames(design)): Renaming
## (Intercept) to Intercept

## Warning in limma::makeContrasts(&quot;Diethf&quot;, levels = colnames(design)): Renaming
## (Intercept) to Intercept

## Warning in limma::makeContrasts(&quot;Diethf&quot;, levels = colnames(design)): Renaming
## (Intercept) to Intercept

## Warning in limma::makeContrasts(&quot;Diethf&quot;, levels = colnames(design)): Renaming
## (Intercept) to Intercept

## Warning in limma::makeContrasts(&quot;Diethf&quot;, levels = colnames(design)): Renaming
## (Intercept) to Intercept

## Warning in limma::makeContrasts(&quot;Diethf&quot;, levels = colnames(design)): Renaming
## (Intercept) to Intercept</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>powerFast <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>n,<span class="dt">y=</span>power,<span class="dt">col=</span>b1<span class="op">%&gt;%</span>as.factor)) <span class="op">+</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="meer-efficiënte-code-gebaseerd-op-de-analytische-oplossing-voor-een-two-group-comparison" class="section level2">
<h2><span class="header-section-number">4.2</span> Meer efficiënte code gebaseerd op de analytische oplossing voor een two group comparison</h2>
<ul>
<li><p>Voor de two sample t-test bestaat er een analytische oplossing om de power te berekenen.</p></li>
<li><p>In deze context maakt men typisch gebruik van de “Cohen’s effect size”:</p></li>
</ul>
<p><span class="math inline">\(D = \frac{\delta}{SD}\)</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">power.t.test</span>(<span class="dt">n=</span><span class="dv">8</span>, <span class="dt">delta =</span> delta, <span class="dt">sd =</span> sd, <span class="dt">type=</span><span class="st">&#39;two.sample&#39;</span>)</span></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 8
##           delta = 2.7
##              sd = 4.1
##       sig.level = 0.05
##           power = 0.2320512
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
<p>Merk op dat de power overeenkomt met degene die we via simulaties hebben geschat!</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>b0 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>sd &lt;-<span class="st"> </span><span class="kw">round</span>(miceSum<span class="op">$</span>sd[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a>ns &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>)  </span>
<span id="cb34-4"><a href="#cb34-4"></a>deltas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a></span>
<span id="cb34-7"><a href="#cb34-7"></a>powerTheo &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">deltas=</span><span class="kw">rep</span>(deltas,<span class="dt">each=</span><span class="kw">length</span>(ns)),</span>
<span id="cb34-8"><a href="#cb34-8"></a>                    <span class="dt">n=</span><span class="kw">rep</span>(ns,<span class="kw">length</span>(deltas)),</span>
<span id="cb34-9"><a href="#cb34-9"></a>                    <span class="dt">power=</span><span class="ot">NA</span>)</span>
<span id="cb34-10"><a href="#cb34-10"></a></span>
<span id="cb34-11"><a href="#cb34-11"></a>powerTheo<span class="op">$</span>power &lt;-<span class="st"> </span><span class="kw">apply</span>(powerTheo[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="kw">power.t.test</span>(<span class="dt">delta=</span>x[<span class="dv">1</span>],<span class="dt">n=</span>x[<span class="dv">2</span>],<span class="dt">sd=</span>sd,<span class="dt">type=</span><span class="st">&quot;two.sample&quot;</span>)<span class="op">$</span>power)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>powerTheo <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>n,<span class="dt">y=</span>power,<span class="dt">col=</span>deltas<span class="op">%&gt;%</span>as.factor)) <span class="op">+</span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRXhwZXJpbWVudGVlbCBEZXNpZ24gSTogcmVwbGljYXRpZSBlbiBwb3dlciIKYXV0aG9yOiAiTGlldmVuIENsZW1lbnQiCmRhdGU6ICJzdGF0T21pY3MsIEdoZW50IFVuaXZlcnNpdHkgKGh0dHBzOi8vc3RhdG9taWNzLmdpdGh1Yi5pbykiCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgY29kZV9kb3dubG9hZDogeWVzCiAgICB0aGVtZTogY29zbW8KICAgIHRvYzogeWVzCiAgICB0b2NfZmxvYXQ6IHllcwogICAgaGlnaGxpZ2h0OiB0YW5nbwogICAgbnVtYmVyX3NlY3Rpb25zOiB5ZXMKLS0tCgoKPGEgcmVsPSJsaWNlbnNlIiBocmVmPSJodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktbmMtc2EvNC4wIj48aW1nIGFsdD0iQ3JlYXRpdmUgQ29tbW9ucyBMaWNlbnNlIiBzdHlsZT0iYm9yZGVyLXdpZHRoOjAiIHNyYz0iaHR0cHM6Ly9pLmNyZWF0aXZlY29tbW9ucy5vcmcvbC9ieS1uYy1zYS80LjAvODh4MzEucG5nIiAvPjwvYT4KCmBgYHtyfQpsaWJyYXJ5KHRpZHl2ZXJzZSkKYGBgCgoKYGBge3IgcG9wMlNhbXAyUG9wLGZpZy5hc3A9LjgsIGZpZy5hbGlnbj0nY2VudGVyJyxlY2hvPUZBTFNFfQppZiAoInBpIiVpbiVscygpKSBybSgicGkiKQprb3B2b2V0ZXI8LWZ1bmN0aW9uKHgseSxhbmdsZT0wLGw9LjIsY2V4LmRvdD0uNSxwY2g9MTksY29sPSJibGFjayIpCnsKYW5nbGU9YW5nbGUvMTgwKnBpCnBvaW50cyh4LHksY2V4PWNleC5kb3QscGNoPXBjaCxjb2w9Y29sKQpsaW5lcyhjKHgseCtsKmNvcygtcGkvMithbmdsZSkpLGMoeSx5K2wqc2luKC1waS8yK2FuZ2xlKSksY29sPWNvbCkKbGluZXMoYyh4K2wvMipjb3MoLXBpLzIrYW5nbGUpLHgrbC8yKmNvcygtcGkvMithbmdsZSkrbC80KmNvcyhhbmdsZSkpLGMoeStsLzIqc2luKC1waS8yK2FuZ2xlKSx5K2wvMipzaW4oLXBpLzIrYW5nbGUpK2wvNCpzaW4oYW5nbGUpKSxjb2w9Y29sKQpsaW5lcyhjKHgrbC8yKmNvcygtcGkvMithbmdsZSkseCtsLzIqY29zKC1waS8yK2FuZ2xlKStsLzQqY29zKHBpK2FuZ2xlKSksYyh5K2wvMipzaW4oLXBpLzIrYW5nbGUpLHkrbC8yKnNpbigtcGkvMithbmdsZSkrbC80KnNpbihwaSthbmdsZSkpLGNvbD1jb2wpCmxpbmVzKGMoeCtsKmNvcygtcGkvMithbmdsZSkseCtsKmNvcygtcGkvMithbmdsZSkrbC8yKmNvcygtcGkvMitwaS80K2FuZ2xlKSksYyh5K2wqc2luKC1waS8yK2FuZ2xlKSx5K2wqc2luKC1waS8yK2FuZ2xlKStsLzIqc2luKC1waS8yK3BpLzQrYW5nbGUpKSxjb2w9Y29sKQpsaW5lcyhjKHgrbCpjb3MoLXBpLzIrYW5nbGUpLHgrbCpjb3MoLXBpLzIrYW5nbGUpK2wvMipjb3MoLXBpLzItcGkvNCthbmdsZSkpLGMoeStsKnNpbigtcGkvMithbmdsZSkseStsKnNpbigtcGkvMithbmdsZSkrbC8yKnNpbigtcGkvMi1waS80K2FuZ2xlKSksY29sPWNvbCkKfQoKcGFyKG1hcj1jKDAsMCwwLDApLG1haT1jKDAsMCwwLDApKQpwbG90KDAsMCx4bGFiPSIiLHlsYWI9IiIseGxpbT1jKDAsMTApLHlsaW09YygwLDEwKSxjb2w9MCx4YXh0PSJub25lIix5YXh0PSJub25lIixheGVzPUZBTFNFKQpyZWN0KDAsNiwxMCwxMCxib3JkZXI9InJlZCIsbHdkPTIpCnRleHQoLjUsOCwicG9wdWxhdGllIixzcnQ9OTAsY29sPSJyZWQiLGNleD0yKQpzeW1ib2xzICgzLCA4LCBjaXJjbGVzPTEuNSwgY29sPSJyZWQiLGFkZD1UUlVFLGZnPSJyZWQiLGluY2hlcz1GQUxTRSxsd2Q9MikKZ3JpZD1zZXEoMCwxLjMsLjAxKQoKZm9yIChpIGluIDE6NTApCnsKCWFuZ2xlMT1ydW5pZihuPTEsbWluPTAsbWF4PTM2MCkKCWFuZ2xlMj1ydW5pZihuPTEsbWluPTAsbWF4PTM2MCkKCXJhZGl1cz1zYW1wbGUoZ3JpZCxwcm9iPWdyaWReMipwaS9zdW0oZ3JpZF4yKnBpKSxzaXplPTEpCglrb3B2b2V0ZXIoMytyYWRpdXMqY29zKGFuZ2xlMS8xODAqcGkpLDgrcmFkaXVzKnNpbihhbmdsZTEvMTgwKnBpKSxhbmdsZT1hbmdsZTIpCn0KdGV4dCg3LjUsOCwiRWZmZWN0IHZhbiByb2tlbiBpbiBwb3B1bGF0aWUiLGNvbD0icmVkIixjZXg9MS4yKQoKcmVjdCgwLDAsMTAsNCxib3JkZXI9ImJsdWUiLGx3ZD0yKQp0ZXh0KC41LDIsInNhbXBsZSIsc3J0PTkwLGNvbD0iYmx1ZSIsY2V4PTIpCnN5bWJvbHMgKDMsIDIsIGNpcmNsZXM9MS41LCBjb2w9InJlZCIsYWRkPVRSVUUsZmc9ImJsdWUiLGluY2hlcz1GQUxTRSxsd2Q9MikKZm9yIChpIGluIDA6MikKCWZvciAoaiBpbiAwOjQpCnsKCglrb3B2b2V0ZXIoMi4xK2oqKDMuOS0yLjEpLzQsMS4xK2kpCn0KdGV4dCg3LjUsMiwiRWZmZWN0IHZhbiByb2tlbiBpbiBzdGVla3Byb2VmIixjb2w9ImJsdWUiLGNleD0xLjIpCgphcnJvd3MoMyw1LjksMyw0LjEsY29sPSJibGFjayIsbHdkPTMpCmFycm93cyg3LDQuMSw3LDUuOSxjb2w9ImJsYWNrIixsd2Q9MykKdGV4dCgxLjUsNSwiRVhQLiBERVNJR04gKDEpIixjb2w9ImJsYWNrIixjZXg9MS4yKQp0ZXh0KDguNSw1LCJTQ0hBVFRFTiAmXG5JTkZFUkVOVElFICgzKSIsY29sPSJibGFjayIsY2V4PTEuMikKdGV4dCg3LjUsLjUsIkRBVEEgRVhQTE9SQVRJRSAmXG5CRVNDSFJJSlZFTkRFIFNUQVRJU1RJRUsgKDIpIixjb2w9ImJsYWNrIixjZXg9MS4yKQpgYGAKCgojIENvbmNlcHRlbgoKLSBFeHBlcmltZW50ZWxlIGVlbmhlZGVuIHppam4gcmVwcmVzZW50YXRpZWYgdm9vciBwb3B1bGF0aWU6IFJhbmRvbWlzYXRpZQotIFJlcGxpY2F0aWU6IHRlY2huaXNjaCB2cyBiaW9sb2dpc2NoLCBzdGVla3Byb2VmZ3Jvb3R0ZSAtIHBvd2VyCi0gQnJvbm5lbiB2YW4gdmFyaWFiaWxpdGVpdDogdGVjaG5pc2NoLCBiaW9sb2dpc2NoLCBiaW5uZW4gZW4gdHVzc2VuIHN1YmplY3Rlbi4gCgojIFJlcGxpY2F0aWUgCgpQYXBlciBvdmVyIHJlcGxpY2F0aWUgaW4gTmF0dXJlIE1ldGhvZHMgKDIgcGFnaW5hJ3MpIFtbUERGXShodHRwczovL3d3dy5uYXR1cmUuY29tL2FydGljbGVzL25tZXRoLjMwOTEucGRmKV0KIVtdKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20vYXJ0aWNsZXMvbm1ldGguMzA5MS5wZGYpeyB3aWR0aD0xMDAlIH0KCiMjIFZvb3JiZWVsZAoKSW4gZWVuIFJOQS1zZXEgZXhwZXJpbWVudCB3aWxsZW4gZGUgb25kZXJ6b2VrZXJzIGhldCBlZmZlY3QgbmFnYWFuIHZhbiBlZW4gbWVkaWNpam4gb3AgZGUgZ2VuIGV4cHJlc3NpZS4gCgpNb2dlbGlqa3NlIG9uZGVyem9la3N2cmFhZwoKLSBJcyBlciBlZW4gdmVyc2NoaWwgaW4gZ2VtaWRkZWxkZSBnZW4gZXhwcmVzc2llIHR1c3NlbiBiZWhhbmRlbGRlIGVuIG5pZXQgYmVoYW5kZWxkZSBzYW1wbGVzCgojIyBCcm9ubmVuIHZhbiB2YXJpYWJpbGl0ZWl0CgpUQUJMRSAxIE5BVFVSRSBNRVRIT0RTIHwgVk9MLjExIE5PLjkgfCBTRVBURU1CRVIgMjAxNCB8IDg3OSAtIDg4MAoKfCAgIHwgUmVwbGljYXRlIHR5cGUgfCBSZXBsaWNhdGUgY2F0ZWdvcnkkXlx0ZXh0e2F9JCB8Cnw6LS0tOnw6LS0tfDotLS06fAp8IHwgQ29sb25pZXMgfAlCIHwKfCB8IFN0cmFpbnMgfAlCIHwKfCBBbmltYWwgc3R1ZHkgc3ViamVjdHMgfCBDb2hvdXNlZCBncm91cHMgfAlCIHwKfCB8IEdlbmRlciB8IEIgfAp8IHwgSW5kaXZpZHVhbHMJfCBCIHwgCnwgfCB8IHwKfCB8IE9yZ2FucyBmcm9tIHNhY3JpZmljZWQgYW5pbWFscyB8IEIgfAp8IHwgTWV0aG9kcyBmb3IgZGlzc29jaWF0aW5nIGNlbGxzIGZyb20gdGlzc3VlIHwgVCB8CnwgU2FtcGxlIHByZXBhcmF0aW9uIHwgRGlzc29jaWF0aW9uIHJ1bnMgZnJvbSBnaXZlbiB0aXNzdWUgc2FtcGxlIHwgVCB8CnwgfCBJbmRpdmlkdWFsIGNlbGxzIHwgQiB8CnwgfCB8IHwKfCB8IFJOQS1zZXEgbGlicmFyeSBjb25zdHJ1Y3Rpb24gfCBUIHwKfCB8IFJ1bnMgZnJvbSB0aGUgbGlicmFyeSBvZiBhIGdpdmVuIGNlbGwgfAlUIHwKfCBTZXF1ZW5jaW5nIHwgUmVhZHMgZnJvbSBkaWZmZXJlbnQgdHJhbnNjcmlwdCBtb2xlY3VsZXMgfCBWJF5cdGV4dHtifSQgfAp8IHwgUmVhZHMgd2l0aCB1bmlxdWUgbW9sZWN1bGFyIGlkZW50aWZpZXIgKFVNSSkgZnJvbSBhIGdpdmVuIHRyYW5zY3JpcHQgbW9sZWN1bGUgfAlUIHwKCihhKSBSZXBsaWNhdGVzIGFyZSBjYXRlZ29yaXplZCBhcyBiaW9sb2dpY2FsIChCKSwgdGVjaG5pY2FsIChUKSBvciBvZiB2YXJpYWJsZSB0eXBlIChWKS4gCihiKSBTZXF1ZW5jZSByZWFkcyBzZXJ2ZSBkaXZlcnNlIHB1cnBvc2VzIGRlcGVuZGluZyBvbiB0aGUgYXBwbGljYXRpb24gYW5kIGhvdyByZWFkcyBhcmUgdXNlZCBpbiBhbmFseXNpcy4KCi0tLQoKIyMgT3Agd2VsayBuaXZlYXUgbW9ldGVuIHdlIHJlcGxpY2VyZW4/CgotICRcdGV4dHt2YXJ9KFgpPVxzaWdtYV4yX0ErXHNpZ21hXjJfQytcc2lnbWFeMl9NPVxzaWdtYV4yX3tUT1R9JAotICRcdGV4dHt2YXJ9KFxiYXJ7WH0pPVxmcmFje1xzaWdtYV4yX0F9e25fQX0rXGZyYWN7XHNpZ21hXjJfQ317bl9BIG5fQ30gKyBcZnJhY3tcc2lnbWFeMl9NfXtuX0Egbl9DIG5fTX0kCgohW10oaHR0cHM6Ly9tZWRpYS5zcHJpbmdlcm5hdHVyZS5jb20vZnVsbC9zcHJpbmdlci1zdGF0aWMvaW1hZ2UvYXJ0JTNBMTAuMTAzOCUyRm5tZXRoLjMwOTEvTWVkaWFPYmplY3RzLzQxNTkyXzIwMTRfQXJ0aWNsZV9CRm5tZXRoMzA5MV9GaWcxX0hUTUwuanBnKQpGaWd1cmUgMSBOQVRVUkUgTUVUSE9EUyB8IFZPTC4xMSBOTy45IHwgU0VQVEVNQkVSIDIwMTQgfCA4NzkgLSA4ODAKCihhKSBUaHJlZSBsZXZlbHMgb2YgcmVwbGljYXRpb24gKHR3byBiaW9sb2dpY2FsLCBvbmUgdGVjaG5pY2FsKSB3aXRoIGFuaW1hbCwgY2VsbCBhbmQgbWVhc3VyZW1lbnQgcmVwbGljYXRlcyBub3JtYWxseSBkaXN0cmlidXRlZCB3aXRoIGEgbWVhbiBhY3Jvc3MgYW5pbWFscyBvZiAxMCBhbmQgcmF0aW8gb2YgdmFyaWFuY2VzIDE6MjowLjUuIFNvbGlkIGdyZWVuIChiaW9sb2dpY2FsKSBhbmQgYmx1ZSAodGVjaG5pY2FsKSBkb3RzIHNob3cgaG93IGEgbWVhc3VyZW1lbnQgb2YgdGhlIGV4cHJlc3Npb24gKFggPSAxMikgc2FtcGxlcyBmcm9tIGFsbCB0aHJlZSBzb3VyY2VzIG9mIHZhcmlhdGlvbi4gRGlzdHJpYnV0aW9uIHMuZC4gaXMgc2hvd24gYXMgaG9yaXpvbnRhbCBsaW5lcy4gCihiKSBFeHByZXNzaW9uIHZhcmlhbmNlLCBWYXIoWCksIGFuZCB2YXJpYW5jZSBvZiBleHByZXNzaW9uIG1lYW4sIFZhcigkXGJhciBYJCksIGNvbXB1dGVkIGFjcm9zcyAxMCwwMDAgc2ltdWxhdGlvbnMgb2YgbkFuQ25NID0gNDggbWVhc3VyZW1lbnRzIGZvciB1bmlxdWUgY29tYmluYXRpb25zIG9mIHRoZSBudW1iZXIgb2YgYW5pbWFscyAobkEgPSAxIHRvIDQ4KSwgY2VsbHMgcGVyIGFuaW1hbCAobkMgPSAxIHRvIDQ4KSBhbmQgdGVjaG5pY2FsIHJlcGxpY2F0ZSBtZWFzdXJlbWVudHMgcGVyIGNlbGwgKG5NID0gMSBhbmQgMykuIFRoZSByYXRpbyBvZiBWYXIoWCkgYW5kIFZhcigkXGJhciBYJCkgaXMgdGhlIGVmZmVjdGl2ZSBzYW1wbGUgc2l6ZSwgbiwgd2hpY2ggY29ycmVzcG9uZHMgdG8gdGhlIGVxdWl2YWxlbnQgbnVtYmVyIG9mIHN0YXRpc3RpY2FsbHkgaW5kZXBlbmRlbnQgbWVhc3VyZW1lbnRzLiBIb3Jpem9udGFsIGRhc2hlZCBsaW5lcyBjb3JyZXNwb25kIHRvIGJpb2xvZ2ljYWwgYW5kIHRvdGFsIHZhcmlhdGlvbi4gRXJyb3IgYmFycyBvbiBWYXIoWCkgc2hvdyBzLmQuIGZyb20gdGhlIDEwLDAwMCBzaW11bGF0ZWQgc2FtcGxlcyAobk0gPSAxKS4KCi0tLQoKV2FhciBsaWd0IGludGVyZXNzZT8gCgotIEthcmFrdGVyaXNlcmVuIHZhbiBicm9ubmVuIHZhbiB2YXJpYWJpbGl0ZWl0IGluIGV4cGVyaW1lbnQgPT0+IHRlY2huaXNjaGUgZW4gYmlvbG9naXNjaGUgcmVwZWF0cyB6aWpuIG5vZGlnCi0gVm9vcm5hbWVsaWprZSBpbnRlcmVzc2UgaW4gc2NoYXR0ZW4gdmFuIGVmZmVjdCB2YW4gYmVoYW5kZWxpbmcgPT0+IGZvY3VzIG9wIGJpb2xvZ2lzY2hlIHJlcGVhdHMKLSBFeHRyYSBiaW9sb2dpc2NoZSByZXBlYXRzIGx1bXBlbiBhbGxlIGJyb25uZW4gdmFuIHZhcmlhYmlsaXRlaXQ6IGJpb2xvZ2lzY2hlICsgdGVjaG5pc2NoZSB2YXJpYWJpbGl0ZWl0LiAKCi0gR29lZCBleHBlcmltZW50ZWVsIGRlc2lnbiB2ZXJlaXN0IG5hIGRlbmtlbiBvdmVyIHJlcGxpY2F0aWUgCgogIDEuIElkZW50aWZpY2VlciBvbmRlcnpvZWtzdnJhZ2VuIGRpZSBtZW4gd2Vuc3QgdGUgYmVhbnR3b29yZGVuLiAKICAyLiBCcmVuZyBicm9ubmVuIHZhbiB2YXJpYWJpbGl0ZWl0IGluIGthYXJ0IGluIGVsa2Ugc3RhcCB2YW4gaGV0IGV4cGVyaW1lbnQKICAzLiBMZXQgb3Agdm9vciBwc2V1ZG9yZXBsaWNhdGllLCBiZW9vZyB6b3ZlZWwgbW9nZWxpamsgb25hZmhhbmtlbGlqa2UgcmVwZWF0cy4gCgotLS0gCgojIFBvd2VyLCBzdGVla3Byb2VmZ3Jvb3R0ZSBlbiBhbmRlcmUgZGVzaWduIGFzcGVjdGVuLiAKClJlYWRpbmcgbWF0ZXJpYWxzOiAKW05hdHVyZSBNZXRob2RzICgyMDEzKSwgMTAoMTIpLCAxMTM54oCTMTE0MF0oaHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9ubWV0aC4yNzM4LnBkZikKCiMjIEludGVybWV6em8gbGluZWFyZSByZWdyZXNzaW9uIGluIG1hdHJpeCB2b3JtIAoKLSBMaW5lYWlyZSByZWdyZXNzaWUgaXMgZWVuIGJlbGFuZ3JpamtlIG1ldGhvZGUgaW4gc3RhdGlzdGlzY2hlIGRhdGEgYW5hbHlzZS4KCiMjIyBTY2FsYWlyZSB2b3JtCgotIFN0ZWwgZGF0IG1lbiB2b29yIGVsa2UgZXhwZXJpbWVudGVsZSBlZW5oZWlkICRwJCBwcmVkaWN0b3JlbiBtZWV0ICRcbWF0aGJme3h9PSh4XzEsXGxkb3RzLHhfcCkkIGVuCi0gY29udGludWUgcmVzcG9ucyAkWSQKLSBoZXQgbGluZWFyIHJlZ3Jlc3NpZW1vZGVsIGthbiBkYW4gd29yZGVuIGdlc2NocmV2ZW4gYWxzOiAKXFsKWT1mKFxtYXRoYmZ7eH0pICtcZXBzaWxvbj1cYmV0YV8wK1xzdW1cbGltaXRzX3tqPTF9XnAgeF9qXGJldGFfaiArIFxlcHNpbG9uClxdCm1ldCBpLmkuZC4gJFxlcHNpbG9uXHNpbSBOKDAsXHNpZ21hXjIpJAoKCgojIyMgVmVjdG9yL01hdHJpeCB2b3JtCgotICRuJCBvYnNlcnZhdGllICQoXG1hdGhiZnt4fV8xLHlfMSkgXGxkb3RzIChcbWF0aGJme3h9X24seV9uKSQgd2l0aCAkXG1hdGhiZnt4fV8xXlQ9WzEgeF8xIFxsZG90cyB4X3BdJAotIFJlZ3Jlc3NpZSBpbiBtYXRyaXggbm90YXRpZQpcW1xtYXRoYmZ7WX09XG1hdGhiZntYXGJldGF9ICsgXG1hdGhiZntcZXBzaWxvbn1cXQptZXQgJFxtYXRoYmZ7WX09XGxlZnRbXGJlZ2lue2FycmF5fXtjfXlfMVxcIFx2ZG90c1xceV9uXGVuZHthcnJheX1ccmlnaHRdJCwKJFxtYXRoYmZ7WH09XGxlZnRbXGJlZ2lue2FycmF5fXtjY2NjfSAxJnhfezExfSZcbGRvdHMmeF97MXB9XFwKXHZkb3RzJlx2ZG90cyYmXHZkb3RzXFwKMSZ4X3tuMX0mXGxkb3RzJnhfe25wfQpcZW5ke2FycmF5fVxyaWdodF0kIG9yICRcbWF0aGJme1h9PVxsZWZ0W1xiZWdpbnthcnJheX17Y30gXG1hdGhiZnt4fV8xXlRcXFx2ZG90c1xcXG1hdGhiZnt4fV9uXlRcZW5ke2FycmF5fVxyaWdodF0kLAokXGJvbGRzeW1ib2x7XGJldGF9PVxsZWZ0W1xiZWdpbnthcnJheX17Y31cYmV0YV8wXFwgXHZkb3RzXFwgXGJldGFfcFxlbmR7YXJyYXl9XHJpZ2h0XSQgYW5kCiRcbWF0aGJme1xlcHNpbG9ufT1cbGVmdFtcYmVnaW57YXJyYXl9e2N9IFxlcHNpbG9uXzEgXFwgXHZkb3RzIFxcIFxlcHNpbG9uX25cZW5ke2FycmF5fVxyaWdodF0kCgotLS0KCiMjIGtsZWluc3RlIGt3YWRyYXRlbiB0ZWNobmllay9MZWFzdCBTcXVhcmVzIChMUykKCi0gTWluaW1pbWFsaXNlZXIgZGUgIHJlc2lkdWVsZSBrd2FkcmF0ZW5zb20KXGJlZ2lue2VxbmFycmF5Kn0KUlNTKFxib2xkc3ltYm9se1xiZXRhfSkmPSZcc3VtXGxpbWl0c197aT0xfV5uIGVeMl9pXFwKJj0mXHN1bVxsaW1pdHNfe2k9MX1ebiBcbGVmdCh5X2ktXGJldGFfMC1cc3VtXGxpbWl0c197aj0xfV5wIHhfe2lqfVxiZXRhX2pccmlnaHQpXjIKXGVuZHtlcW5hcnJheSp9CgotIG9mIGluIG1hdHJpeCBub3RhdGllCgokJApcdGV4dHtSU1N9KFxib2xkc3ltYm9se1xiZXRhfSk9KFxtYXRoYmZ7WX0tXG1hdGhiZntYXGJldGF9KV5UKFxtYXRoYmZ7WX0tXG1hdGhiZntYXGJldGF9KQokJAoKJCRccmlnaHRhcnJvdyBcaGF0e1xib2xkc3ltYm9se1xiZXRhfX09XHRleHR7YXJnbWlufV9cYmV0YSBcdGV4dHsgUlNTfShcYm9sZHN5bWJvbHtcYmV0YX0pJCQKCi0tLQoKIyMjIE1pbmltaW1hbGlzZWVyIFJTUwpcWwpcYmVnaW57YXJyYXl9e2NjY30KXGZyYWN7XHBhcnRpYWwgUlNTfXtccGFydGlhbCBcYm9sZHN5bWJvbHtcYmV0YX19Jj0mXG1hdGhiZnswfVxcXFwKXGZyYWN7KFxtYXRoYmZ7WX0tXG1hdGhiZntYXGJldGF9KV5UKFxtYXRoYmZ7WX0tXG1hdGhiZntYfVxib2xkc3ltYm9se1xiZXRhfSl9e1xwYXJ0aWFsIFxib2xkc3ltYm9se1xiZXRhfX0mPSZcbWF0aGJmezB9XFxcXAotMlxtYXRoYmZ7WH1eVChcbWF0aGJme1l9LVxtYXRoYmZ7WH1cYm9sZHN5bWJvbHtcYmV0YX0pJj0mXG1hdGhiZnswfVxcXFwKXG1hdGhiZntYfV5UXG1hdGhiZntYXGJldGF9Jj0mXG1hdGhiZntYfV5UXG1hdGhiZntZfVxcXFwKXGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19Jj0mKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cbWF0aGJme1h9XlRcbWF0aGJme1l9ClxlbmR7YXJyYXl9ClxdCgotLS0KCiMjIFZhcmlhbnRpZSBzY2hhdHRlcj8KXFsKXGJlZ2lue2FycmF5fXtjY2x9ClxoYXR7XGJvbGRzeW1ib2x7XFNpZ21hfX1fe1xoYXR7XGJvbGRzeW1ib2x7XGJldGF9fX0KJj0mXHRleHR7dmFyfVxsZWZ0WyhcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XG1hdGhiZntYfV5UXG1hdGhiZntZfVxyaWdodF1cXFxcCiY9JihcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XG1hdGhiZntYfV5UXHRleHR7dmFyfVxsZWZ0W1xtYXRoYmZ7WX1ccmlnaHRdXG1hdGhiZntYfShcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XFxcXAomPSYoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxtYXRoYmZ7WH1eVChcbWF0aGJme0l9XHNpZ21hXjIpXG1hdGhiZntYfShcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9ClxcXFwKJj0mKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cbWF0aGJme1h9XlRcbWF0aGJme0l9XHF1YWRcbWF0aGJme1h9KFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cc2lnbWFeMlxcXFwKJVxoYXR7XGJvbGRtYXRoe1xTaWdtYX19X3tcaGF0e1xib2xkc3ltYm9se1xiZXRhfX19Jj0mKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cbWF0aGJme1h9XlQgXHRleHR7dmFyfVxsZWZ0W1xtYXRoYmZ7WX1ccmlnaHRdKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cbWF0aGJme1h9XFwKJj0mKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cbWF0aGJme1h9XlRcbWF0aGJme1h9KFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cc2lnbWFeMlxcXFwKJj0mKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cc2lnbWFeMgpcZW5ke2FycmF5fQpcXQoKRGUgb256ZWtlcmhlaWQgb3AgbW9kZWwgcGFyYW1ldGVycyBoYW5ndCBkdXMgYWYgdmFuIGRlIHJlc2lkdWVsZSB2YXJpYWJpbGl0ZWl0IGVuIGhldCBkZSBwcm9lZm9wemV0IQoKLSBIb2UgZ3JvdGVyICRcbWF0aGJme1h9XlRcbWF0aGJme1h9JCBob2UgbWVlciBpbmZvcm1hdGllIGhldCBleHBlcmltZW50IHphbCBoZWJiZW4gb3ZlciBkZSBtb2RlbCBwYXJhbWV0ZXJzIGVuIGhvZSBrbGVpbmVyIGh1biB2YXJpYW50aWUgZW4gc3RhbmRhYXJkIGVycm9ycyEgCgotIEZhY3RvcmnDq2xlIGRlc2lnbnM/IAotIERlc2lnbnMgd2l0aCBjb250aW51ZSBwcmVkaWN0b3Jlbj8gCgotLS0KCkRlIGVmZmVjdGdyb290dGUgdmFuIGludGVyZXNzZSBpcyB0eXBpc2NoIGVlbiBsaW5lYWlyZSBjb21iaW5hdGllIHZhbiBkZSBtb2RlbCBwYXJhbWV0ZXJzLCAgCiQkCmxfMCBcdGltZXMgXGJldGFfMCArIGxfMSBcdGltZXMgXGJldGFfMSArIC4uLiArIGxfe3AtMX0gXHRpbWVzIFxiZXRhX3twLTF9ID0gXG1hdGhiZntMfV5UXGJvbGRzeW1ib2x7XGJldGF9CiQkIAoKRGUgbnVsaHlwb3RoZXNlIHZhbiBvbnplIHRlc3Qga2FuIGRhbiB3b3JkZW4gZ2VzY2hyZXZlbiBhbHMgCgoKJCQKSF8wOiBcbWF0aGJme0x9XlRcYm9sZHN5bWJvbHtcYmV0YX0gPSAwIAokJCAKCnZzIGRlIGFsdGVybmF0aWV2ZSBoeXBvdGhlc2UgCgokJApIXzA6IFxtYXRoYmZ7TH1eVFxib2xkc3ltYm9se1xiZXRhfSBcbmVxIDAgCiQkCgpFbiBoZXQgYmV3aWpzIGluIGhldCBleHBlcmltZW50IHRlZ2VuICRIXzAkIGthbiB3b3JkZW4gZ2Vrd2FudGlmaWNlZXJkIG1ldCBkZSB0LXRlc3Qgc3RhdGlzdGllazogCgokJAp0PVxmcmFje1xtYXRoYmZ7TH1eVFxoYXR7XGJvbGRzeW1ib2x7XGJldGF9fSAtIDB9e1x0ZXh0e3NlfV97XG1hdGhiZntMfV5UXGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19fX0KJCQKZGllIGVlbiB0LWRpc3RyaWJ1dGllIHZvbGd0IG1ldCBuLXAgdnJpamhlaWRzZ3JhZGVuIG9uZGVyIGRlIG51bCBoeXBvdGhlc2UgYWxzIGFsbGUgYWFubmFtZXMgdmFuIGhldCBtb2RlbCBnZWxkaWcgemlqbi4KCkRlIGtyYWNodCB2YW4gZGUgdG9ldHMgaXMgZGFuCgokJFAocCA8IDAuMDUgfCBIXzEpJCQKZW4gaGFuZ3QgYWYgdmFuIAoKLSBkZSB3ZXJrZWxpamtlIGVmZmVjdGdyb290dGUgaW4gZGUgcG9wdWxhdGllICRcbWF0aGJme0x9XlRcYm9sZHN5bWJvbHtcYmV0YX0kLgotIEhldCBhYW50YWwgb2JzZXJ2YXRpZXM6IFNFIGVuIGRmIHZhbiB0LXRlc3QuCi0gS2V1emUgdmFuIGRlIGRlc2lnbnB1bnRlbgotIEtldXplIHZhbiBzaWduaWZpY2FudGllLW5pdmVhdSAkXGFscGhhJC4gCgpXZSBrdW5uZW4gZGl0IGV2YWx1ZXJlbiBhYW4gZGUgaGFuZCB2YW4gc2ltdWxhdGllcy4KCiMjIE11aXMgdm9vcmJlZWxkCgotIEluIDIwMjEgcHVibGljZWVyZGVuIENob2EgZXQgYWwuIGRhdCBjeXRva2luZSBUaHltaWMgc3Ryb21hbCBseW1waG9wb2lldGluCihUU0xQKSB2ZXR2ZXJsaWVzIGluZHVjZWVydCBiaWogbXVpemVuIGRpZSBlZW4gdmV0IGRpZWV0IGtyaWpnZW4gZG9vciBkZSBzZWNyZXRpZSB2YW4gdGFsZy4gW1todG1sXShodHRwczovL3d3dy5zY2llbmNlLm9yZy9kb2kvZnVsbC8xMC4xMTI2L3NjaWVuY2UuYWJkMjg5MyldIFtbUERGXShodHRwczovL3d3dy5zY2llbmNlLm9yZy9kb2kvcGRmLzEwLjExMjYvc2NpZW5jZS5hYmQyODkzKV0KCi0gU3RlbCBkYXQgamUgZWVuIGdlbGlqa2FhcmRpZyBleHBlcmltZW50IG9wIHdpbCB6ZXR0ZW4gb20gbmEgdGUgZ2FhbiBvZiBjeXRva2luZSBpbnRlcmxldWtpbiAyNSAoSUwpIG9vayBlZW4gZWZmZWN0IGhlZWZ0IG9wIGhldCBnZXdpY2h0IHZhbiBtdWl6ZW4uIAoKLSBKZSBwbGFudCBlZW4gc3R1ZGllIG1ldCBlZW4gY29udHJvbGUgZ3JvZXAgbXVpemVuIGRpZSBlZW4gaG9vZyB2ZXQgZGllZXQga3JpamdlbiAgKEhGRCkgZW4gZWVuIGJlaGFuZGVsaW5nc2dyb2VwIGRpZSBlZW4gSEZEIGRpZWV0IG1ldCBJTCBrcmlqZ3QuIAoKLSBXYXQgaXMgZGUgdmVyZWlzdGUgc3RlZWtwcm9lZmdyb290dGUgb20gZWVuIGJlcGFhbGQgZWZmZWN0IG9wIHRlIHBpa2tlbiB2YW4gZGUgYmVoYW5kZWxpbmc/IAoKCiMjIyBIb2UgemFsIGplIGRlIGRhdGEgdmFuIGhldCBleHBlcmltZW50IGFuYWx5c2VyZW4/IAoKCi0tLQoKCgotICRIXzAkOiBFciBpcyBnZWVuIHZlcnNjaGlsIGluIGhldCBnZXdpY2h0IHZhbiBtdWl6ZW4gZGllIGVlbiBkaWVldCBtZXQgSUwga3JpamdlbiBlbiBtdWl6ZW4gZGllIGhldCBjb250cm9sZSBkaWVldCBrcmlqZ2VuLgotICRIXzEkOiBIZXQgZ2V3aWNodCBpcyBnZW1pZGRlbGRlIHZlcnNjaGlsbGVuZCB0dXNzZW4gbXVpemVuIGRpZSBoZXQgSUwgZGllZXQga3JpamdlbiBlbiBtdWl6ZW4gZGllIGhldCBjb250cm9sZSBkaWVldCBrcmlqZ2VuLgoKLSBUd28gc2FtcGxlIHQtdGVzdCBvZiBlZW4gdC10ZXN0IG9wIGRlIGhlbGxpbmcgdmFuIGhldCBsaW5lYWlyZSBtb2RlbCBtZXQgMSBkdW1teSB2YXJpYWJlbGUKCiQkIFlfaSA9IFxiZXRhXzAgKyBcYmV0YV8xIFhfXHRleHR7aUlMfSArIFxlcHNpbG9uX2kkJCAKCiQkClx0ZXh0e21ldCB9ClhfXHRleHR7aUlMfT1cYmVnaW57Y2FzZXN9WF97aUlMfT0wICYgXHRleHR7SEZEfVxcWF97aUlMfT0xICYgXHRleHR7SEZEICsgSUx9XGVuZHtjYXNlc30uCiQkCgotIEdlc2NoYXR0ZSBlZmZlY3Rncm9vdHRlPwoKJCRcaGF0XGRlbHRhID0gXGJhciBYX3tJTH0gLSBcYmFyIFhfe2N9ID0gXGhhdCBcYmV0YV8xJCQKCi0gVGVzdCBzdGF0aXN0aWVrCiQkClQgPSBcZnJhY3tcYmFye1h9X3tJTH0tXGJhcntYfV97Y319e1NEX1x0ZXh0e3Bvb2xlZH0gXHRpbWVzIFxzcXJ0e1xmcmFjezF9e25fMX0gKyBcZnJhY3sxfXtuXzJ9fX0gPSBcZnJhY3tcaGF0XGJldGFfMX17XHRleHR7U0V9X3tcaGF0XGJldGFfMX19CiQkCi0gJFxoYXQgXGJldGFfMSQgaXMgZWVuIG9udmVydGVrZW5kZSBzY2hhdHRlciB2YW4gaGV0IHdlcmtlbGlqayBnZXdpY2h0c3ZlcnNjaGlsICgkXGRlbHRhID1cbXVfe0lMfS1cbXVfe2N9ID0gXGJldGFfMSQpIGRhdCB6b3Ugdm9vcmtvbWVuIGluIGRlIHBvcHVsYXRpZSB2YW4gbXVpemVuIGdldm9lZCBtZXQgSEZEIHZzIG11aXplbiBnZXZvZWQgbWV0IEhGRCArIElMLiAgCgojIyMgUG93ZXI/IAoKJCQKUFtwIDwgXGFscGhhIFx2ZXJ0IFxiZXRhXzEgXG5lcSAwXQokJAoKCkRlIGtyYWNodCAocG93ZXIpIHphbCBkdXMgYWZoYW5nZW4gdmFuIAoKLSBIZXQgd2Vya2VsaWprZSBnZW1pZGRlbGRlIGdld2ljaHRzdmVyc2NoaWwgJFxiZXRhXzEkIGluIGRlIHBvcHVsYXRpZS4KLSBEZSB2YXJpYWJpbGl0ZWl0IHZhbiBkZSBnZXdpY2h0c21ldGluZ2VuCi0gaGV0IHNpZ25pZmljYW50aWUtbml2ZWF1ICRcYWxwaGEkCi0gc3RlZWtwcm9lZmdyb290dGUgJG5fe0lMfSQgZW4gJG5fYyQgaW4gYmVpZGUgZ3JvZXBlbiAKCgpXZSBrdW5uZW4gZGUgcG93ZXIgc2NoYXR0ZW4gYWxzIAoKMS4gdm9sZGFhbiBpcyBhYW4gZGUgIGFhbm5hbWVucyB2YW4gaGV0IG1vZGVsOiBnZXdpY2h0IGluIGJlaWRlIGdyb2VwZW4gaXMgbm9ybWFhbCB2ZXJkZWVsZCBtZXQgZ2VsaWprZSB2YXJpYW50aWUKCmVuIGFscyB3ZSBkZSAKCjIuIHN0YW5kYWFyZCBkZXZpYXRpZSBrZW5uZW4gdmFuIGdld2ljaHRzbWV0aW5nZW4gcm9uZCBodW4gZ3JvZXBzZ2VtaWRkZWxkZSB2b29yIG11aXplbiBkaWUgZWVuIEhGRCBkaWV0IGtyaWpnZW4KCjMuIGRlIGVjaHRlIGVmZmVjdGdyb290dGUgaW4gZGUgcG9wdWxhdGllCjQuICRuXzEkIGVuICRuXzIkIAoKIyMjIEdlYnJ1aWsgZGF0YSB1aXQgdm9yaWcgZXhwZXJpbWVudCBvbSBpbnppY2h0IHRlIGtyaWpnZW4gaW4gZGUgZ2V3aWNodHNkYXRhIHZhbiBtdWl6ZW4KClN0ZWwgZGF0IHdlIHRvZWdhbmcgaGViYmVuIHRvdCBkYXRhIHZhbiBlZW4gdm9yaWcgZXhwZXJpbWVudCAoaGllciBkYXQgdmFuIEthcmVuIFN2ZW5zb24gZW4gRGFuIEdhdHRpLCBnZWZpbmFuY2llcmQgZG9vciBQNTAgR00wNzA2ODMgZW4gYmVzY2hpa2JhYXIgb3AgW1BINTI1eF0oaHR0cDovL2dlbm9taWNzY2xhc3MuZ2l0aHViLmlvL2Jvb2svcGFnZXMvcmFuZG9tX3ZhcmlhYmxlcy5odG1sKSkKCmBgYHtyfQptaWNlIDwtIHJlYWQuY3N2KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZ2Vub21pY3NjbGFzcy9kYWdkYXRhL21hc3Rlci9pbnN0L2V4dGRhdGEvZmVtYWxlTWljZVdlaWdodHMuY3N2IikKCm1pY2UgJT4lIAogIGdncGxvdChhZXMoeD1EaWV0LHk9Qm9keXdlaWdodCkpICsKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZT1GQUxTRSkgKwogIGdlb21faml0dGVyKCkKCm1pY2UgJT4lIAogIGdncGxvdChhZXMoc2FtcGxlPUJvZHl3ZWlnaHQpKSArCiAgZ2VvbV9xcSgpICsgCiAgZ2VvbV9xcV9saW5lKCkgKwogIGZhY2V0X3dyYXAofkRpZXQpCmBgYAoKYGBge3J9Cm1pY2UgPC0gbWljZSAlPiUgbXV0YXRlKERpZXQgPSBhcy5mYWN0b3IoRGlldCkpCm1pY2VTdW0gPC0gbWljZSAlPiUgCiAgZ3JvdXBfYnkoRGlldCkgICU+JQogIHN1bW1hcml6ZV9hdCgiQm9keXdlaWdodCIsbGlzdChtZWFuPX5tZWFuKC4sbmEucm09VFJVRSksCiAgICAgICAgICAgICAgICAgICAgc2Q9fnNkKC4sbmEucm09VFJVRSksCiAgICAgICAgICAgICAgICAgICAgbj1mdW5jdGlvbih4KSB4JT4laXMubmElPiVgIWAlPiVzdW0pKSAlPiUKICBtdXRhdGUoc2U9c2Qvc3FydChuKSkKbWljZVN1bSAKYGBgCgpJbiBoZXQgZXhwZXJpbWVudCB3ZXJkZW4gdHdlZSBkacOrdGVuIGdlYnJ1aWt0OiAKCi0gZ2V3b29uIGRpZXQgby5iLnYuIGdyYW5lbiAoQ2hvdykgCi0gSGVlbCB2ZXQgZGllZXQgKGhpZ2ggZmF0OiBoZikKCldlIGt1bm5lbiBkZSBkYXRhIHZhbiBkZSBoZiBtdWl6ZW4gZ2VicnVpa2VuIGFscyBpbnB1dCB2b29yIG9uemUgcG93ZXIgYW5hbHlzZS4gCgotIERlIGRhdGEgdmFuIGhmIG11aXplbiBsaWprZW4gbm9ybWFhbCB2ZXJkZWVsZCB0ZSB6aWpuLiAgCi0gSGV0IGdlbWlkZGVsZGUgZ2V3aWNodCB2YW4gZWVuIGhmIG11aXMgaXMgYHIgbWljZVN1bSAlPiUgZmlsdGVyKERpZXQgPT0gImhmIikgJT4lIHB1bGwoIm1lYW4iKSAlPiUgcm91bmQoLiwxKWBnIAotIERlIHN0YW5kYWFyZCBkZXZpYXRpZSAoU0QpIHZhbiBoZXQgZ2V3aWNodCB2YW4gaGYgbXVpemVuIGlzIGByIG1pY2VTdW0gJT4lIGZpbHRlcihEaWV0ID09ICJoZiIpICU+JSBwdWxsKCJzZCIpICU+JSByb3VuZCguLDEpYGcgCgpFZmZlY3Rncm9vdGU/IAoKLSBEZSBhbHRlcm5hdGl2ZSBoeXBvdGhlc2UgaXMgY29tcGxleC4gCi0gT212YXQgYWxsZSBtb2dlbGlqa2UgZWZmZWN0ZW4hIAotIE9tIGVlbiBwb3dlciBhbmFseXNlIHRlIGRvZW4ga2llemVuIHdlIGRhYXJvbSBlZW4gbWluaW1hbGUgZWZmZWN0Z3Jvb3R0ZSBkaWUgd2Ugd2Vuc2VuIG9wIHRlIHBpa2tlbiBpbiBoZXQgbmlldXdlIGV4cGVyaW1lbnQuIAotIFZlcm9uZGVyc3RlbCBkYXQgd2UgZWVuIGdld2ljaHRzdmVyc2NoaWwgd2lsbGVuIG9wcGlra2VuIHZhbiBtaW5pbWFhbCAxMCUuIAoKYGBge3J9CmRlbHRhIDwtIC0gcm91bmQobWljZVN1bSRtZWFuWzJdICouMSwxKQpkZWx0YQpgYGAKCk1lcmsgb3AgZGF0IGhldCBnZW1pZGRlbGQgZ2V3aWNodCBkYW4gZGljaHQga29tdCBiaWogZGF0IHZhbiBtdWl6ZW4gaW4gaGV0IHBpbG9vdGV4cGVyaW1lbnQgZGllIHdlcmRlbiBnZXZvZWQgbWV0IGhldCBub3JtYWxlIGRpZWV0LiAKCldlIGt1bm5lbiBudSBlZW4gc2ltdWxhdGllIHN0dWRpZSBvcHpldHRlbiBvbSBkZSBwb3dlciB0ZSBiZXJla2VuZW4gdm9vciBlZW4gZXhwZXJpbWVudCBtZXQgOCBtdWl6ZW4gaW4gZWxrZSBncm9lcC4gCgojIyMjIEXDqW4gc2ltdWxhdGllCgpgYGB7cn0Kc2V0LnNlZWQoMTQyMykKbjEgPC0gbjIgPC0gOApiMCA8LSByb3VuZChtaWNlU3VtJG1lYW5bMl0sMSkKYjEgPC0gLSBkZWx0YQpzZCA8LSByb3VuZChtaWNlU3VtJHNkWzJdLDEpCmFscGhhIDwtIDAuMDUKCnggPC0gcmVwKDA6MSxjKG4xLG4yKSkKeSA8LSBiMCArIGIxICogeCArIHJub3JtKG4xK24yLDAsIHNkID0gc2QpCmZpdCA8LSBsbSh5fngpCmJoYXQgPC0gZml0JGNvZWYgCnN0YXQgPC0gc3VtbWFyeShmaXQpCnN1bW1hcnkoZml0KSRjb2VmWzIsXQpgYGAKClZvb3IgaGV0IGdlc2ltdWxlZXJkZSBleHBlcmltZW50IGtvbmRlbiB3ZSBoZXQgZWZmZWN0IHZhbiBkZSBiZWhhbmRlbGluZyBgciBpZmVsc2Uoc3VtbWFyeShmaXQpJGNvZWZbMiwiUHIoPnx0fCkiXSA8IGFscGhhLCIiLCJuaWV0IilgIG9wcGlra2VuIGJpaiBoZXQgICRcYWxwaGEkPWByIGFscGhhYCAocCA9IGByIHJvdW5kKHN1bW1hcnkoZml0KSRjb2VmWzIsIlByKD58dHwpIl0sMilgKSBzaWduaWZpY2FudGllLW5pdmVhdSEgCgotIFdlIG1vZXRlbiBoZXQgZXhwZXJpbWVudCBoZXJoYWxlbiBvbSBkZSBwb3dlciB0ZSBzY2hhdHRlbi4gCi0gV2UgenVsbGVuIGRlIHNpbXVsYXRpZSBkYWFyb20gY29kZXJlbiBpbiBlZW4gZnVuY3RpZSBkaWUgd2Uga3VubmVuIGhlcmdlYnJ1aWtlbi4gCgojIyMjIFNpbXVsYXRpZSB2YW4gaGVyaGFhbGRlIGV4cGVyaW1lbnRlbiAocmVwZWF0ZWQgZXhwZXJpbWVudHMpCgpgYGB7cn0KbGlicmFyeShtdWx0Y29tcCkKbjEgPC0gbjIgPC0gOAoKYjAgPC0gcm91bmQobWljZVN1bSRtZWFuWzJdLDEpCmIxIDwtIC0gZGVsdGEKCnNkIDwtIHJvdW5kKG1pY2VTdW0kc2RbMl0sMSkKcHJlZGljdG9yRGF0YSA8LSBkYXRhLmZyYW1lKERpZXQgPSByZXAoYygiYyIsImhmIiksYyhuMSxuMikpICU+JSBhcy5mYWN0b3IpCgphbHBoYSA8LSAwLjA1CgpzaW1MbSA8LSBmdW5jdGlvbihmb3JtLCBkYXRhLCBiZXRhcywgc2QsIGNvbnRyYXN0cywgc2ltSW5kZXggPSBOQSkKewogIGRhdGFTaW0gPC0gZGF0YQogIFggPC0gbW9kZWwubWF0cml4KGZvcm0sZGF0YVNpbSkKICBkYXRhU2ltJHlTaW0gPC0gWCUqJWJldGFzICsgcm5vcm0obnJvdyhkYXRhU2ltKSwwLHNkKQogIGZvcm0gPC0gZm9ybXVsYShwYXN0ZSgieVNpbSB+Iixmb3JtW1syXV0pKQogIGZpdFNpbSA8LSBsbShmb3JtLGRhdGFTaW0pCiAgbWNwIDwtIGdsaHQoZml0U2ltLGxpbmZjdCA9IGNvbnRyYXN0cykKICByZXR1cm4oc3VtbWFyeShtY3ApJHRlc3RbYygiY29lZmZpY2llbnRzIiwic2lnbWEiLCJ0c3RhdCIsInB2YWx1ZXMiKV0lPiUgdW5saXN0KQp9CgpzaW1MbSgKICBmb3JtID0gfkRpZXQsCiAgZGF0YSA9IHByZWRpY3RvckRhdGEsCiAgYmV0YXMgPSBjKGIwLGIxKSwKICBzZCA9IHNkLAogIGNvbnRyYXN0cyA9ICJEaWV0aGYgPSAwIikKYGBgCgpXZSBoZWJiZW4gbnUgZWVuIGdlbmVyaWVrIGZ1bmN0aWUgd2Fhcm1lZSB3ZSBkYXRhIGt1bm5lbiBzaW11bGVyZW4gZGllIG5vcm1hYWwgdmVyZGVlbGQgemlqbiB2b29yIGVsayBtb2dlbGlqayBkZXNpZ24gZGllIHdlIG1ldCBoZXQgbGluZWFpciBtb2RlbCBrdW5uZW4gYW5hbHlzZXJlbi4gCgpEZSBmdW5jdGllIGhlZWZ0IHZvbGdlbmRlIGFyZ3VtZW50ZW46IAoKLSBgZm9ybWA6IE9uZSBzaWRlZCBmb3JtdWxhIGluY2x1ZGluZyB0aGUgc3RydWN0dXJlIG9mIHRoZSBwcmVkaWN0b3JzIGluIHRoZSBtb2RlbCAKLSBgZGF0YWA6IERhdGEgZnJhbWUgd2l0aCB0aGUgcHJlZGljdG9yIHZhbHVlcyBmb3IgdGhlIGRlc2lnbgotIGBiZXRhc2A6IEEgdmVjdG9yIHdpdGggdmFsdWVzIGZvciBhbGwgbWVhbiBtb2RlbCBwYXJhbWV0ZXJzCi0gYHNkYDogVGhlIHN0YW5kYXJkIGRldmlhdGlvbiBvZiB0aGUgZXJyb3IgCi0gYGNvbnRyYXN0c2A6IGEgc2NhbGFyIG9yIGEgdmVjdG9yIHdpdGggdGhlIG51bGwgaHlwb3RoZXNlcyB0aGF0IHdlIHdvdWxkIGxpa2UgdG8gYXNzZXNzLiAKLSBgc2ltSW5kZXhgOiBhbiBhcmJpdHJhcnkgYXJndW1lbnQgdGhhdCBpcyBub3QgdXNlZCBieSB0aGUgIGZ1bmN0aW9uIGJ1dCB0aGF0IHdpbGwgYWxsb3cgaXQgdG8gYmUgdXNlZCBpbiBhbiBzYXBwbHkgbG9vcCB0aGF0IHJ1bnMgZnJvbSAxIHVwIHRvIHRoZSBudW1iZXIgb2Ygc2ltdWxhdGlvbnMuIAoKU2ltdWxlZXIgblNpbSA9IDEwMDAgaGVyaGFhbGRlIGV4cGVyaW1lbnRlbjogCgpgYGB7cn0Kc2V0LnNlZWQoMTQyNSkKblNpbSA8LSAxMDAwCgpzaW1SZXN1bHRzICA8LSB0KHNhcHBseSgxOm5TaW0sc2ltTG0sZm9ybSA9IH5EaWV0LGRhdGEgPSBwcmVkaWN0b3JEYXRhLGJldGFzID0gYyhiMCxiMSksc2QgPSBzZCxjb250cmFzdHMgPSAiRGlldGhmID0gMCIpKQpwb3dlciA8LSBtZWFuKHNpbVJlc3VsdHNbLDRdIDwgYWxwaGEpCnBvd2VyCmBgYAoKV2UgaGViYmVuIGVlbiBwb3dlciB2YW4gYHIgcG93ZXIqMTAwYCUgb20gaGV0IGJlaGFuZGVsaW5nc2VmZmVjdCBvcCB0ZSBwaWtrZW4gbWV0IDggYmlvbG9naXNjaGUgaGVyaGFsaW5nZW4gaW4gZWxrZSBiZWhhbmRlbGluZ3Nncm9lcC4gCgpNZXJrIG9wIGRhdCBkZSBwb3dlciB2YW4gZWVuIGV4cGVyaW1lbnQgb29rIGhldCBob29nc3RlIGlzIGFscyBoZXQgYWFudGFsIG9ic2VydmF0aWVzIGdlYmFsYW5jZWVyZCBpcywgbS5hLncuICRuXzE9bl8yJC4gCgojIyMjIFBvd2VyIHZvb3IgdmVyc2NoaWxsZW5kZSBzdGVla3Byb2VmZ3Jvb3R0ZXMgCgpXZSBrdW5uZW4gZGUgcG93ZXIgbnUgYmVyZWtlbmVuIHZvb3IgbWVlcmRlcmUgc3RlZWtwcm9lZmdyb290ZXMuIAoKYGBge3J9CnBvd2VyIDwtIGRhdGEuZnJhbWUobj1jKDMsNSwxMCwyNSw1MCw3NSwxMDApLHBvd2VyPU5BKQoKZm9yIChpIGluIDE6bnJvdyhwb3dlcikpCnsKICBuMSA8LSBuMiA8LSBwb3dlciRuW2ldCiAgcHJlZGljdG9yRGF0YSA8LSBkYXRhLmZyYW1lKERpZXQgPSByZXAoYygiYyIsImhmIiksYyhuMSxuMikpICU+JSBhcy5mYWN0b3IpCiAgc2ltUmVzdWx0cyAgPC0gdChzYXBwbHkoMTpuU2ltLHNpbUxtLGZvcm0gPSB+RGlldCxkYXRhID0gcHJlZGljdG9yRGF0YSxiZXRhcyA9IGMoYjAsYjEpLHNkID0gc2QsY29udHJhc3RzID0gIkRpZXRoZiA9IDAiKSkKICBwb3dlciRwb3dlcltpXSA8LSBtZWFuKHNpbVJlc3VsdHNbLCJwdmFsdWVzIl0gPCBhbHBoYSkKfQpwb3dlcgpgYGAKCmBgYHtyfQpwb3dlciAlPiUgCiAgZ2dwbG90KGFlcyh4PW4seT1wb3dlcikpICsKICBnZW9tX2xpbmUoKQpgYGAKCiMjIyMgQmVzdHVkZWVyIHBvd2VyIGluIGZ1bmN0aWUgdmFuIHN0ZWVrcHJvZWZncm9vdHRlIGVuIGVmZmVjdGdyb290dGUgCgpNZXJrIG9wIGRhdCAKCi0gaGV0IHRla2VuIHZhbiBkZWx0YSBhcmJpdHJhaXIgaXMgb21kYXQgd2UgdHdlZXppamRpZyB0ZXN0ZW4uCi0gaGV0IGludGVyY2VwdCBhcmJpdHJhaXIgaXMgb21kYXQgd2UgYWxsZWVuIHRlc3RlbiBvcCAkXGJldGFfMSQKLSBXZSBuZW1lbiBkYWFyb20gdHlwaXNjaCAkXGJldGFfMCA9IDAkCgpgYGB7cn0KblNpbSA8LSAxMDAwCmIwIDwtIDAKZGVsdGFzIDwtIGMoMSwyLDMsNSwxMCkKc2QgPC0gcm91bmQobWljZVN1bSRzZFsyXSwxKQpucyA8LSAgYygzLDUsMTAsMjAsMjUsNTAsNzUsMTAwKSAgCgpwb3dlciA8LSBkYXRhLmZyYW1lKGIxPXJlcChkZWx0YXMsZWFjaD1sZW5ndGgobnMpKSwKICAgICAgICAgICAgICAgICAgICBuPXJlcChucyxsZW5ndGgoZGVsdGFzKSksCiAgICAgICAgICAgICAgICAgICAgcG93ZXI9TkEpCgpmb3IgKGkgaW4gMTpucm93KHBvd2VyKSkKewogIGIxIDwtcG93ZXIkYjFbaV0KICBuMSA8LSBuMiA8LSAgcG93ZXIkbltpXQogIHByZWRpY3RvckRhdGEgPC0gZGF0YS5mcmFtZShEaWV0ID0gcmVwKGMoImMiLCJoZiIpLGMobjEsbjIpKSAlPiUgYXMuZmFjdG9yKQogIHNpbVJlc3VsdHMgIDwtIHQoc2FwcGx5KDE6blNpbSxzaW1MbSxmb3JtID0gfkRpZXQsZGF0YSA9IHByZWRpY3RvckRhdGEsYmV0YXMgPSBjKGIwLGIxKSxzZCA9IHNkLGNvbnRyYXN0cyA9ICJEaWV0aGYgPSAwIikpCiAgcG93ZXIkcG93ZXJbaV0gPC0gbWVhbihzaW1SZXN1bHRzWywicHZhbHVlcyJdIDwgYWxwaGEpCn0KYGBgCgpgYGB7cn0KcG93ZXIgJT4lIAogIGdncGxvdChhZXMoeD1uLHk9cG93ZXIsY29sPWIxJT4lYXMuZmFjdG9yKSkgKwogIGdlb21fbGluZSgpCmBgYAoKTWVyayBvcCBkYXQgZGUgcG93ZXIgY3VydmVzIHdhdCBzY2hva2tlcmlnIHppam4gb21kYXQgd2UgbWFhciBlZW4gYmVwZXJrdCBhYW50YWwgc3RlZWtwcm9lZmdyb290dGVzIGVuIGVlbiBiZXBlcmt0IGFhbnRhbCBzaW11bGF0aWVzIHVpdHZvZXJkZW4uIApWb29yIGRlIGxhZ2UgcG93ZXJzIGlzIGhldCBhYW50YWwgc2ltdWxhdGllcyB6ZWtlciBvbnZvbGRvZW5kZSBvbSBoZWVsIGJldHJvdXdiYXJlIHNjaGF0dGluZ2VuIHZhbiBkZSBwb3dlciB0ZSBiZWtvbWVuLiAKCiMgT3BtZXJraW5nZW4KCi0gRGUgY29kZSBrYW4gZWVudm91ZGlnIGFhbmdlcGFzdCB3b3JkZW4gbmFhciBhbmRlcmUgZGVzaWducyAoemllIG9lZmVuaW5nZW4pCiAgICAKICAgIC0gcHJlZGljdG9yIGRhdGEgCiAgICAtIGZvcm11bGEKICAgIC0gY29udHJhc3QKCi0gRGUgc2ltdWxhdGllcyBrdW5uZW4gbGFuZyBkdXJlbiB3YW5uZWVyIGplIHZlZWwgc2NlbmFyaW8ncyBldmFsdWVlcnQuICAKICAgIAogICAgLSBNZWVyIGVmZmljacOrbnRlIGNvZGUgbWV0IG1hdHJpY2VzCiAgICAtIFZvb3IgdHdvIGdyb3VwIGNvbXBhcmlzb24gYmVzdGFhdCBlZW4gYW5hbHl0aXNjaGUgb3Bsb3NzaW5nLiAKICAgIAoKCgojIyAgTWVlciBlZmZpY2nDq250ZSBjb2RlIG1ldCBtYXRyaWNlcwoKQ29kZSBpcyB2ZWVsIHNuZWxsZXIuIFdlIHNpbXVsYWxlcmVuIG51IDIwIGtlZXIgbWVlciBleHBlcmltZW50ZW4gaW4gZWVuIHZlZWwga29ydGVyZSB0aWpkISAKCmBgYHtyfQpuU2ltIDwtIDIwMDAwCmIwIDwtIDAKc2QgPC0gcm91bmQobWljZVN1bSRzZFsyXSwxKQpucyA8LSAgYygzLDUsMTAsMjAsMjUsNTAsNzUsMTAwKSAgCmRlbHRhcyA8LSBjKDEsMiwzLDUsMTApCgoKcG93ZXJGYXN0IDwtIG1hdHJpeChOQSxucm93PWxlbmd0aChucykqbGVuZ3RoKGRlbHRhcyksbmNvbD0zKSAlPiUgYXMuZGF0YS5mcmFtZQpuYW1lcyhwb3dlckZhc3QpIDwtIGMoImIxIiwibiIsInBvd2VyIikKCmkgPC0gMAoKZm9yIChuIGluIG5zKQp7CiAgbjEgPC0gbjIgPC0gIG4KICAKICAjIyMgU2ltdWxhdGlvbgogIHByZWRpY3RvckRhdGEgPC0gZGF0YS5mcmFtZShEaWV0ID0gcmVwKGMoImMiLCJoZiIpLGMobjEsbjIpKSAlPiUgYXMuZmFjdG9yKQogIGRlc2lnbiA8LSBtb2RlbC5tYXRyaXgofkRpZXQscHJlZGljdG9yRGF0YSkKICBMIDwtIGxpbW1hOjptYWtlQ29udHJhc3RzKCJEaWV0aGYiLGxldmVscyA9IGNvbG5hbWVzKGRlc2lnbikpCgogIAogIGZvciAoYjEgaW4gZGVsdGFzKQogIHsKICAgIHlTaW0gPC0gcm5vcm0obnJvdyhwcmVkaWN0b3JEYXRhKSpuU2ltLHNkPXNkKQogICAgZGltKHlTaW0pIDwtYyhucm93KHByZWRpY3RvckRhdGEpLG5TaW0pCiAgICB5U2ltIDwtIHlTaW0gKyBjKGRlc2lnbiAlKiVjKGIwLGIxKSkKICAgIHlTaW0gPC0gdCh5U2ltKQogIAogICAgIyMjIEZpdHRpbmcKICAgIGZpdEFsbCA8LSBsaW1tYTo6bG1GaXQoeVNpbSxkZXNpZ24pCiAgCiAgICAjIyMgSW5mZXJlbmNlCiAgICB2YXJVbnNjYWxlZCA8LSBjKHQoTCklKiVmaXRBbGwkY292LmNvZWZmaWNpZW50cyUqJUwpCiAgICBjb250cmFzdHMgPC0gZml0QWxsJGNvZWZmaWNpZW50cyAlKiVMCiAgICBzZUNvbnRyYXN0cyA8LSB2YXJVbnNjYWxlZF4uNSpmaXRBbGwkc2lnbWEKICAgIHRzdGF0cyA8LSBjb250cmFzdHMvc2VDb250cmFzdHMKICAgIHB2YWxzIDwtIHB0KGFicyh0c3RhdHMpLGZpdEFsbCRkZi5yZXNpZHVhbCxsb3dlci50YWlsID0gRkFMU0UpKjIKICAgIAogICAgaSA8LSBpKzEKICAgIHBvd2VyRmFzdFtpLF0gPC0gYyhiMSxuLG1lYW4ocHZhbHMgPCBhbHBoYSkpCiAgfQp9CmBgYAoKYGBge3J9CnBvd2VyRmFzdCAlPiUgCiAgZ2dwbG90KGFlcyh4PW4seT1wb3dlcixjb2w9YjElPiVhcy5mYWN0b3IpKSArCiAgZ2VvbV9saW5lKCkKYGBgCgojIyBNZWVyIGVmZmljacOrbnRlIGNvZGUgZ2ViYXNlZXJkIG9wIGRlIGFuYWx5dGlzY2hlIG9wbG9zc2luZyB2b29yIGVlbiB0d28gZ3JvdXAgY29tcGFyaXNvbgoKLSBWb29yIGRlIHR3byBzYW1wbGUgdC10ZXN0IGJlc3RhYXQgZXIgZWVuIGFuYWx5dGlzY2hlIG9wbG9zc2luZyBvbSBkZSBwb3dlciB0ZSBiZXJla2VuZW4uIAoKLSBJbiBkZXplIGNvbnRleHQgbWFha3QgbWVuIHR5cGlzY2ggZ2VicnVpayB2YW4gZGUgIkNvaGVuJ3MgZWZmZWN0IHNpemUiOiAKCiREID0gXGZyYWN7XGRlbHRhfXtTRH0kCgoKYGBge3J9CnBvd2VyLnQudGVzdChuPTgsIGRlbHRhID0gZGVsdGEsIHNkID0gc2QsIHR5cGU9J3R3by5zYW1wbGUnKQpgYGAKCk1lcmsgb3AgZGF0IGRlIHBvd2VyIG92ZXJlZW5rb210IG1ldCBkZWdlbmUgZGllIHdlIHZpYSBzaW11bGF0aWVzIGhlYmJlbiBnZXNjaGF0ISAKCgpgYGB7cn0KYjAgPC0gMApzZCA8LSByb3VuZChtaWNlU3VtJHNkWzJdLDEpCm5zIDwtICBjKDMsNSwxMCwyMCwyNSw1MCw3NSwxMDApICAKZGVsdGFzIDwtIGMoMSwyLDMsNSwxMCkKCgpwb3dlclRoZW8gPC0gZGF0YS5mcmFtZShkZWx0YXM9cmVwKGRlbHRhcyxlYWNoPWxlbmd0aChucykpLAogICAgICAgICAgICAgICAgICAgIG49cmVwKG5zLGxlbmd0aChkZWx0YXMpKSwKICAgICAgICAgICAgICAgICAgICBwb3dlcj1OQSkKCnBvd2VyVGhlbyRwb3dlciA8LSBhcHBseShwb3dlclRoZW9bLDE6Ml0sMSxmdW5jdGlvbih4KSBwb3dlci50LnRlc3QoZGVsdGE9eFsxXSxuPXhbMl0sc2Q9c2QsdHlwZT0idHdvLnNhbXBsZSIpJHBvd2VyKQpgYGAKCgpgYGB7cn0KcG93ZXJUaGVvICU+JSAKICBnZ3Bsb3QoYWVzKHg9bix5PXBvd2VyLGNvbD1kZWx0YXMlPiVhcy5mYWN0b3IpKSArCiAgZ2VvbV9saW5lKCkKYGBg</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("experimentalDesignI.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
