<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement" />


<title>Introductie</title>

<script src="site_libs/header-attrs-2.9/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="example.html">Example</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lab 1</li>
    <li class="dropdown-header">Lab 2</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/Rmd-website">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Introductie</h1>
<h4 class="author">Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<div id="longvolume-en-rokerstatus" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Longvolume en rokerstatus</h1>
<ul>
<li>Onderzoekers willen de impact van roken onderzoeken op longcapaciteit bij schoolgaande kinderen en adolescenten.</li>
<li>Ze meten hierbij de longcapaciteit (in l) bij rokende en niet-rokende leerlingen (forced expiratory volume).</li>
</ul>
<p><img src="figs/fevMeasurement.jpg" width="175" /> ## Importeer data</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.2     ✓ dplyr   1.0.7
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fev <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;https://raw.githubusercontent.com/GTPB/PSLS20/master/data/fev.txt&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   age = col_double(),
##   fev = col_double(),
##   height = col_double(),
##   gender = col_character(),
##   smoking = col_double()
## )</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fev)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["height"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["gender"],"name":[4],"type":["chr"],"align":["left"]},{"label":["smoking"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"9","2":"1.708","3":"57.0","4":"f","5":"0"},{"1":"8","2":"1.724","3":"67.5","4":"f","5":"0"},{"1":"7","2":"1.720","3":"54.5","4":"f","5":"0"},{"1":"9","2":"1.558","3":"53.0","4":"m","5":"0"},{"1":"9","2":"1.895","3":"57.0","4":"m","5":"0"},{"1":"8","2":"2.336","3":"61.0","4":"f","5":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div id="data-manipulatie" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> Data manipulatie</h2>
<ol style="list-style-type: decimal">
<li><code>gender</code> and <code>smoking</code> kunnen beter worden omgezet naar factor variabelen</li>
<li>De <code>height</code> variabele is in inches dus deze zetten we om in cm.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fev <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">as.factor</span>(gender)) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">smoking =</span> <span class="fu">as.factor</span>(smoking)) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">height_cm =</span> height<span class="sc">*</span><span class="fl">2.54</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fev)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["height"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["gender"],"name":[4],"type":["fct"],"align":["left"]},{"label":["smoking"],"name":[5],"type":["fct"],"align":["left"]},{"label":["height_cm"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"9","2":"1.708","3":"57.0","4":"f","5":"0","6":"144.78"},{"1":"8","2":"1.724","3":"67.5","4":"f","5":"0","6":"171.45"},{"1":"7","2":"1.720","3":"54.5","4":"f","5":"0","6":"138.43"},{"1":"9","2":"1.558","3":"53.0","4":"m","5":"0","6":"134.62"},{"1":"9","2":"1.895","3":"57.0","4":"m","5":"0","6":"144.78"},{"1":"8","2":"2.336","3":"61.0","4":"f","5":"0","6":"154.94"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="enkele-concepten" class="section level2" number="1.2">
<h2 number="1.2"><span class="header-section-number">1.2</span> Enkele Concepten</h2>
<ul>
<li><p>In een <strong>experimentele studie</strong> gaat een onderzoeker de <strong>behandeling</strong> <strong>at random</strong> toewijzen aan de <strong>experimentele eenheden</strong> en observeert hij/zij het effect van de <strong>behandeling</strong> bij de experimentele eenheden door het meten van één of meerdere <strong>reponse variabelen</strong>.</p></li>
<li><p>Een <strong>experimentele eenheid</strong> (experimental unit) is de eenheid (subject, plant, pot, proefdier) dat at random aan de behandeling wordt toegewezen. <strong>Experimentele eenheden in fev example?</strong></p></li>
<li><p>Een <strong>response variabele</strong> is a characteristiek van de experimentele eenheid die wordt gemeten en geanalyseerd om het effect van de behandeling na te gaan. <strong>Response variable in fev example?</strong></p></li>
<li><p>Een  is de eenheid waarop de response variabele wordt gemeten. Veelal is er een één-op-één overeenkomst tussen experimentele en observationele eenheden. Maar dat is niet altijd zo: b.v. pseudoreplicatie zoals wanneer men technische herhalingen heeft voor elke gemeten karakteristiek bij een subject. <strong>Observationele eenheid in fev example?</strong></p></li>
<li><p>Een <strong>factor</strong> is een verklarende variabele die twee of meer niveaus aan kan nemen. Voorbeelden in de fev studie?</p></li>
</ul>
<hr />
<p><img src="introduction_files/figure-html/pop2Samp2Pop-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li>Populatie?</li>
</ul>
<hr />
</div>
<div id="data-exploratie" class="section level2" number="1.3">
<h2 number="1.3"><span class="header-section-number">1.3</span> Data Exploratie</h2>
<div id="summary-statistics" class="section level3" number="1.3.1">
<h3 number="1.3.1"><span class="header-section-number">1.3.1</span> Summary statistics</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fevSum <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(smoking) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(fev),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(fev),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span><span class="fu">length</span>(fev)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>fevSum</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["smoking"],"name":[1],"type":["fct"],"align":["left"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[4],"type":["int"],"align":["right"]},{"label":["se"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"2.634628","3":"0.8160305","4":"545","5":"0.03495491"},{"1":"1","2":"3.240033","3":"0.7519699","4":"61","5":"0.09627989"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li>Let op dat deze code niet werkt als er missing data is.</li>
</ul>
</div>
</div>
<div id="visualisatie" class="section level2" number="1.4">
<h2 number="1.4"><span class="header-section-number">1.4</span> Visualisatie</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fev <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>smoking,<span class="at">y=</span>fev)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha=</span>.<span class="dv">2</span>)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<ul>
<li>Effect grootte?</li>
</ul>
<p>We kunnen de plots ook als objecten opslaan voor later gebruik!</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>smoking,<span class="at">y=</span>fev)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha=</span>.<span class="dv">2</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(smoking<span class="sc">==</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample=</span>fev)) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(smoking<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample=</span>fev)) <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>
</div>
<div id="onderzoeksvraag" class="section level2" number="1.5">
<h2 number="1.5"><span class="header-section-number">1.5</span> Onderzoeksvraag</h2>
<p>De onderzoekers wensen het effect te kennen van roken op de long capaciteit van jongeren.</p>
</div>
<div id="hoe-modelleren-we-de-data" class="section level2" number="1.6">
<h2 number="1.6"><span class="header-section-number">1.6</span> Hoe modelleren we de data?</h2>
<ul>
<li><span class="math inline">\(x_i\)</span>: dummy variabele voor rokerstatus voor subject <span class="math inline">\(i\)</span>: <span class="math inline">\(x_{i,1}=\begin{cases} 0&amp; \text{niet-roker}\\ 1&amp; \text{roker} \end{cases}\)</span>.</li>
</ul>
<p><span class="math display">\[Y_i\vert x_i\sim N(\mu_i,\sigma^2)\]</span></p>
<p>via lineair model?</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 x_i + \epsilon_i \text{ met } \epsilon_i\sim N(0,\sigma^2)\]</span></p>
<p>Vertaal de onderzoeksvraag naar de model parameters?</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ExploreModelMatrix)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev<span class="sc">~</span>smoking, fev)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>lm1 </span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fev ~ smoking, data = fev)
## 
## Coefficients:
## (Intercept)     smoking1  
##      2.6346       0.6054</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>explMx <span class="ot">&lt;-</span> <span class="fu">VisualizeDesign</span>(fev,<span class="at">designFormula =</span> <span class="sc">~</span>smoking)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>explMx<span class="sc">$</span>plotlist</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<p><img src="introduction_files/figure-html/unnamed-chunk-8-1.png" width="672" /> - Vertaal de onderzoeksvraag naar een parameter in het model.</p>
<ul>
<li>Effectgrootte:</li>
</ul>
<p><span class="math display">\[\mu_1-\mu_0 = \beta_0+\beta_1 - \beta_0 = \beta_1\]</span></p>
<div id="schatten-van-de-effectgrootte-en-de-standard-error" class="section level3" number="1.6.1">
<h3 number="1.6.1"><span class="header-section-number">1.6.1</span> Schatten van de effectgrootte en de standard error</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fev ~ smoking, data = fev)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.5460 -0.5754 -0.1036  0.4474  3.1584 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.63463    0.03469  75.943  &lt; 2e-16 ***
## smoking1     0.60541    0.10935   5.537  4.6e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8099 on 604 degrees of freedom
## Multiple R-squared:  0.0483, Adjusted R-squared:  0.04672 
## F-statistic: 30.65 on 1 and 604 DF,  p-value: 4.603e-08</code></pre>
</div>
</div>
<div id="statistische-inferentie" class="section level2" number="1.7">
<h2 number="1.7"><span class="header-section-number">1.7</span> Statistische Inferentie?</h2>
<div id="null-en-alternatieve-hypothese" class="section level3" number="1.7.1">
<h3 number="1.7.1"><span class="header-section-number">1.7.1</span> Null en alternatieve hypothese?</h3>
<p>We wensen de  <span class="math inline">\(H_1\)</span> aan te tonen: er is een effect van roken op de longcapaciteit van jongeren. We vertalen dit naar ons model:</p>
<ul>
<li><span class="math inline">\(H_1\)</span>: Gemiddeld is de longcapaciteit van niet-rokende en rokende jongeren verschillend <span class="math display">\[\beta \neq 0\]</span></li>
</ul>
<p>We kunnen op basis van data echter een hypothese niet bewijzen. Daarom zullen we het omgekeerde falsifiëren:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: Gemiddeld is de longcapaciteit van niet-rokende en rokende jongeren gelijk <span class="math display">\[\beta = 0\]</span></p></li>
<li><p>Hoe falsifieren we <span class="math inline">\(H_0\)</span>?</p></li>
</ul>
<hr />
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fev ~ smoking, data = fev)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.5460 -0.5754 -0.1036  0.4474  3.1584 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.63463    0.03469  75.943  &lt; 2e-16 ***
## smoking1     0.60541    0.10935   5.537  4.6e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8099 on 604 degrees of freedom
## Multiple R-squared:  0.0483, Adjusted R-squared:  0.04672 
## F-statistic: 30.65 on 1 and 604 DF,  p-value: 4.603e-08</code></pre>
<ul>
<li><p>Hoe waarschijnlijk is het om een effectgrootte (test-statistiek) te vinden die meer extreem is dan wat we observeerden in een random steekproef wanneer de nulhypothese waar is.</p></li>
<li><p>Als we aannames kunnen doen over de verdelingen van de gegevens, kennen we de verdeling van de test statistiek en kunnen we die kans berekenen: <strong>p-waarde</strong>.</p></li>
<li><p>Als de p-waarde lager is dan het nominale significantie-niveau <span class="math inline">\(\alpha\)</span> verwerpen we de null hypothese.</p></li>
</ul>
<p><em>We controleren de kans op het maken van een vals positieve conclusie op het <span class="math inline">\(\alpha\)</span>-niveau (type I fout)</em></p>
<ul>
<li>De p-value is enkel correct als de onderliggende aannames geldig zijn.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p2,p3,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<ul>
<li>Biologische metingen zijn dikwijls niet normaal verdeeld.</li>
<li>Dikwijls zijn de gegevens na log-transformatie meer normaal verdeeld.<br />
</li>
<li>Verschillen op log schaal:</li>
</ul>
<p><span class="math display">\[
\log_2(S) - \log_2(NS) = \log_2 \frac{S}{NS} = \log_2 FC_{\frac{S}{NS}}
\]</span></p>
<hr />
</div>
</div>
<div id="log-transformation" class="section level2" number="1.8">
<h2 number="1.8"><span class="header-section-number">1.8</span> Log transformation</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>smoking,<span class="at">y=</span><span class="fu">log2</span>(fev))) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha=</span>.<span class="dv">2</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(smoking<span class="sc">==</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample=</span><span class="fu">log2</span>(fev))) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(smoking<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample=</span><span class="fu">log2</span>(fev))) <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p2,p3,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log2</span>(fev)<span class="sc">~</span>smoking,fev)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log2(fev) ~ smoking, data = fev)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.11108 -0.28248  0.00693  0.28172  1.20290 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.33141    0.01833  72.649  &lt; 2e-16 ***
## smoking1     0.32592    0.05776   5.642 2.58e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4278 on 604 degrees of freedom
## Multiple R-squared:  0.05007,    Adjusted R-squared:  0.0485 
## F-statistic: 31.84 on 1 and 604 DF,  p-value: 2.582e-08</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">^</span>(lm1<span class="sc">$</span>coefficients)</span></code></pre></div>
<pre><code>## (Intercept)    smoking1 
##    2.516487    1.253463</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">^</span>(<span class="fu">confint</span>(lm1))</span></code></pre></div>
<pre><code>##                2.5 %   97.5 %
## (Intercept) 2.454484 2.580058
## smoking1    1.158676 1.356004</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## verschil in variantie --&gt; Welch t-test</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>fevttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="fu">log2</span>(fev)<span class="sc">~</span>smoking,fev)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">^</span>(fevttest<span class="sc">$</span>estimate[<span class="dv">2</span>]<span class="sc">-</span>fevttest<span class="sc">$</span>estimate[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## mean in group 1 
##        1.253463</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">^-</span>fevttest<span class="sc">$</span>conf.int <span class="sc">%&gt;%</span> sort</span></code></pre></div>
<pre><code>## [1] 1.174285 1.337979</code></pre>
</div>
<div id="conclusion" class="section level2" number="1.9">
<h2 number="1.9"><span class="header-section-number">1.9</span> Conclusion</h2>
<ul>
<li><p>Er is een extreem significant verschil in gemiddelde longinhoud tussen rokende en niet-rokende jongeren (<span class="math inline">\(p &lt;&lt; 0.001\)</span>).</p></li>
<li><p>Gemiddelde is de longinhoud 1.25 keer groter bij rokerende dan bij niet-rokende jongeren (95% BI [1.17, 1.34] .</p></li>
</ul>
<hr />
<ul>
<li>Probleem!</li>
<li>Observationele studie</li>
<li>Confounding!</li>
</ul>
<p><img src="introduction_files/figure-html/unnamed-chunk-13-1.png" width="50%" style="display: block; margin: auto;" /> - Leeftijd (L) is heeft een invloed op het rookgedrag (R) en op de longinhoud (V)! - Als we leeftijd niet meenemen in de analyse dan kan het zijn dat de associatie tussen rookgedrag en de longinhoud vertekend is omdat rokers en niet-rokers niet alleen in rookgedrag maar ook in leeftijd verschillen! - Confounding is een probleem die typisch optreedt in observationele studies!</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<pre><code>## Warning: package &#39;GGally&#39; was built under R version 4.1.1</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fev <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lfev=</span><span class="fu">log2</span>(fev)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(smoking,gender,age,height_cm,lfev) <span class="sc">%&gt;%</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpairs</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="introduction_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Een betere data exploratie:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fev <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(age),<span class="at">y=</span>fev,<span class="at">fill=</span>smoking)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_jitterdodge</span>()) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;dimgrey&quot;</span>,<span class="st">&quot;firebrick&quot;</span>)) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Boxplot of FEV versus smoking, stratified on age and gender&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;fev (l)&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;age (years)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(gender))</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<hr />
<ul>
<li>Hoe zouden we de associatie tussen leeftijd en fev kunnen modelleren?</li>
<li>We doen dit eerst enkel voor niet-rokende meisjes. Want er is ook een associatie tussen fev en geslacht.</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">&quot;f&quot;</span> <span class="sc">&amp;</span> smoking <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">log2</span>(fev)<span class="sc">~</span>age,.)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log2(fev) ~ age, data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.75023 -0.16864  0.00122  0.18291  0.51611 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.150534   0.069503   2.166   0.0313 *  
## age         0.114369   0.007011  16.313   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.252 on 253 degrees of freedom
## Multiple R-squared:  0.5126, Adjusted R-squared:  0.5107 
## F-statistic: 266.1 on 1 and 253 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm2)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>fev <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">&quot;f&quot;</span> <span class="sc">&amp;</span> smoking <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age,<span class="at">y=</span><span class="fu">log2</span>(fev))) <span class="sc">+</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x )</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<ul>
<li>Residu plot heeft probleem aan!</li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>lm3 <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">&quot;f&quot;</span> <span class="sc">&amp;</span> smoking <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">log2</span>(fev)<span class="sc">~</span>age <span class="sc">+</span> <span class="fu">I</span>(age <span class="sc">^</span><span class="dv">2</span>),.)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log2(fev) ~ age + I(age^2), data = .)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.8147 -0.1650  0.0153  0.1645  0.5122 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.04905    0.23698  -4.427 1.43e-05 ***
## age          0.36096    0.04725   7.639 4.57e-13 ***
## I(age^2)    -0.01202    0.00228  -5.271 2.91e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2396 on 252 degrees of freedom
## Multiple R-squared:  0.561,  Adjusted R-squared:  0.5576 
## F-statistic:   161 on 2 and 252 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm3)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>fev <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age,<span class="at">y=</span><span class="fu">log2</span>(fev))) <span class="sc">+</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(gender <span class="sc">~</span> smoking)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
</div>
<div id="algemeen-linear-model" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Algemeen Linear Model</h1>
<p>How can we integrate multiple factors and continuous covariates in linear model?</p>
<p><span class="math display">\[
y_i= \beta_0 + \beta_S x_{i,S} + \beta_A x_{i,A}  +\epsilon_i,
\]</span> with</p>
<ul>
<li><span class="math inline">\(x_{i,S}\)</span> een dummy variabele for rokerstatus: <span class="math inline">\(x_{i,1}=\begin{cases} 0&amp; \text{niet-roker}\\ 1&amp; \text{roker} \end{cases}\)</span></li>
<li><span class="math inline">\(x_{i,A}\)</span> is de leeftijd.</li>
</ul>
<hr />
<div id="implementation-in-r" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Implementation in R</h2>
<ul>
<li>We doen dit nu enkel voor de meisjes omdat er ook effecten van geslacht zijn. Later leren we hoe we daarmee om kunnen gaan.</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>lmS_age <span class="ot">&lt;-</span> fev <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender<span class="sc">==</span><span class="st">&quot;f&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">log2</span>(fev)<span class="sc">~</span>smoking <span class="sc">+</span> age,<span class="at">data=</span>.)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmS_age)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log2(fev) ~ smoking + age, data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.74590 -0.16639  0.01665  0.19547  0.52963 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.271785   0.069410   3.916 0.000113 ***
## smoking1    -0.048477   0.051598  -0.940 0.348257    
## age          0.101810   0.006984  14.577  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2626 on 289 degrees of freedom
## Multiple R-squared:  0.4648, Adjusted R-squared:  0.4611 
## F-statistic: 125.5 on 2 and 289 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>De parameter smoking1 krijgt nu de interpretatie van de gemiddelde log2 fold change in longinhoud tussen rokers en niet rokers na correctie voor de leeftijd:</p>
<ul>
<li>Roker: <span class="math display">\[E[y|\text{roker}, X_A=x] = \beta_0 + \beta_s + \beta_A x\]</span></li>
<li>Niet-roker: <span class="math display">\[E[y|\text{niet-roker}, X_A=x] = \beta_0 + \beta_A x\]</span></li>
<li>verschil tussen roker en niet-roker van dezelfde leeftijd (<span class="math inline">\(X_A=x\)</span>): <span class="math display">\[E[y|\text{roker}, X_A=x]- E[y|\text{niet-roker}, X_A=x]=\beta_0 + \beta_s + \beta_A x- \beta_0 + \beta_A x = \beta_s\]</span></li>
</ul>
<p>We weten uit de data exploratie echter dat dit nog niet het correcte model is:</p>
<ul>
<li>Niet-lineair effect van leeftijd.</li>
<li>Associatie tussen FEV en rokersstatus verandert i.f.v. leeftijd, waarschijnlijk door associatie met hoelang al wordt gerookt. We zullen later zien dat dit een interactie is.</li>
<li>We wensen het model ook uit te breiden voor Gender.</li>
<li>We zien dat het niet evident is om conclusie te trekken op basis van observationele studies omwille van mogelijkse confounding</li>
<li>In de volgende lessen gaan we dieper in op het algemene lineair model waarin we meerdere factoren en continue variabelen kunnen combineren als predictoren voor het modelleren van het gemiddelde van de continue response variabele.</li>
</ul>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiSW50cm9kdWN0aWUiCmF1dGhvcjogIkxpZXZlbiBDbGVtZW50IgpkYXRlOiAic3RhdE9taWNzLCBHaGVudCBVbml2ZXJzaXR5IChodHRwczovL3N0YXRvbWljcy5naXRodWIuaW8pIgpvdXRwdXQ6CiAgcGRmX2RvY3VtZW50OgogICAgdG9jOiB5ZXMKICBodG1sX2RvY3VtZW50OgogICAgY29kZV9kb3dubG9hZDogeWVzCiAgICB0aGVtZTogY29zbW8KICAgIHRvYzogeWVzCiAgICB0b2NfZmxvYXQ6IHllcwogICAgaGlnaGxpZ2h0OiB0YW5nbwogICAgbnVtYmVyX3NlY3Rpb25zOiB5ZXMKLS0tCgoKIyBMb25ndm9sdW1lIGVuIHJva2Vyc3RhdHVzCgotIE9uZGVyem9la2VycyB3aWxsZW4gZGUgaW1wYWN0IHZhbiByb2tlbiBvbmRlcnpvZWtlbiBvcCBsb25nY2FwYWNpdGVpdCBiaWogc2Nob29sZ2FhbmRlIGtpbmRlcmVuIGVuIGFkb2xlc2NlbnRlbi4gCi0gWmUgbWV0ZW4gaGllcmJpaiBkZSBsb25nY2FwYWNpdGVpdCAoaW4gbCkgYmlqIHJva2VuZGUgZW4gbmlldC1yb2tlbmRlIGxlZXJsaW5nZW4gKGZvcmNlZCBleHBpcmF0b3J5IHZvbHVtZSkuCgpgYGB7ciBlY2hvPUZBTFNFfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcygiLi9maWdzL2Zldk1lYXN1cmVtZW50LmpwZyIpCmBgYAojIyBJbXBvcnRlZXIgZGF0YQoKYGBge3J9CmxpYnJhcnkodGlkeXZlcnNlKQpmZXYgPC0gcmVhZF90c3YoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9HVFBCL1BTTFMyMC9tYXN0ZXIvZGF0YS9mZXYudHh0IikKYGBgCgoKYGBge3J9CmhlYWQoZmV2KQpgYGAKCiMjIERhdGEgbWFuaXB1bGF0aWUKCjEuICBgZ2VuZGVyYCBhbmQgYHNtb2tpbmdgIGt1bm5lbiBiZXRlciB3b3JkZW4gb21nZXpldCBuYWFyIGZhY3RvciB2YXJpYWJlbGVuCjIuIERlIGBoZWlnaHRgIHZhcmlhYmVsZSBpcyBpbiBpbmNoZXMgZHVzIGRlemUgemV0dGVuIHdlIG9tIGluIGNtLiAKCmBgYHtyfQpmZXYgPC0gZmV2ICU+JQogIG11dGF0ZShnZW5kZXIgPSBhcy5mYWN0b3IoZ2VuZGVyKSkgJT4lCiAgbXV0YXRlKHNtb2tpbmcgPSBhcy5mYWN0b3Ioc21va2luZykpICU+JQogIG11dGF0ZShoZWlnaHRfY20gPSBoZWlnaHQqMi41NCkKaGVhZChmZXYpCmBgYAoKIyMgRW5rZWxlIENvbmNlcHRlbgoKLSBJbiBlZW4gKipleHBlcmltZW50ZWxlIHN0dWRpZSoqIGdhYXQgZWVuIG9uZGVyem9la2VyIGRlICoqYmVoYW5kZWxpbmcqKiAqKmF0IHJhbmRvbSoqIHRvZXdpanplbiBhYW4gZGUgKipleHBlcmltZW50ZWxlIGVlbmhlZGVuKiogZW4gb2JzZXJ2ZWVydCBoaWovemlqIGhldCBlZmZlY3QgdmFuIGRlICoqYmVoYW5kZWxpbmcqKiBiaWogZGUgZXhwZXJpbWVudGVsZSBlZW5oZWRlbiBkb29yIGhldCBtZXRlbiB2YW4gw6nDqW4gb2YgbWVlcmRlcmUgKipyZXBvbnNlIHZhcmlhYmVsZW4qKi4gCgotIEVlbiAgKipleHBlcmltZW50ZWxlIGVlbmhlaWQqKiAoZXhwZXJpbWVudGFsIHVuaXQpIGlzIGRlIGVlbmhlaWQgKHN1YmplY3QsIHBsYW50LCBwb3QsIHByb2VmZGllcikgZGF0IGF0IHJhbmRvbSBhYW4gZGUgYmVoYW5kZWxpbmcgd29yZHQgdG9lZ2V3ZXplbi4gCioqRXhwZXJpbWVudGVsZSBlZW5oZWRlbiBpbiBmZXYgZXhhbXBsZT8qKiAKCi0gRWVuICoqcmVzcG9uc2UgdmFyaWFiZWxlKiogaXMgYSBjaGFyYWN0ZXJpc3RpZWsgdmFuIGRlIGV4cGVyaW1lbnRlbGUgZWVuaGVpZCBkaWUgd29yZHQgZ2VtZXRlbiBlbiBnZWFuYWx5c2VlcmQgb20gaGV0IGVmZmVjdCB2YW4gZGUgYmVoYW5kZWxpbmcgbmEgdGUgZ2Fhbi4gICoqUmVzcG9uc2UgdmFyaWFibGUgaW4gZmV2IGV4YW1wbGU/KioKCi0gRWVuIFx0ZXh0YmZ7b2JzZXJ2YXRpb25lbGUgZWVuaGVpZH0gaXMgZGUgZWVuaGVpZCB3YWFyb3AgZGUgcmVzcG9uc2UgdmFyaWFiZWxlIHdvcmR0IGdlbWV0ZW4uIFZlZWxhbCBpcyBlciBlZW4gw6nDqW4tb3Atw6nDqW4gb3ZlcmVlbmtvbXN0IHR1c3NlbiBleHBlcmltZW50ZWxlIGVuIG9ic2VydmF0aW9uZWxlIGVlbmhlZGVuLiBNYWFyIGRhdCBpcyBuaWV0IGFsdGlqZCB6bzogYi52LiBwc2V1ZG9yZXBsaWNhdGllIHpvYWxzIHdhbm5lZXIgbWVuIHRlY2huaXNjaGUgaGVyaGFsaW5nZW4gaGVlZnQgdm9vciBlbGtlIGdlbWV0ZW4ga2FyYWt0ZXJpc3RpZWsgYmlqIGVlbiBzdWJqZWN0LiAqKk9ic2VydmF0aW9uZWxlIGVlbmhlaWQgaW4gZmV2IGV4YW1wbGU/KiogCgotIEVlbiAqKmZhY3RvcioqIGlzIGVlbiB2ZXJrbGFyZW5kZSB2YXJpYWJlbGUgZGllIHR3ZWUgb2YgbWVlciBuaXZlYXVzIGFhbiBrYW4gbmVtZW4uIFZvb3JiZWVsZGVuIGluIGRlIGZldiBzdHVkaWU/ICAKCi0tLQoKYGBge3IgcG9wMlNhbXAyUG9wLGZpZy5hc3A9LjgsIGZpZy5hbGlnbj0nY2VudGVyJyxlY2hvPUZBTFNFfQppZiAoInBpIiVpbiVscygpKSBybSgicGkiKQprb3B2b2V0ZXI8LWZ1bmN0aW9uKHgseSxhbmdsZT0wLGw9LjIsY2V4LmRvdD0uNSxwY2g9MTksY29sPSJibGFjayIpCnsKYW5nbGU9YW5nbGUvMTgwKnBpCnBvaW50cyh4LHksY2V4PWNleC5kb3QscGNoPXBjaCxjb2w9Y29sKQpsaW5lcyhjKHgseCtsKmNvcygtcGkvMithbmdsZSkpLGMoeSx5K2wqc2luKC1waS8yK2FuZ2xlKSksY29sPWNvbCkKbGluZXMoYyh4K2wvMipjb3MoLXBpLzIrYW5nbGUpLHgrbC8yKmNvcygtcGkvMithbmdsZSkrbC80KmNvcyhhbmdsZSkpLGMoeStsLzIqc2luKC1waS8yK2FuZ2xlKSx5K2wvMipzaW4oLXBpLzIrYW5nbGUpK2wvNCpzaW4oYW5nbGUpKSxjb2w9Y29sKQpsaW5lcyhjKHgrbC8yKmNvcygtcGkvMithbmdsZSkseCtsLzIqY29zKC1waS8yK2FuZ2xlKStsLzQqY29zKHBpK2FuZ2xlKSksYyh5K2wvMipzaW4oLXBpLzIrYW5nbGUpLHkrbC8yKnNpbigtcGkvMithbmdsZSkrbC80KnNpbihwaSthbmdsZSkpLGNvbD1jb2wpCmxpbmVzKGMoeCtsKmNvcygtcGkvMithbmdsZSkseCtsKmNvcygtcGkvMithbmdsZSkrbC8yKmNvcygtcGkvMitwaS80K2FuZ2xlKSksYyh5K2wqc2luKC1waS8yK2FuZ2xlKSx5K2wqc2luKC1waS8yK2FuZ2xlKStsLzIqc2luKC1waS8yK3BpLzQrYW5nbGUpKSxjb2w9Y29sKQpsaW5lcyhjKHgrbCpjb3MoLXBpLzIrYW5nbGUpLHgrbCpjb3MoLXBpLzIrYW5nbGUpK2wvMipjb3MoLXBpLzItcGkvNCthbmdsZSkpLGMoeStsKnNpbigtcGkvMithbmdsZSkseStsKnNpbigtcGkvMithbmdsZSkrbC8yKnNpbigtcGkvMi1waS80K2FuZ2xlKSksY29sPWNvbCkKfQoKcGFyKG1hcj1jKDAsMCwwLDApLG1haT1jKDAsMCwwLDApKQpwbG90KDAsMCx4bGFiPSIiLHlsYWI9IiIseGxpbT1jKDAsMTApLHlsaW09YygwLDEwKSxjb2w9MCx4YXh0PSJub25lIix5YXh0PSJub25lIixheGVzPUZBTFNFKQpyZWN0KDAsNiwxMCwxMCxib3JkZXI9InJlZCIsbHdkPTIpCnRleHQoLjUsOCwicG9wdWxhdGllIixzcnQ9OTAsY29sPSJyZWQiLGNleD0yKQpzeW1ib2xzICgzLCA4LCBjaXJjbGVzPTEuNSwgY29sPSJyZWQiLGFkZD1UUlVFLGZnPSJyZWQiLGluY2hlcz1GQUxTRSxsd2Q9MikKZ3JpZD1zZXEoMCwxLjMsLjAxKQoKZm9yIChpIGluIDE6NTApCnsKCWFuZ2xlMT1ydW5pZihuPTEsbWluPTAsbWF4PTM2MCkKCWFuZ2xlMj1ydW5pZihuPTEsbWluPTAsbWF4PTM2MCkKCXJhZGl1cz1zYW1wbGUoZ3JpZCxwcm9iPWdyaWReMipwaS9zdW0oZ3JpZF4yKnBpKSxzaXplPTEpCglrb3B2b2V0ZXIoMytyYWRpdXMqY29zKGFuZ2xlMS8xODAqcGkpLDgrcmFkaXVzKnNpbihhbmdsZTEvMTgwKnBpKSxhbmdsZT1hbmdsZTIpCn0KdGV4dCg3LjUsOCwiRWZmZWN0IHZhbiByb2tlbiBpbiBwb3B1bGF0aWUiLGNvbD0icmVkIixjZXg9MS4yKQoKcmVjdCgwLDAsMTAsNCxib3JkZXI9ImJsdWUiLGx3ZD0yKQp0ZXh0KC41LDIsInNhbXBsZSIsc3J0PTkwLGNvbD0iYmx1ZSIsY2V4PTIpCnN5bWJvbHMgKDMsIDIsIGNpcmNsZXM9MS41LCBjb2w9InJlZCIsYWRkPVRSVUUsZmc9ImJsdWUiLGluY2hlcz1GQUxTRSxsd2Q9MikKZm9yIChpIGluIDA6MikKCWZvciAoaiBpbiAwOjQpCnsKCglrb3B2b2V0ZXIoMi4xK2oqKDMuOS0yLjEpLzQsMS4xK2kpCn0KdGV4dCg3LjUsMiwiRWZmZWN0IHZhbiByb2tlbiBpbiBzdGVla3Byb2VmIixjb2w9ImJsdWUiLGNleD0xLjIpCgphcnJvd3MoMyw1LjksMyw0LjEsY29sPSJibGFjayIsbHdkPTMpCmFycm93cyg3LDQuMSw3LDUuOSxjb2w9ImJsYWNrIixsd2Q9MykKdGV4dCgxLjUsNSwiRVhQLiBERVNJR04gKDEpIixjb2w9ImJsYWNrIixjZXg9MS4yKQp0ZXh0KDguNSw1LCJTQ0hBVFRFTiAmXG5JTkZFUkVOVElFICgzKSIsY29sPSJibGFjayIsY2V4PTEuMikKdGV4dCg3LjUsLjUsIkRBVEEgRVhQTE9SQVRJRSAmXG5CRVNDSFJJSlZFTkRFIFNUQVRJU1RJRUsgKDIpIixjb2w9ImJsYWNrIixjZXg9MS4yKQpgYGAKCi0gUG9wdWxhdGllPwoKCi0tLQoKIyMgRGF0YSBFeHBsb3JhdGllCgojIyMgU3VtbWFyeSBzdGF0aXN0aWNzCgoKYGBge3J9CmZldlN1bSA8LSBmZXYgJT4lCiAgZ3JvdXBfYnkoc21va2luZykgJT4lCiAgc3VtbWFyaXplKG1lYW4gPSBtZWFuKGZldiksCiAgICAgICAgICAgIHNkID0gc2QoZmV2KSwKICAgICAgICAgICAgbj1sZW5ndGgoZmV2KQogICAgICAgICAgICApICU+JQogIG11dGF0ZShzZSA9IHNkL3NxcnQobikpCmZldlN1bQpgYGAKCi0gTGV0IG9wIGRhdCBkZXplIGNvZGUgbmlldCB3ZXJrdCBhbHMgZXIgbWlzc2luZyBkYXRhIGlzLiAKCgojIyBWaXN1YWxpc2F0aWUKCmBgYHtyfQpmZXYgJT4lCiAgZ2dwbG90KGFlcyh4PXNtb2tpbmcseT1mZXYpKSArCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGU9TkEpICsKICBnZW9tX2ppdHRlcihhbHBoYT0uMikKYGBgCgotIEVmZmVjdCBncm9vdHRlPyAKCgpXZSBrdW5uZW4gZGUgcGxvdHMgb29rIGFscyBvYmplY3RlbiBvcHNsYWFuIHZvb3IgbGF0ZXIgZ2VicnVpayEgCgpgYGB7cn0KcDEgPC0gZmV2ICU+JQogIGdncGxvdChhZXMoeD1zbW9raW5nLHk9ZmV2KSkgKwogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlPU5BKSArCiAgZ2VvbV9qaXR0ZXIoYWxwaGE9LjIpCgpwMiA8LSBmZXYgJT4lCiAgZmlsdGVyKHNtb2tpbmc9PTApICU+JQogIGdncGxvdChhZXMoc2FtcGxlPWZldikpICsKICBnZW9tX3FxKCkgKwogIGdlb21fcXFfbGluZSgpCgpwMyA8LSBmZXYgJT4lCiAgZmlsdGVyKHNtb2tpbmc9PTEpICU+JQogIGdncGxvdChhZXMoc2FtcGxlPWZldikpICsKICBnZW9tX3FxKCkgKwogIGdlb21fcXFfbGluZSgpCgpwMQpwMgpwMwpgYGAKCgojIyBPbmRlcnpvZWtzdnJhYWcKCkRlIG9uZGVyem9la2VycyB3ZW5zZW4gaGV0IGVmZmVjdCB0ZSBrZW5uZW4gdmFuIHJva2VuIG9wIGRlIGxvbmcgY2FwYWNpdGVpdCB2YW4gam9uZ2VyZW4uIAoKIyMgSG9lIG1vZGVsbGVyZW4gd2UgZGUgZGF0YT8gCgoKLSAkeF9pJDogZHVtbXkgdmFyaWFiZWxlIHZvb3Igcm9rZXJzdGF0dXMgdm9vciBzdWJqZWN0ICRpJDogJHhfe2ksMX09XGJlZ2lue2Nhc2VzfQowJiBcdGV4dHtuaWV0LXJva2VyfVxcCjEmIFx0ZXh0e3Jva2VyfQpcZW5ke2Nhc2VzfSQuIAoKXFtZX2lcdmVydCB4X2lcc2ltIE4oXG11X2ksXHNpZ21hXjIpXF0KCnZpYSBsaW5lYWlyIG1vZGVsPyAKClxbWV9pID0gXGJldGFfMCArIFxiZXRhXzEgeF9pICsgXGVwc2lsb25faSBcdGV4dHsgbWV0IH0gXGVwc2lsb25faVxzaW0gTigwLFxzaWdtYV4yKVxdCgoKVmVydGFhbCBkZSBvbmRlcnpvZWtzdnJhYWcgbmFhciBkZSBtb2RlbCBwYXJhbWV0ZXJzPyAKCmBgYHtyfQpsaWJyYXJ5KEV4cGxvcmVNb2RlbE1hdHJpeCkKCmxtMSA8LSBsbShmZXZ+c21va2luZywgZmV2KQpsbTEgCgpleHBsTXggPC0gVmlzdWFsaXplRGVzaWduKGZldixkZXNpZ25Gb3JtdWxhID0gfnNtb2tpbmcpCmV4cGxNeCRwbG90bGlzdAoKYGBgCi0gVmVydGFhbCBkZSBvbmRlcnpvZWtzdnJhYWcgbmFhciBlZW4gcGFyYW1ldGVyIGluIGhldCBtb2RlbC4gCgotIEVmZmVjdGdyb290dGU6IAoKXFtcbXVfMS1cbXVfMCA9IFxiZXRhXzArXGJldGFfMSAtIFxiZXRhXzAgPSBcYmV0YV8xXF0gCgoKIyMjIFNjaGF0dGVuIHZhbiBkZSBlZmZlY3Rncm9vdHRlIGVuIGRlIHN0YW5kYXJkIGVycm9yCgpgYGB7cn0Kc3VtbWFyeShsbTEpCmBgYAoKIyMgU3RhdGlzdGlzY2hlIEluZmVyZW50aWU/CgojIyMgTnVsbCBlbiBhbHRlcm5hdGlldmUgaHlwb3RoZXNlPyAKCldlIHdlbnNlbiBkZSBcYWxlcnRCb2xke2FsdGVybmF0aWV2ZSBoeXBvdGhlc2V9ICRIXzEkIGFhbiB0ZSB0b25lbjogZXIgaXMgZWVuIGVmZmVjdCB2YW4gcm9rZW4gb3AgZGUgbG9uZ2NhcGFjaXRlaXQgdmFuIGpvbmdlcmVuLiBXZSB2ZXJ0YWxlbiBkaXQgbmFhciBvbnMgbW9kZWw6CgotICRIXzEkOiBHZW1pZGRlbGQgaXMgZGUgbG9uZ2NhcGFjaXRlaXQgdmFuIG5pZXQtcm9rZW5kZSBlbiByb2tlbmRlIGpvbmdlcmVuIHZlcnNjaGlsbGVuZApcW1xiZXRhIFxuZXEgMFxdIAoKV2Uga3VubmVuIG9wIGJhc2lzIHZhbiBkYXRhIGVjaHRlciBlZW4gaHlwb3RoZXNlIG5pZXQgYmV3aWp6ZW4uIERhYXJvbSB6dWxsZW4gd2UgaGV0IG9tZ2VrZWVyZGUgZmFsc2lmacOrcmVuOiAKCi0gJEhfMCQ6IEdlbWlkZGVsZCBpcyBkZSBsb25nY2FwYWNpdGVpdCB2YW4gbmlldC1yb2tlbmRlIGVuIHJva2VuZGUgam9uZ2VyZW4gZ2VsaWprClxbXGJldGEgPSAwXF0gCgotIEhvZSBmYWxzaWZpZXJlbiB3ZSAkSF8wJD8gCgotLS0KCgoKYGBge3J9CnN1bW1hcnkobG0xKQpgYGAKCi0gSG9lIHdhYXJzY2hpam5saWprIGlzIGhldCBvbSBlZW4gZWZmZWN0Z3Jvb3R0ZSAodGVzdC1zdGF0aXN0aWVrKSB0ZSB2aW5kZW4gZGllIG1lZXIgZXh0cmVlbSBpcyBkYW4gd2F0IHdlIG9ic2VydmVlcmRlbiBpbiBlZW4gcmFuZG9tIHN0ZWVrcHJvZWYgd2FubmVlciBkZSBudWxoeXBvdGhlc2Ugd2FhciBpcy4gIAoKLSBBbHMgd2UgYWFubmFtZXMga3VubmVuIGRvZW4gb3ZlciBkZSB2ZXJkZWxpbmdlbiB2YW4gZGUgZ2VnZXZlbnMsIGtlbm5lbiB3ZSBkZSB2ZXJkZWxpbmcgdmFuIGRlIHRlc3Qgc3RhdGlzdGllayBlbiBrdW5uZW4gd2UgZGllIGthbnMgYmVyZWtlbmVuOiAqKnAtd2FhcmRlKiouCi0gQWxzIGRlIHAtd2FhcmRlIGxhZ2VyIGlzIGRhbiBoZXQgbm9taW5hbGUgc2lnbmlmaWNhbnRpZS1uaXZlYXUgJFxhbHBoYSQgdmVyd2VycGVuIHdlIGRlIG51bGwgaHlwb3RoZXNlLiAKCipXZSBjb250cm9sZXJlbiBkZSBrYW5zIG9wIGhldCBtYWtlbiB2YW4gZWVuIHZhbHMgcG9zaXRpZXZlIGNvbmNsdXNpZSBvcCBoZXQgJFxhbHBoYSQtbml2ZWF1ICh0eXBlIEkgZm91dCkqCgotIERlIHAtdmFsdWUgaXMgZW5rZWwgY29ycmVjdCBhbHMgZGUgb25kZXJsaWdnZW5kZSBhYW5uYW1lcyBnZWxkaWcgemlqbi4gCgpgYGB7cn0KbGlicmFyeShncmlkRXh0cmEpCnAxCmdyaWQuYXJyYW5nZShwMixwMyxuY29sPTIpCmBgYAoKLSBCaW9sb2dpc2NoZSBtZXRpbmdlbiB6aWpuIGRpa3dpamxzIG5pZXQgbm9ybWFhbCB2ZXJkZWVsZC4gCi0gRGlrd2lqbHMgIHppam4gZGUgZ2VnZXZlbnMgbmEgbG9nLXRyYW5zZm9ybWF0aWUgbWVlciBub3JtYWFsIHZlcmRlZWxkLiAgCi0gVmVyc2NoaWxsZW4gb3AgbG9nIHNjaGFhbDoKCiQkClxsb2dfMihTKSAtIFxsb2dfMihOUykgPSBcbG9nXzIgXGZyYWN7U317TlN9ID0gXGxvZ18yIEZDX3tcZnJhY3tTfXtOU319CiQkCgoKLS0tCgojIyBMb2cgdHJhbnNmb3JtYXRpb24KCmBgYHtyfQoKcDEgPC0gZmV2ICU+JQogIGdncGxvdChhZXMoeD1zbW9raW5nLHk9bG9nMihmZXYpKSkgKwogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlPU5BKSArCiAgZ2VvbV9qaXR0ZXIoYWxwaGE9LjIpCgpwMiA8LSBmZXYgJT4lCiAgZmlsdGVyKHNtb2tpbmc9PTApICU+JQogIGdncGxvdChhZXMoc2FtcGxlPWxvZzIoZmV2KSkpICsKICBnZW9tX3FxKCkgKwogIGdlb21fcXFfbGluZSgpCgpwMyA8LSBmZXYgJT4lCiAgZmlsdGVyKHNtb2tpbmc9PTEpICU+JQogIGdncGxvdChhZXMoc2FtcGxlPWxvZzIoZmV2KSkpICsKICBnZW9tX3FxKCkgKwogIGdlb21fcXFfbGluZSgpCgpwMQpncmlkLmFycmFuZ2UocDIscDMsbmNvbD0yKQoKbG0xIDwtIGxtKGxvZzIoZmV2KX5zbW9raW5nLGZldikKc3VtbWFyeShsbTEpCjJeKGxtMSRjb2VmZmljaWVudHMpCjJeKGNvbmZpbnQobG0xKSkKCgojIyB2ZXJzY2hpbCBpbiB2YXJpYW50aWUgLS0+IFdlbGNoIHQtdGVzdAoKZmV2dHRlc3QgPC0gdC50ZXN0KGxvZzIoZmV2KX5zbW9raW5nLGZldikKMl4oZmV2dHRlc3QkZXN0aW1hdGVbMl0tZmV2dHRlc3QkZXN0aW1hdGVbMV0pCjJeLWZldnR0ZXN0JGNvbmYuaW50ICU+JSBzb3J0CmBgYAoKIyMgQ29uY2x1c2lvbgoKLSBFciBpcyBlZW4gZXh0cmVlbSBzaWduaWZpY2FudCB2ZXJzY2hpbCBpbiBnZW1pZGRlbGRlIGxvbmdpbmhvdWQgdHVzc2VuIHJva2VuZGUgZW4gbmlldC1yb2tlbmRlIGpvbmdlcmVuICgkcCA8PCAwLjAwMSQpLiAKCi0gR2VtaWRkZWxkZSBpcyBkZSBsb25naW5ob3VkIGByIDJeKGZldnR0ZXN0JGVzdGltYXRlWzJdLWZldnR0ZXN0JGVzdGltYXRlWzFdKSAlPiUgZm9ybWF0KGRpZ2l0cz0zKWAga2VlciBncm90ZXIgYmlqIHJva2VyZW5kZSBkYW4gYmlqIG5pZXQtcm9rZW5kZSBqb25nZXJlbiAoOTUlIEJJIFtgciAyXi1mZXZ0dGVzdCRjb25mLmludCAlPiUgc29ydCAlPiUgZm9ybWF0KGRpZ2l0cz0zKWBdCi4gIAoKLS0tCgotIFByb2JsZWVtIQotIE9ic2VydmF0aW9uZWxlIHN0dWRpZQotIENvbmZvdW5kaW5nISAKCgpgYGB7cixlY2hvPUZBTFNFLCBmaWcuYWxpZ24gPSAiY2VudGVyIixvdXQud2lkdGggPSAnNTAlJ30KcGxvdChjKDAsMCwxKSxjKC0yLDIsMCkscGNoPWMoIkwiLCJSIiwiViIpLHhheHQ9Im5vbmUiLHlheHQ9Im5vbmUiLGF4ZXM9RkFMU0UseGxhYj0iIix5bGFiPSIiLGNleD00LHlsaW09YygtMi4yLDIuMikpCmFycm93cyh4MD0wLjEseDE9LjkseTA9MS44LHkxPTAuMSxsd2Q9NCkKYXJyb3dzKHgwPTAuMSx4MT0uOSx5MD0tMS44LHkxPS0wLjIsbHdkPTQpCmFycm93cyh4MD0wLHgxPTAseTA9LTEuNCx5MT0xLjQsbHdkPTQpCmBgYAotIExlZWZ0aWpkIChMKSBpcyBoZWVmdCBlZW4gaW52bG9lZCBvcCBoZXQgcm9va2dlZHJhZyAoUikgZW4gb3AgZGUgbG9uZ2luaG91ZCAoVikhCi0gQWxzIHdlIGxlZWZ0aWpkIG5pZXQgbWVlbmVtZW4gaW4gZGUgYW5hbHlzZSBkYW4ga2FuIGhldCB6aWpuIGRhdCBkZSBhc3NvY2lhdGllIHR1c3NlbiByb29rZ2VkcmFnIGVuIGRlIGxvbmdpbmhvdWQgdmVydGVrZW5kIGlzIG9tZGF0IHJva2VycyBlbiBuaWV0LXJva2VycyBuaWV0IGFsbGVlbiBpbiByb29rZ2VkcmFnIG1hYXIgb29rIGluIGxlZWZ0aWpkIHZlcnNjaGlsbGVuIQotIENvbmZvdW5kaW5nIGlzIGVlbiBwcm9ibGVlbSBkaWUgdHlwaXNjaCBvcHRyZWVkdCBpbiBvYnNlcnZhdGlvbmVsZSBzdHVkaWVzIQoKCmBgYHtyfQpsaWJyYXJ5KEdHYWxseSkKCmZldiAlPiUgCiAgbXV0YXRlKGxmZXY9bG9nMihmZXYpKSAlPiUgCiAgZHBseXI6OnNlbGVjdChzbW9raW5nLGdlbmRlcixhZ2UsaGVpZ2h0X2NtLGxmZXYpICU+JSAKICBnZ3BhaXJzKCkKYGBgCgpFZW4gYmV0ZXJlIGRhdGEgZXhwbG9yYXRpZTogCmBgYHtyfQpmZXYgJT4lCiAgZ2dwbG90KGFlcyh4PWFzLmZhY3RvcihhZ2UpLHk9ZmV2LGZpbGw9c21va2luZykpICsKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZT1OQSkgKwogIGdlb21fcG9pbnQoc2l6ZSA9IDAuMSwgcG9zaXRpb24gPSBwb3NpdGlvbl9qaXR0ZXJkb2RnZSgpKSArCiAgdGhlbWVfYncoKSArCiAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzPWMoImRpbWdyZXkiLCJmaXJlYnJpY2siKSkgKwogIGdndGl0bGUoIkJveHBsb3Qgb2YgRkVWIHZlcnN1cyBzbW9raW5nLCBzdHJhdGlmaWVkIG9uIGFnZSBhbmQgZ2VuZGVyIikgKwogIHlsYWIoImZldiAobCkiKSArCiAgeGxhYigiYWdlICh5ZWFycykiKSArIAogIGZhY2V0X2dyaWQocm93cyA9IHZhcnMoZ2VuZGVyKSkKYGBgCgotLS0KCi0gSG9lIHpvdWRlbiB3ZSBkZSBhc3NvY2lhdGllIHR1c3NlbiBsZWVmdGlqZCBlbiBmZXYga3VubmVuIG1vZGVsbGVyZW4/IAotIFdlIGRvZW4gZGl0IGVlcnN0IGVua2VsIHZvb3IgbmlldC1yb2tlbmRlIG1laXNqZXMuIFdhbnQgZXIgaXMgb29rIGVlbiBhc3NvY2lhdGllIHR1c3NlbiBmZXYgZW4gZ2VzbGFjaHQuICAKCmBgYHtyfQpsbTIgPC0gZmV2ICU+JSAKICBmaWx0ZXIoZ2VuZGVyPT0iZiIgJiBzbW9raW5nID09IDApICU+JSAKICBsbShsb2cyKGZldil+YWdlLC4pCgpzdW1tYXJ5KGxtMikKcGFyKG1mcm93PWMoMiwyKSkKcGxvdChsbTIpCgpmZXYgJT4lIAogIGZpbHRlcihnZW5kZXI9PSJmIiAmIHNtb2tpbmcgPT0gMCkgJT4lIAogIGdncGxvdChhZXMoeD1hZ2UseT1sb2cyKGZldikpKSArIAogIGdlb21fcG9pbnQoKSArCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIiwgZm9ybXVsYSA9IHkgfiB4ICkKYGBgCgotIFJlc2lkdSBwbG90IGhlZWZ0IHByb2JsZWVtIGFhbiEKCgpgYGB7cn0KbG0zIDwtIGZldiAlPiUgCiAgZmlsdGVyKGdlbmRlcj09ImYiICYgc21va2luZyA9PSAwKSAlPiUgCiAgbG0obG9nMihmZXYpfmFnZSArIEkoYWdlIF4yKSwuKQoKc3VtbWFyeShsbTMpCnBhcihtZnJvdz1jKDIsMikpCnBsb3QobG0zKQpgYGAKCmBgYHtyfQpmZXYgJT4lIAogIGdncGxvdChhZXMoeD1hZ2UseT1sb2cyKGZldikpKSArIAogIGdlb21fcG9pbnQoKSArCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIiwgZm9ybXVsYSA9IHkgfiB4ICsgSSh4XjIpKSArCiAgZmFjZXRfd3JhcChnZW5kZXIgfiBzbW9raW5nKQpgYGAKCgoKIyBBbGdlbWVlbiBMaW5lYXIgTW9kZWwKCkhvdyBjYW4gd2UgaW50ZWdyYXRlIG11bHRpcGxlIGZhY3RvcnMgYW5kIGNvbnRpbnVvdXMgY292YXJpYXRlcyBpbiBsaW5lYXIgbW9kZWw/CgpcWwp5X2k9IFxiZXRhXzAgKyBcYmV0YV9TIHhfe2ksU30gKyBcYmV0YV9BIHhfe2ksQX0gICtcZXBzaWxvbl9pLApcXQp3aXRoCgotICR4X3tpLFN9JCBlZW4gZHVtbXkgdmFyaWFiZWxlIGZvciByb2tlcnN0YXR1czogJHhfe2ksMX09XGJlZ2lue2Nhc2VzfQowJiBcdGV4dHtuaWV0LXJva2VyfVxcCjEmIFx0ZXh0e3Jva2VyfQpcZW5ke2Nhc2VzfSQKLSAkeF97aSxBfSQgaXMgZGUgbGVlZnRpamQuIAoKCi0tLQoKIyMgSW1wbGVtZW50YXRpb24gaW4gUgoKLSBXZSBkb2VuIGRpdCBudSBlbmtlbCB2b29yIGRlIG1laXNqZXMgb21kYXQgZXIgb29rIGVmZmVjdGVuIHZhbiBnZXNsYWNodCB6aWpuLiBMYXRlciBsZXJlbiB3ZSBob2Ugd2UgZGFhcm1lZSBvbSBrdW5uZW4gZ2Fhbi4gIAoKYGBge3J9CmxtU19hZ2UgPC0gZmV2ICU+JSAKICBmaWx0ZXIoZ2VuZGVyPT0iZiIpICU+JQogIGxtKGxvZzIoZmV2KX5zbW9raW5nICsgYWdlLGRhdGE9LikKc3VtbWFyeShsbVNfYWdlKQpgYGAKCkRlIHBhcmFtZXRlciBzbW9raW5nMSBrcmlqZ3QgbnUgZGUgaW50ZXJwcmV0YXRpZSB2YW4gZGUgZ2VtaWRkZWxkZSBsb2cyIGZvbGQgY2hhbmdlIGluIGxvbmdpbmhvdWQgdHVzc2VuIHJva2VycyBlbiBuaWV0IHJva2VycyBuYSBjb3JyZWN0aWUgdm9vciBkZSBsZWVmdGlqZDogCgotIFJva2VyOiBcW0VbeXxcdGV4dHtyb2tlcn0sIFhfQT14XSA9IFxiZXRhXzAgKyBcYmV0YV9zICsgXGJldGFfQSB4XF0KLSBOaWV0LXJva2VyOiBcW0VbeXxcdGV4dHtuaWV0LXJva2VyfSwgWF9BPXhdID0gXGJldGFfMCArIFxiZXRhX0EgeFxdCi0gdmVyc2NoaWwgdHVzc2VuIHJva2VyIGVuIG5pZXQtcm9rZXIgdmFuIGRlemVsZmRlIGxlZWZ0aWpkICgkWF9BPXgkKTogClxbRVt5fFx0ZXh0e3Jva2VyfSwgWF9BPXhdLSBFW3l8XHRleHR7bmlldC1yb2tlcn0sIFhfQT14XT1cYmV0YV8wICsgXGJldGFfcyArIFxiZXRhX0EgeC0gXGJldGFfMCArIFxiZXRhX0EgeCA9IFxiZXRhX3NcXQoKV2Ugd2V0ZW4gdWl0IGRlIGRhdGEgZXhwbG9yYXRpZSBlY2h0ZXIgZGF0IGRpdCBub2cgbmlldCBoZXQgY29ycmVjdGUgbW9kZWwgaXM6IAoKLSBOaWV0LWxpbmVhaXIgZWZmZWN0IHZhbiBsZWVmdGlqZC4gCi0gQXNzb2NpYXRpZSB0dXNzZW4gRkVWIGVuIHJva2Vyc3N0YXR1cyB2ZXJhbmRlcnQgaS5mLnYuIGxlZWZ0aWpkLCB3YWFyc2NoaWpubGlqayBkb29yIGFzc29jaWF0aWUgbWV0IGhvZWxhbmcgYWwgd29yZHQgZ2Vyb29rdC4gV2UgenVsbGVuIGxhdGVyIHppZW4gZGF0IGRpdCBlZW4gaW50ZXJhY3RpZSBpcy4gCi0gV2Ugd2Vuc2VuIGhldCBtb2RlbCBvb2sgdWl0IHRlIGJyZWlkZW4gdm9vciBHZW5kZXIuCi0gV2UgemllbiBkYXQgaGV0IG5pZXQgZXZpZGVudCBpcyBvbSBjb25jbHVzaWUgdGUgdHJla2tlbiBvcCBiYXNpcyB2YW4gb2JzZXJ2YXRpb25lbGUgc3R1ZGllcyBvbXdpbGxlIHZhbiBtb2dlbGlqa3NlIGNvbmZvdW5kaW5nCi0gSW4gZGUgdm9sZ2VuZGUgbGVzc2VuIGdhYW4gd2UgZGllcGVyIGluIG9wIGhldCBhbGdlbWVuZSBsaW5lYWlyIG1vZGVsIHdhYXJpbiB3ZSBtZWVyZGVyZSBmYWN0b3JlbiBlbiBjb250aW51ZSB2YXJpYWJlbGVuIGt1bm5lbiBjb21iaW5lcmVuIGFscyBwcmVkaWN0b3JlbiB2b29yIGhldCBtb2RlbGxlcmVuIHZhbiBoZXQgZ2VtaWRkZWxkZSB2YW4gZGUgY29udGludWUgcmVzcG9uc2UgdmFyaWFiZWxlLiAKCg==</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("introduction.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
